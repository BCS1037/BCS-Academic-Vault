/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var cc=Object.create;var wr=Object.defineProperty,fc=Object.defineProperties,dc=Object.getOwnPropertyDescriptor,hc=Object.getOwnPropertyDescriptors,pc=Object.getOwnPropertyNames,Us=Object.getOwnPropertySymbols,mc=Object.getPrototypeOf,qs=Object.prototype.hasOwnProperty,gc=Object.prototype.propertyIsEnumerable;var Gs=(t,e,r)=>e in t?wr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ne=(t,e)=>{for(var r in e||(e={}))qs.call(e,r)&&Gs(t,r,e[r]);if(Us)for(var r of Us(e))gc.call(e,r)&&Gs(t,r,e[r]);return t},xe=(t,e)=>fc(t,hc(e)),Qs=t=>wr(t,"__esModule",{value:!0});var yc=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),vc=(t,e)=>{Qs(t);for(var r in e)wr(t,r,{get:e[r],enumerable:!0})},_c=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of pc(e))!qs.call(t,n)&&n!=="default"&&wr(t,n,{get:()=>e[n],enumerable:!(r=dc(e,n))||r.enumerable});return t},Ee=t=>_c(Qs(wr(t!=null?cc(mc(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var la=yc((Qr,cs)=>{(function(t,e){if(typeof Qr=="object"&&typeof cs=="object")cs.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var r=e();for(var n in r)(typeof Qr=="object"?Qr:t)[n]=r[n]}})(typeof self!="undefined"?self:Qr,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(n,i,s){r.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:s})},r.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,i){if(1&i&&(n=r(n)),8&i||4&i&&typeof n=="object"&&n&&n.__esModule)return n;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:n}),2&i&&typeof n!="string")for(var o in n)r.d(s,o,function(u){return n[u]}.bind(null,o));return s},r.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(i,"a",i),i},r.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e),r.d(e,"md5",function(){return w});var n="0123456789abcdef".split(""),i=function(x){for(var h="",y=0;y<4;y++)h+=n[x>>8*y+4&15]+n[x>>8*y&15];return h},s=function(x){for(var h=x.length,y=0;y<h;y++)x[y]=i(x[y]);return x.join("")},o=function(x,h){return x+h&4294967295},u=function(x,h,y,m,g,v,_){return function(j,A,S){return o(j<<A|j>>>32-A,S)}(h=function(j,A,S,F){return A=o(o(A,j),o(S,F))}(x,h,m,v),g,y)},l=function(x,h,y,m,g,v,_,j){return u(y&m|~y&g,h,y,v,_,j,x)},a=function(x,h,y,m,g,v,_,j){return u(y&g|m&~g,h,y,v,_,j,x)},c=function(x,h,y,m,g,v,_,j){return u(y^m^g,h,y,v,_,j,x)},d=function(x,h,y,m,g,v,_,j){return u(m^(y|~g),h,y,v,_,j,x)},f=function(x,h,y){y===void 0&&(y=o);var m=x[0],g=x[1],v=x[2],_=x[3],j=l.bind(null,y);m=j(m,g,v,_,h[0],7,-680876936),_=j(_,m,g,v,h[1],12,-389564586),v=j(v,_,m,g,h[2],17,606105819),g=j(g,v,_,m,h[3],22,-1044525330),m=j(m,g,v,_,h[4],7,-176418897),_=j(_,m,g,v,h[5],12,1200080426),v=j(v,_,m,g,h[6],17,-1473231341),g=j(g,v,_,m,h[7],22,-45705983),m=j(m,g,v,_,h[8],7,1770035416),_=j(_,m,g,v,h[9],12,-1958414417),v=j(v,_,m,g,h[10],17,-42063),g=j(g,v,_,m,h[11],22,-1990404162),m=j(m,g,v,_,h[12],7,1804603682),_=j(_,m,g,v,h[13],12,-40341101),v=j(v,_,m,g,h[14],17,-1502002290),g=j(g,v,_,m,h[15],22,1236535329);var A=a.bind(null,y);m=A(m,g,v,_,h[1],5,-165796510),_=A(_,m,g,v,h[6],9,-1069501632),v=A(v,_,m,g,h[11],14,643717713),g=A(g,v,_,m,h[0],20,-373897302),m=A(m,g,v,_,h[5],5,-701558691),_=A(_,m,g,v,h[10],9,38016083),v=A(v,_,m,g,h[15],14,-660478335),g=A(g,v,_,m,h[4],20,-405537848),m=A(m,g,v,_,h[9],5,568446438),_=A(_,m,g,v,h[14],9,-1019803690),v=A(v,_,m,g,h[3],14,-187363961),g=A(g,v,_,m,h[8],20,1163531501),m=A(m,g,v,_,h[13],5,-1444681467),_=A(_,m,g,v,h[2],9,-51403784),v=A(v,_,m,g,h[7],14,1735328473),g=A(g,v,_,m,h[12],20,-1926607734);var S=c.bind(null,y);m=S(m,g,v,_,h[5],4,-378558),_=S(_,m,g,v,h[8],11,-2022574463),v=S(v,_,m,g,h[11],16,1839030562),g=S(g,v,_,m,h[14],23,-35309556),m=S(m,g,v,_,h[1],4,-1530992060),_=S(_,m,g,v,h[4],11,1272893353),v=S(v,_,m,g,h[7],16,-155497632),g=S(g,v,_,m,h[10],23,-1094730640),m=S(m,g,v,_,h[13],4,681279174),_=S(_,m,g,v,h[0],11,-358537222),v=S(v,_,m,g,h[3],16,-722521979),g=S(g,v,_,m,h[6],23,76029189),m=S(m,g,v,_,h[9],4,-640364487),_=S(_,m,g,v,h[12],11,-421815835),v=S(v,_,m,g,h[15],16,530742520),g=S(g,v,_,m,h[2],23,-995338651);var F=d.bind(null,y);m=F(m,g,v,_,h[0],6,-198630844),_=F(_,m,g,v,h[7],10,1126891415),v=F(v,_,m,g,h[14],15,-1416354905),g=F(g,v,_,m,h[5],21,-57434055),m=F(m,g,v,_,h[12],6,1700485571),_=F(_,m,g,v,h[3],10,-1894986606),v=F(v,_,m,g,h[10],15,-1051523),g=F(g,v,_,m,h[1],21,-2054922799),m=F(m,g,v,_,h[8],6,1873313359),_=F(_,m,g,v,h[15],10,-30611744),v=F(v,_,m,g,h[6],15,-1560198380),g=F(g,v,_,m,h[13],21,1309151649),m=F(m,g,v,_,h[4],6,-145523070),_=F(_,m,g,v,h[11],10,-1120210379),v=F(v,_,m,g,h[2],15,718787259),g=F(g,v,_,m,h[9],21,-343485551),x[0]=y(m,x[0]),x[1]=y(g,x[1]),x[2]=y(v,x[2]),x[3]=y(_,x[3])},p=function(x){for(var h=[],y=0;y<64;y+=4)h[y>>2]=x.charCodeAt(y)+(x.charCodeAt(y+1)<<8)+(x.charCodeAt(y+2)<<16)+(x.charCodeAt(y+3)<<24);return h},b=function(x,h){var y,m=x.length,g=[1732584193,-271733879,-1732584194,271733878];for(y=64;y<=m;y+=64)f(g,p(x.substring(y-64,y)),h);var v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_=(x=x.substring(y-64)).length;for(y=0;y<_;y++)v[y>>2]|=x.charCodeAt(y)<<(y%4<<3);if(v[y>>2]|=128<<(y%4<<3),y>55)for(f(g,v,h),y=16;y--;)v[y]=0;return v[14]=8*m,f(g,v,h),g};function w(x){var h;return s(b("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(h=function(y,m){var g=(65535&y)+(65535&m);return(y>>16)+(m>>16)+(g>>16)<<16|65535&g}),s(b(x,h))}}])})});vc(exports,{default:()=>Ws});var br=Ee(require("obsidian"));var uc=Ee(require("obsidian"));function se(){}function bc(t,e){for(let r in e)t[r]=e[r];return t}function ai(t){return t()}function Ys(){return Object.create(null)}function Me(t){t.forEach(ai)}function Kt(t){return typeof t=="function"}function fe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}var tn;function ui(t,e){return tn||(tn=document.createElement("a")),tn.href=e,t===tn.href}function Js(t){return Object.keys(t).length===0}function Xs(t,...e){if(t==null)return se;let r=t.subscribe(...e);return r.unsubscribe?()=>r.unsubscribe():r}function rn(t,e,r){t.$$.on_destroy.push(Xs(e,r))}function zt(t,e,r,n){if(t){let i=Zs(t,e,r,n);return t[0](i)}}function Zs(t,e,r,n){return t[1]&&n?bc(r.ctx.slice(),t[1](n(e))):r.ctx}function Vt(t,e,r,n){if(t[2]&&n){let i=t[2](n(r));if(e.dirty===void 0)return i;if(typeof i=="object"){let s=[],o=Math.max(e.dirty.length,i.length);for(let u=0;u<o;u+=1)s[u]=e.dirty[u]|i[u];return s}return e.dirty|i}return e.dirty}function Ht(t,e,r,n,i,s){if(i){let o=Zs(e,r,n,s);t.p(o,i)}}function $t(t){if(t.ctx.length>32){let e=[],r=t.ctx.length/32;for(let n=0;n<r;n++)e[n]=-1;return e}return-1}function eo(t){return t&&Kt(t.destroy)?t.destroy:se}var to=!1;function xc(){to=!0}function wc(){to=!1}function I(t,e){t.appendChild(e)}function H(t,e,r){t.insertBefore(e,r||null)}function z(t){t.parentNode&&t.parentNode.removeChild(t)}function nn(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function P(t){return document.createElement(t)}function Pe(t){return document.createTextNode(t)}function U(){return Pe(" ")}function jr(){return Pe("")}function Te(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function B(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function jc(t){return Array.from(t.childNodes)}function Ar(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function li(t,e){t.value=e??""}function Ke(t,e,r,n){r===null?t.style.removeProperty(e):t.style.setProperty(e,r,n?"important":"")}function ci(t,e,r){t.classList[r?"add":"remove"](e)}function Ac(t,e,{bubbles:r=!1,cancelable:n=!1}={}){let i=document.createEvent("CustomEvent");return i.initCustomEvent(t,r,n,e),i}var Sr;function Fr(t){Sr=t}function fi(){if(!Sr)throw new Error("Function called outside component initialization");return Sr}function Cr(t){fi().$$.on_mount.push(t)}function Er(t){fi().$$.on_destroy.push(t)}function di(){let t=fi();return(e,r,{cancelable:n=!1}={})=>{let i=t.$$.callbacks[e];if(i){let s=Ac(e,r,{cancelable:n});return i.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}function ze(t,e){let r=t.$$.callbacks[e.type];r&&r.slice().forEach(n=>n.call(this,e))}var Tr=[];var Wt=[],sn=[],ro=[],no=Promise.resolve(),hi=!1;function io(){hi||(hi=!0,no.then(so))}function it(){return io(),no}function pi(t){sn.push(t)}var mi=new Set,on=0;function so(){let t=Sr;do{for(;on<Tr.length;){let e=Tr[on];on++,Fr(e),Sc(e.$$)}for(Fr(null),Tr.length=0,on=0;Wt.length;)Wt.pop()();for(let e=0;e<sn.length;e+=1){let r=sn[e];mi.has(r)||(mi.add(r),r())}sn.length=0}while(Tr.length);for(;ro.length;)ro.pop()();hi=!1,mi.clear(),Fr(t)}function Sc(t){if(t.fragment!==null){t.update(),Me(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(pi)}}var an=new Set,At;function St(){At={r:0,c:[],p:At}}function Ft(){At.r||Me(At.c),At=At.p}function G(t,e){t&&t.i&&(an.delete(t),t.i(e))}function J(t,e,r,n){if(t&&t.o){if(an.has(t))return;an.add(t),At.c.push(()=>{an.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}var vy=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;function Fe(t){t&&t.c()}function we(t,e,r,n){let{fragment:i,after_update:s}=t.$$;i&&i.m(e,r),n||pi(()=>{let o=t.$$.on_mount.map(ai).filter(Kt);t.$$.on_destroy?t.$$.on_destroy.push(...o):Me(o),t.$$.on_mount=[]}),s.forEach(pi)}function ye(t,e){let r=t.$$;r.fragment!==null&&(Me(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function Fc(t,e){t.$$.dirty[0]===-1&&(Tr.push(t),io(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ve(t,e,r,n,i,s,o,u=[-1]){let l=Sr;Fr(t);let a=t.$$={fragment:null,ctx:[],props:s,update:se,not_equal:i,bound:Ys(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Ys(),dirty:u,skip_bound:!1,root:e.target||l.$$.root};o&&o(a.root);let c=!1;if(a.ctx=r?r(t,e.props||{},(d,f,...p)=>{let b=p.length?p[0]:f;return a.ctx&&i(a.ctx[d],a.ctx[d]=b)&&(!a.skip_bound&&a.bound[d]&&a.bound[d](b),c&&Fc(t,d)),f}):[],a.update(),c=!0,Me(a.before_update),a.fragment=n?n(a.ctx):!1,e.target){if(e.hydrate){xc();let d=jc(e.target);a.fragment&&a.fragment.l(d),d.forEach(z)}else a.fragment&&a.fragment.c();e.intro&&G(t.$$.fragment),we(t,e.target,e.anchor,e.customElement),wc(),so()}Fr(l)}var Cc;typeof HTMLElement=="function"&&(Cc=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(ai).filter(Kt);for(let e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(t,e,r){this[t]=r}disconnectedCallback(){Me(this.$$.on_disconnect)}$destroy(){ye(this,1),this.$destroy=se}$on(t,e){if(!Kt(e))return se;let r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{let n=r.indexOf(e);n!==-1&&r.splice(n,1)}}$set(t){this.$$set&&!Js(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});var me=class{$destroy(){ye(this,1),this.$destroy=se}$on(e,r){if(!Kt(r))return se;let n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{let i=n.indexOf(r);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!Js(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var jt=Ee(require("obsidian"));var xa=Ee(require("obsidian"));var gi=class{constructor(){this.handlers=new Map;this.disabled=[]}on(e,r,n){if(e.includes("@")||r.includes("@"))throw new Error("Invalid context/event name - Cannot contain @");this.handlers.set(`${e}@${r}`,n)}off(e,r){if(r)this.handlers.delete(`${e}@${r}`);else for(let[n]of this.handlers.entries())n.startsWith(`${e}@`)&&this.handlers.delete(n)}disable(e){this.enable(e),this.disabled.push(e)}enable(e){this.disabled=this.disabled.filter(r=>r!==e)}emit(e,...r){let n=[...this.handlers.entries()].filter(([i,s])=>!this.disabled.includes(i.split("@")[0]));for(let[i,s]of n)i.endsWith(`@${e}`)&&s(...r)}};var Ut=[];function un(t,e=se){let r,n=new Set;function i(u){if(fe(t,u)&&(t=u,r)){let l=!Ut.length;for(let a of n)a[1](),Ut.push(a,t);if(l){for(let a=0;a<Ut.length;a+=2)Ut[a][0](Ut[a+1]);Ut.length=0}}}function s(u){i(u(t))}function o(u,l=se){let a=[u,l];return n.add(a),n.size===1&&(r=e(i)||se),u(t),()=>{n.delete(a),n.size===0&&(r(),r=null)}}return{set:i,update:s,subscribe:o}}var Q=Ee(require("obsidian"));var Z=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,ae=Object.keys,_e=Array.isArray;typeof Promise!="undefined"&&!Z.Promise&&(Z.Promise=Promise);function je(t,e){return typeof e!="object"||ae(e).forEach(function(r){t[r]=e[r]}),t}var Dr=Object.getPrototypeOf,Ec={}.hasOwnProperty;function De(t,e){return Ec.call(t,e)}function qt(t,e){typeof e=="function"&&(e=e(Dr(t))),(typeof Reflect=="undefined"?ae:Reflect.ownKeys)(e).forEach(r=>{Ue(t,r,e[r])})}var oo=Object.defineProperty;function Ue(t,e,r,n){oo(t,e,je(r&&De(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function Gt(t){return{from:function(e){return t.prototype=Object.create(e.prototype),Ue(t.prototype,"constructor",t),{extend:qt.bind(null,t.prototype)}}}}var Tc=Object.getOwnPropertyDescriptor;function yi(t,e){let r=Tc(t,e),n;return r||(n=Dr(t))&&yi(n,e)}var Dc=[].slice;function ln(t,e,r){return Dc.call(t,e,r)}function ao(t,e){return e(t)}function Or(t){if(!t)throw new Error("Assertion Failed")}function uo(t){Z.setImmediate?setImmediate(t):setTimeout(t,0)}function lo(t,e){return t.reduce((r,n,i)=>{var s=e(n,i);return s&&(r[s[0]]=s[1]),r},{})}function Oc(t,e,r){try{t.apply(null,r)}catch(n){e&&e(n)}}function qe(t,e){if(De(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var r=[],n=0,i=e.length;n<i;++n){var s=qe(t,e[n]);r.push(s)}return r}var o=e.indexOf(".");if(o!==-1){var u=t[e.substr(0,o)];return u===void 0?void 0:qe(u,e.substr(o+1))}}function Re(t,e,r){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){Or(typeof r!="string"&&"length"in r);for(var n=0,i=e.length;n<i;++n)Re(t,e[n],r[n])}else{var s=e.indexOf(".");if(s!==-1){var o=e.substr(0,s),u=e.substr(s+1);if(u==="")r===void 0?_e(t)&&!isNaN(parseInt(o))?t.splice(o,1):delete t[o]:t[o]=r;else{var l=t[o];(!l||!De(t,o))&&(l=t[o]={}),Re(l,u,r)}}else r===void 0?_e(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=r}}function kc(t,e){typeof e=="string"?Re(t,e,void 0):"length"in e&&[].map.call(e,function(r){Re(t,r,void 0)})}function co(t){var e={};for(var r in t)De(t,r)&&(e[r]=t[r]);return e}var Ic=[].concat;function fo(t){return Ic.apply([],t)}var ho="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(fo([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>Z[t]),Mc=ho.map(t=>Z[t]);lo(ho,t=>[t,!0]);var st=null;function kr(t){st=typeof WeakMap!="undefined"&&new WeakMap;let e=vi(t);return st=null,e}function vi(t){if(!t||typeof t!="object")return t;let e=st&&st.get(t);if(e)return e;if(_e(t)){e=[],st&&st.set(t,e);for(var r=0,n=t.length;r<n;++r)e.push(vi(t[r]))}else if(Mc.indexOf(t.constructor)>=0)e=t;else{let s=Dr(t);e=s===Object.prototype?{}:Object.create(s),st&&st.set(t,e);for(var i in t)De(t,i)&&(e[i]=vi(t[i]))}return e}var{toString:Pc}={};function _i(t){return Pc.call(t).slice(8,-1)}var bi=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator",Rc=typeof bi=="symbol"?function(t){var e;return t!=null&&(e=t[bi])&&e.apply(t)}:function(){return null},Qt={};function Ge(t){var e,r,n,i;if(arguments.length===1){if(_e(t))return t.slice();if(this===Qt&&typeof t=="string")return[t];if(i=Rc(t)){for(r=[];n=i.next(),!n.done;)r.push(n.value);return r}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(r=new Array(e);e--;)r[e]=t[e];return r}return[t]}for(e=arguments.length,r=new Array(e);e--;)r[e]=arguments[e];return r}var xi=typeof Symbol!="undefined"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1,Ve=typeof location!="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function po(t,e){Ve=t,mo=e}var mo=()=>!0,Bc=!new Error("").stack;function Ct(){if(Bc)try{throw Ct.arguments,new Error}catch(t){return t}return new Error}function wi(t,e){var r=t.stack;return r?(e=e||0,r.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),r.split(`
`).slice(e).filter(mo).map(n=>`
`+n).join("")):""}var Lc=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],go=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ji=Lc.concat(go),Nc={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Yt(t,e){this._e=Ct(),this.name=t,this.message=e}Gt(Yt).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+wi(this._e,2))}},toString:function(){return this.name+": "+this.message}});function yo(t,e){return t+". Errors: "+Object.keys(e).map(r=>e[r].toString()).filter((r,n,i)=>i.indexOf(r)===n).join(`
`)}function cn(t,e,r,n){this._e=Ct(),this.failures=e,this.failedKeys=n,this.successCount=r,this.message=yo(t,e)}Gt(cn).from(Yt);function Ir(t,e){this._e=Ct(),this.name="BulkError",this.failures=Object.keys(e).map(r=>e[r]),this.failuresByPos=e,this.message=yo(t,e)}Gt(Ir).from(Yt);var Ai=ji.reduce((t,e)=>(t[e]=e+"Error",t),{}),Kc=Yt,R=ji.reduce((t,e)=>{var r=e+"Error";function n(i,s){this._e=Ct(),this.name=r,i?typeof i=="string"?(this.message=`${i}${s?`
 `+s:""}`,this.inner=s||null):typeof i=="object"&&(this.message=`${i.name} ${i.message}`,this.inner=i):(this.message=Nc[e]||r,this.inner=null)}return Gt(n).from(Kc),t[e]=n,t},{});R.Syntax=SyntaxError;R.Type=TypeError;R.Range=RangeError;var vo=go.reduce((t,e)=>(t[e+"Error"]=R[e],t),{});function zc(t,e){if(!t||t instanceof Yt||t instanceof TypeError||t instanceof SyntaxError||!t.name||!vo[t.name])return t;var r=new vo[t.name](e||t.message,t);return"stack"in t&&Ue(r,"stack",{get:function(){return this.inner.stack}}),r}var fn=ji.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=R[e]),t),{});fn.ModifyError=cn;fn.DexieError=Yt;fn.BulkError=Ir;function X(){}function Mr(t){return t}function Vc(t,e){return t==null||t===Mr?e:function(r){return e(t(r))}}function Et(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Hc(t,e){return t===X?e:function(){var r=t.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Et(n,this.onsuccess):n),i&&(this.onerror=this.onerror?Et(i,this.onerror):i),s!==void 0?s:r}}function $c(t,e){return t===X?e:function(){t.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Et(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Et(n,this.onerror):n)}}function Wc(t,e){return t===X?e:function(r){var n=t.apply(this,arguments);je(r,n);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Et(i,this.onsuccess):i),s&&(this.onerror=this.onerror?Et(s,this.onerror):s),n===void 0?o===void 0?void 0:o:je(n,o)}}function Uc(t,e){return t===X?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function Si(t,e){return t===X?e:function(){var r=t.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,i=arguments.length,s=new Array(i);i--;)s[i]=arguments[i];return r.then(function(){return e.apply(n,s)})}return e.apply(this,arguments)}}var Pr={},qc=100,Gc=20,_o=100,[Fi,dn,Ci]=typeof Promise=="undefined"?[]:(()=>{let t=Promise.resolve();if(typeof crypto=="undefined"||!crypto.subtle)return[t,Dr(t),t];let e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Dr(e),t]})(),bo=dn&&dn.then,hn=Fi&&Fi.constructor,Ei=!!Ci,Ti=!1,Qc=Ci?()=>{Ci.then(yn)}:Z.setImmediate?setImmediate.bind(null,yn):Z.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{yn(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(yn,0)},Rr=function(t,e){Br.push([t,e]),pn&&(Qc(),pn=!1)},Di=!0,pn=!0,Tt=[],mn=[],Oi=null,ki=Mr,Jt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Do,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{Do(t[0],t[1])}catch{}})}},M=Jt,Br=[],Dt=0,gn=[];function O(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=X,this._lib=!1;var e=this._PSD=M;if(Ve&&(this._stackHolder=Ct(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Pr)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Mi(this,this._value);return}this._state=null,this._value=null,++e.ref,wo(this,t)}var Ii={get:function(){var t=M,e=bn;function r(n,i){var s=!t.global&&(t!==M||e!==bn);let o=s&&!Qe();var u=new O((l,a)=>{Pi(this,new xo(wn(n,t,s,o),wn(i,t,s,o),l,a,t))});return Ve&&So(u,this),u}return r.prototype=Pr,r},set:function(t){Ue(this,"then",t&&t.prototype===Pr?Ii:{get:function(){return t},set:Ii.set})}};qt(O.prototype,{then:Ii,_then:function(t,e){Pi(this,new xo(null,null,t,e,M))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],r=arguments[1];return typeof e=="function"?this.then(null,n=>n instanceof e?r(n):vn(n)):this.then(null,n=>n&&n.name===e?r(n):vn(n))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),vn(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Ti=!0;var t=Ao(this,[],Gc),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Ti=!1}}},timeout:function(t,e){return t<1/0?new O((r,n)=>{var i=setTimeout(()=>n(new R.Timeout(e)),t);this.then(r,n).finally(clearTimeout.bind(null,i))}):this}});typeof Symbol!="undefined"&&Symbol.toStringTag&&Ue(O.prototype,Symbol.toStringTag,"Dexie.Promise");Jt.env=Fo();function xo(t,e,r,n,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=r,this.reject=n,this.psd=i}qt(O,{all:function(){var t=Ge.apply(null,arguments).map(xn);return new O(function(e,r){t.length===0&&e([]);var n=t.length;t.forEach((i,s)=>O.resolve(i).then(o=>{t[s]=o,--n||e(t)},r))})},resolve:t=>{if(t instanceof O)return t;if(t&&typeof t.then=="function")return new O((r,n)=>{t.then(r,n)});var e=new O(Pr,!0,t);return So(e,Oi),e},reject:vn,race:function(){var t=Ge.apply(null,arguments).map(xn);return new O((e,r)=>{t.map(n=>O.resolve(n).then(e,r))})},PSD:{get:()=>M,set:t=>M=t},totalEchoes:{get:()=>bn},newPSD:ot,usePSD:Zt,scheduler:{get:()=>Rr,set:t=>{Rr=t}},rejectionMapper:{get:()=>ki,set:t=>{ki=t}},follow:(t,e)=>new O((r,n)=>ot((i,s)=>{var o=M;o.unhandleds=[],o.onunhandled=s,o.finalize=Et(function(){Jc(()=>{this.unhandleds.length===0?i():s(this.unhandleds[0])})},o.finalize),t()},e,r,n))});hn&&(hn.allSettled&&Ue(O,"allSettled",function(){let t=Ge.apply(null,arguments).map(xn);return new O(e=>{t.length===0&&e([]);let r=t.length,n=new Array(r);t.forEach((i,s)=>O.resolve(i).then(o=>n[s]={status:"fulfilled",value:o},o=>n[s]={status:"rejected",reason:o}).then(()=>--r||e(n)))})}),hn.any&&typeof AggregateError!="undefined"&&Ue(O,"any",function(){let t=Ge.apply(null,arguments).map(xn);return new O((e,r)=>{t.length===0&&r(new AggregateError([]));let n=t.length,i=new Array(n);t.forEach((s,o)=>O.resolve(s).then(u=>e(u),u=>{i[o]=u,--n||r(new AggregateError(i))}))})}));function wo(t,e){try{e(r=>{if(t._state===null){if(r===t)throw new TypeError("A promise cannot be resolved with itself.");var n=t._lib&&Lr();r&&typeof r.then=="function"?wo(t,(i,s)=>{r instanceof O?r._then(i,s):r.then(i,s)}):(t._state=!0,t._value=r,jo(t)),n&&Nr()}},Mi.bind(null,t))}catch(r){Mi(t,r)}}function Mi(t,e){if(mn.push(e),t._state===null){var r=t._lib&&Lr();e=ki(e),t._state=!1,t._value=e,Ve&&e!==null&&typeof e=="object"&&!e._promise&&Oc(()=>{var n=yi(e,"stack");e._promise=t,Ue(e,"stack",{get:()=>Ti?n&&(n.get?n.get.apply(e):n.value):t.stack})}),Xc(t),jo(t),r&&Nr()}}function jo(t){var e=t._listeners;t._listeners=[];for(var r=0,n=e.length;r<n;++r)Pi(t,e[r]);var i=t._PSD;--i.ref||i.finalize(),Dt===0&&(++Dt,Rr(()=>{--Dt==0&&Ri()},[]))}function Pi(t,e){if(t._state===null){t._listeners.push(e);return}var r=t._state?e.onFulfilled:e.onRejected;if(r===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Dt,Rr(Yc,[r,t,e])}function Yc(t,e,r){try{Oi=e;var n,i=e._value;e._state?n=t(i):(mn.length&&(mn=[]),n=t(i),mn.indexOf(i)===-1&&Zc(e)),r.resolve(n)}catch(s){r.reject(s)}finally{Oi=null,--Dt==0&&Ri(),--r.psd.ref||r.psd.finalize()}}function Ao(t,e,r){if(e.length===r)return e;var n="";if(t._state===!1){var i=t._value,s,o;i!=null?(s=i.name||"Error",o=i.message||i,n=wi(i,0)):(s=i,o=""),e.push(s+(o?": "+o:"")+n)}return Ve&&(n=wi(t._stackHolder,2),n&&e.indexOf(n)===-1&&e.push(n),t._prev&&Ao(t._prev,e,r)),e}function So(t,e){var r=e?e._numPrev+1:0;r<qc&&(t._prev=e,t._numPrev=r)}function yn(){Lr()&&Nr()}function Lr(){var t=Di;return Di=!1,pn=!1,t}function Nr(){var t,e,r;do for(;Br.length>0;)for(t=Br,Br=[],r=t.length,e=0;e<r;++e){var n=t[e];n[0].apply(null,n[1])}while(Br.length>0);Di=!0,pn=!0}function Ri(){var t=Tt;Tt=[],t.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var e=gn.slice(0),r=e.length;r;)e[--r]()}function Jc(t){function e(){t(),gn.splice(gn.indexOf(e),1)}gn.push(e),++Dt,Rr(()=>{--Dt==0&&Ri()},[])}function Xc(t){Tt.some(e=>e._value===t._value)||Tt.push(t)}function Zc(t){for(var e=Tt.length;e;)if(Tt[--e]._value===t._value){Tt.splice(e,1);return}}function vn(t){return new O(Pr,!1,t)}function te(t,e){var r=M;return function(){var n=Lr(),i=M;try{return at(r,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{at(i,!1),n&&Nr()}}}var be={awaits:0,echoes:0,id:0},ef=0,_n=[],Bi=0,bn=0,tf=0;function ot(t,e,r,n){var i=M,s=Object.create(i);s.parent=i,s.ref=0,s.global=!1,s.id=++tf;var o=Jt.env;s.env=Ei?{Promise:O,PromiseProp:{value:O,configurable:!0,writable:!0},all:O.all,race:O.race,allSettled:O.allSettled,any:O.any,resolve:O.resolve,reject:O.reject,nthen:Eo(o.nthen,s),gthen:Eo(o.gthen,s)}:{},e&&je(s,e),++i.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=Zt(s,t,r,n);return s.ref===0&&s.finalize(),u}function Xt(){return be.id||(be.id=++ef),++be.awaits,be.echoes+=_o,be.id}function Qe(){return be.awaits?(--be.awaits==0&&(be.id=0),be.echoes=be.awaits*_o,!0):!1}(""+bo).indexOf("[native code]")===-1&&(Xt=Qe=X);function xn(t){return be.echoes&&t&&t.constructor===hn?(Xt(),t.then(e=>(Qe(),e),e=>(Qe(),le(e)))):t}function rf(t){++bn,(!be.echoes||--be.echoes==0)&&(be.echoes=be.id=0),_n.push(M),at(t,!0)}function nf(){var t=_n[_n.length-1];_n.pop(),at(t,!1)}function at(t,e){var r=M;if((e?be.echoes&&(!Bi++||t!==M):Bi&&(!--Bi||t!==M))&&Co(e?rf.bind(null,t):nf),t!==M&&(M=t,r===Jt&&(Jt.env=Fo()),Ei)){var n=Jt.env.Promise,i=t.env;dn.then=i.nthen,n.prototype.then=i.gthen,(r.global||t.global)&&(Object.defineProperty(Z,"Promise",i.PromiseProp),n.all=i.all,n.race=i.race,n.resolve=i.resolve,n.reject=i.reject,i.allSettled&&(n.allSettled=i.allSettled),i.any&&(n.any=i.any))}}function Fo(){var t=Z.Promise;return Ei?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(Z,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:dn.then,gthen:t.prototype.then}:{}}function Zt(t,e,r,n,i){var s=M;try{return at(t,!0),e(r,n,i)}finally{at(s,!1)}}function Co(t){bo.call(Fi,t)}function wn(t,e,r,n){return typeof t!="function"?t:function(){var i=M;r&&Xt(),at(e,!0);try{return t.apply(this,arguments)}finally{at(i,!1),n&&Co(Qe)}}}function Eo(t,e){return function(r,n){return t.call(this,wn(r,e),wn(n,e))}}var To="unhandledrejection";function Do(t,e){var r;try{r=e.onuncatched(t)}catch{}if(r!==!1)try{var n,i={promise:e,reason:t};if(Z.document&&document.createEvent?(n=document.createEvent("Event"),n.initEvent(To,!0,!0),je(n,i)):Z.CustomEvent&&(n=new CustomEvent(To,{detail:i}),je(n,i)),n&&Z.dispatchEvent&&(dispatchEvent(n),!Z.PromiseRejectionEvent&&Z.onunhandledrejection))try{Z.onunhandledrejection(n)}catch{}Ve&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var le=O.reject;function Li(t,e,r,n){if(!t.idbdb||!t._state.openComplete&&!M.letThrough&&!t._vip){if(t._state.openComplete)return le(new R.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return le(new R.DatabaseClosed);t.open().catch(X)}return t._state.dbReadyPromise.then(()=>Li(t,e,r,n))}else{var i=t._createTransaction(e,r,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===Ai.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Li(t,e,r,n))):le(s)}return i._promise(e,(s,o)=>ot(()=>(M.trans=i,n(s,o,i)))).then(s=>i._completion.then(()=>s))}}var Oo="3.2.2",Ot=String.fromCharCode(65535),Ni=-1/0,Ye="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ko="String expected.",Kr=[],jn=typeof navigator!="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),sf=jn,of=jn,Io=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),An="__dbnames",Ki="readonly",zi="readwrite";function kt(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var Mo={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Sn(t){return typeof t=="string"&&!/\./.test(t)?e=>(e[t]===void 0&&t in e&&(e=kr(e),delete e[t]),e):e=>e}var Po=class{_trans(e,r,n){let i=this._tx||M.trans,s=this.name;function o(l,a,c){if(!c.schema[s])throw new R.NotFound("Table "+s+" not part of transaction");return r(c.idbtrans,c)}let u=Lr();try{return i&&i.db===this.db?i===M.trans?i._promise(e,o,n):ot(()=>i._promise(e,o,n),{trans:i,transless:M.transless||M}):Li(this.db,e,[this.name],o)}finally{u&&Nr()}}get(e,r){return e&&e.constructor===Object?this.where(e).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:e}).then(i=>this.hook.reading.fire(i))).then(r)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(_e(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);let r=ae(e);if(r.length===1)return this.where(r[0]).equals(e[r[0]]);let n=this.schema.indexes.concat(this.schema.primKey).filter(a=>a.compound&&r.every(c=>a.keyPath.indexOf(c)>=0)&&a.keyPath.every(c=>r.indexOf(c)>=0))[0];if(n&&this.db._maxKey!==Ot)return this.where(n.name).equals(n.keyPath.map(a=>e[a]));!n&&Ve&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);let{idxByName:i}=this.schema,s=this.db._deps.indexedDB;function o(a,c){try{return s.cmp(a,c)===0}catch{return!1}}let[u,l]=r.reduce(([a,c],d)=>{let f=i[d],p=e[d];return[a||f,a||!f?kt(c,f&&f.multi?b=>{let w=qe(b,d);return _e(w)&&w.some(x=>o(p,x))}:b=>o(p,qe(b,d))):c]},[null,null]);return u?this.where(u.name).equals(e[u.keyPath]).filter(l):n?this.filter(l):this.where(r).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,_e(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;let r=n=>{if(!n)return n;let i=Object.create(e.prototype);for(var s in n)if(De(n,s))try{i[s]=n[s]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),e}defineClass(){function e(r){je(this,r)}return this.mapToClass(e)}add(e,r){let{auto:n,keyPath:i}=this.schema.primKey,s=e;return i&&n&&(s=Sn(i)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"add",keys:r!=null?[r]:null,values:[s]})).then(o=>o.numFailures?O.reject(o.failures[0]):o.lastResult).then(o=>{if(i)try{Re(e,i,o)}catch{}return o})}update(e,r){if(typeof e=="object"&&!_e(e)){let n=qe(e,this.schema.primKey.keyPath);if(n===void 0)return le(new R.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?ae(r).forEach(i=>{Re(e,i,r[i])}):r(e,{value:e,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}else return this.where(":id").equals(e).modify(r)}put(e,r){let{auto:n,keyPath:i}=this.schema.primKey,s=e;return i&&n&&(s=Sn(i)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"put",values:[s],keys:r!=null?[r]:null})).then(o=>o.numFailures?O.reject(o.failures[0]):o.lastResult).then(o=>{if(i)try{Re(e,i,o)}catch{}return o})}delete(e){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[e]})).then(r=>r.numFailures?O.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Mo})).then(e=>e.numFailures?O.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",r=>this.core.getMany({keys:e,trans:r}).then(n=>n.map(i=>this.hook.reading.fire(i))))}bulkAdd(e,r,n){let i=Array.isArray(r)?r:void 0;n=n||(i?void 0:r);let s=n?n.allKeys:void 0;return this._trans("readwrite",o=>{let{auto:u,keyPath:l}=this.schema.primKey;if(l&&i)throw new R.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new R.InvalidArgument("Arguments objects and keys must have the same length");let a=e.length,c=l&&u?e.map(Sn(l)):e;return this.core.mutate({trans:o,type:"add",keys:i,values:c,wantResults:s}).then(({numFailures:d,results:f,lastResult:p,failures:b})=>{let w=s?f:p;if(d===0)return w;throw new Ir(`${this.name}.bulkAdd(): ${d} of ${a} operations failed`,b)})})}bulkPut(e,r,n){let i=Array.isArray(r)?r:void 0;n=n||(i?void 0:r);let s=n?n.allKeys:void 0;return this._trans("readwrite",o=>{let{auto:u,keyPath:l}=this.schema.primKey;if(l&&i)throw new R.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new R.InvalidArgument("Arguments objects and keys must have the same length");let a=e.length,c=l&&u?e.map(Sn(l)):e;return this.core.mutate({trans:o,type:"put",keys:i,values:c,wantResults:s}).then(({numFailures:d,results:f,lastResult:p,failures:b})=>{let w=s?f:p;if(d===0)return w;throw new Ir(`${this.name}.bulkPut(): ${d} of ${a} operations failed`,b)})})}bulkDelete(e){let r=e.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:e})).then(({numFailures:n,lastResult:i,failures:s})=>{if(n===0)return i;throw new Ir(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,s)})}};function zr(t){var e={},r=function(u,l){if(l){for(var a=arguments.length,c=new Array(a-1);--a;)c[a-1]=arguments[a];return e[u].subscribe.apply(null,c),t}else if(typeof u=="string")return e[u]};r.addEventType=s;for(var n=1,i=arguments.length;n<i;++n)s(arguments[n]);return r;function s(u,l,a){if(typeof u=="object")return o(u);l||(l=Uc),a||(a=X);var c={subscribers:[],fire:a,subscribe:function(d){c.subscribers.indexOf(d)===-1&&(c.subscribers.push(d),c.fire=l(c.fire,d))},unsubscribe:function(d){c.subscribers=c.subscribers.filter(function(f){return f!==d}),c.fire=c.subscribers.reduce(l,a)}};return e[u]=r[u]=c,c}function o(u){ae(u).forEach(function(l){var a=u[l];if(_e(a))s(l,u[l][0],u[l][1]);else if(a==="asap")var c=s(l,Mr,function(){for(var f=arguments.length,p=new Array(f);f--;)p[f]=arguments[f];c.subscribers.forEach(function(b){uo(function(){b.apply(null,p)})})});else throw new R.InvalidArgument("Invalid event config")})}}function Vr(t,e){return Gt(e).from({prototype:t}),e}function af(t){return Vr(Po.prototype,function(r,n,i){this.db=t,this._tx=i,this.name=r,this.schema=n,this.hook=t._allTables[r]?t._allTables[r].hook:zr(null,{creating:[Hc,X],reading:[Vc,Mr],updating:[Wc,X],deleting:[$c,X]})})}function er(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Vi(t,e){t.filter=kt(t.filter,e)}function Hi(t,e,r){var n=t.replayFilter;t.replayFilter=n?()=>kt(n(),e()):e,t.justLimit=r&&!n}function uf(t,e){t.isMatch=kt(t.isMatch,e)}function Fn(t,e){if(t.isPrimKey)return e.primaryKey;let r=e.getIndexByKeyPath(t.index);if(!r)throw new R.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return r}function Ro(t,e,r){let n=Fn(t,e.schema);return e.openCursor({trans:r,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:n,range:t.range}})}function Cn(t,e,r,n){let i=t.replayFilter?kt(t.filter,t.replayFilter()):t.filter;if(t.or){let s={},o=(u,l,a)=>{if(!i||i(l,a,f=>l.stop(f),f=>l.fail(f))){var c=l.primaryKey,d=""+c;d==="[object ArrayBuffer]"&&(d=""+new Uint8Array(c)),De(s,d)||(s[d]=!0,e(u,l,a))}};return Promise.all([t.or._iterate(o,r),Bo(Ro(t,n,r),t.algorithm,o,!t.keysOnly&&t.valueMapper)])}else return Bo(Ro(t,n,r),kt(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function Bo(t,e,r,n){var i=n?(o,u,l)=>r(n(o),u,l):r,s=te(i);return t.then(o=>{if(o)return o.start(()=>{var u=()=>o.continue();(!e||e(o,l=>u=l,l=>{o.stop(l),u=X},l=>{o.fail(l),u=X}))&&s(o.value,o,l=>u=l),u()})})}function Ae(t,e){try{let r=Lo(t),n=Lo(e);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return cf(No(t),No(e));case"Array":return lf(t,e)}}catch{}return NaN}function lf(t,e){let r=t.length,n=e.length,i=r<n?r:n;for(let s=0;s<i;++s){let o=Ae(t[s],e[s]);if(o!==0)return o}return r===n?0:r<n?-1:1}function cf(t,e){let r=t.length,n=e.length,i=r<n?r:n;for(let s=0;s<i;++s)if(t[s]!==e[s])return t[s]<e[s]?-1:1;return r===n?0:r<n?-1:1}function Lo(t){let e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";let r=_i(t);return r==="ArrayBuffer"?"binary":r}function No(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var Ko=class{_read(e,r){var n=this._ctx;return n.error?n.table._trans(null,le.bind(null,n.error)):n.table._trans("readonly",e).then(r)}_write(e){var r=this._ctx;return r.error?r.table._trans(null,le.bind(null,r.error)):r.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var r=this._ctx;r.algorithm=kt(r.algorithm,e)}_iterate(e,r){return Cn(this._ctx,e,r,this._ctx.table.core)}clone(e){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&je(n,e),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(e){var r=this._ctx;return this._read(n=>Cn(r,e,n,r.table.core))}count(e){return this._read(r=>{let n=this._ctx,i=n.table.core;if(er(n,!0))return i.count({trans:r,query:{index:Fn(n,i.schema),range:n.range}}).then(o=>Math.min(o,n.limit));var s=0;return Cn(n,()=>(++s,!1),r,i).then(()=>s)}).then(e)}sortBy(e,r){let n=e.split(".").reverse(),i=n[0],s=n.length-1;function o(a,c){return c?o(a[n[c]],c-1):a[i]}var u=this._ctx.dir==="next"?1:-1;function l(a,c){var d=o(a,s),f=o(c,s);return d<f?-u:d>f?u:0}return this.toArray(function(a){return a.sort(l)}).then(r)}toArray(e){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&er(n,!0)&&n.limit>0){let{valueMapper:i}=n,s=Fn(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:s,range:n.range}}).then(({result:o})=>i?o.map(i):o)}else{let i=[];return Cn(n,s=>i.push(s),r,n.table.core).then(()=>i)}},e)}offset(e){var r=this._ctx;return e<=0?this:(r.offset+=e,er(r)?Hi(r,()=>{var n=e;return(i,s)=>n===0?!0:n===1?(--n,!1):(s(()=>{i.advance(n),n=0}),!1)}):Hi(r,()=>{var n=e;return()=>--n<0}),this)}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Hi(this._ctx,()=>{var r=e;return function(n,i,s){return--r<=0&&i(s),r>=0}},!0),this}until(e,r){return Vi(this._ctx,function(n,i,s){return e(n.value)?(i(s),r):!0}),this}first(e){return this.limit(1).toArray(function(r){return r[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){return Vi(this._ctx,function(r){return e(r.value)}),uf(this._ctx,e),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){e(i.key,i)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){e(i.primaryKey,i)})}keys(e){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,s){n.push(s.key)}).then(function(){return n}).then(e)}primaryKeys(e){var r=this._ctx;if(r.dir==="next"&&er(r,!0)&&r.limit>0)return this._read(i=>{var s=Fn(r,r.table.core.schema);return r.table.core.query({trans:i,values:!1,limit:r.limit,query:{index:s,range:r.range}})}).then(({result:i})=>i).then(e);r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,s){n.push(s.primaryKey)}).then(function(){return n}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(r){return r[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,r=e.index&&e.table.schema.idxByName[e.index];if(!r||!r.multi)return this;var n={};return Vi(this._ctx,function(i){var s=i.primaryKey.toString(),o=De(n,s);return n[s]=!0,!o}),this}modify(e){var r=this._ctx;return this._write(n=>{var i;if(typeof e=="function")i=e;else{var s=ae(e),o=s.length;i=function(w){for(var x=!1,h=0;h<o;++h){var y=s[h],m=e[y];qe(w,y)!==m&&(Re(w,y,m),x=!0)}return x}}let u=r.table.core,{outbound:l,extractKey:a}=u.schema.primaryKey,c=this.db._options.modifyChunkSize||200,d=[],f=0,p=[],b=(w,x)=>{let{failures:h,numFailures:y}=x;f+=w-y;for(let m of ae(h))d.push(h[m])};return this.clone().primaryKeys().then(w=>{let x=h=>{let y=Math.min(c,w.length-h);return u.getMany({trans:n,keys:w.slice(h,h+y),cache:"immutable"}).then(m=>{let g=[],v=[],_=l?[]:null,j=[];for(let S=0;S<y;++S){let F=m[S],E={value:kr(F),primKey:w[h+S]};i.call(E,E.value,E)!==!1&&(E.value==null?j.push(w[h+S]):!l&&Ae(a(F),a(E.value))!==0?(j.push(w[h+S]),g.push(E.value)):(v.push(E.value),l&&_.push(w[h+S])))}let A=er(r)&&r.limit===1/0&&(typeof e!="function"||e===$i)&&{index:r.index,range:r.range};return Promise.resolve(g.length>0&&u.mutate({trans:n,type:"add",values:g}).then(S=>{for(let F in S.failures)j.splice(parseInt(F),1);b(g.length,S)})).then(()=>(v.length>0||A&&typeof e=="object")&&u.mutate({trans:n,type:"put",keys:_,values:v,criteria:A,changeSpec:typeof e!="function"&&e}).then(S=>b(v.length,S))).then(()=>(j.length>0||A&&e===$i)&&u.mutate({trans:n,type:"delete",keys:j,criteria:A}).then(S=>b(j.length,S))).then(()=>w.length>h+y&&x(h+c))})};return x(0).then(()=>{if(d.length>0)throw new cn("Error modifying one or more objects",d,f,p);return w.length})})})}delete(){var e=this._ctx,r=e.range;return er(e)&&(e.isPrimKey&&!of||r.type===3)?this._write(n=>{let{primaryKey:i}=e.table.core.schema,s=r;return e.table.core.count({trans:n,query:{index:i,range:s}}).then(o=>e.table.core.mutate({trans:n,type:"deleteRange",range:s}).then(({failures:u,lastResult:l,results:a,numFailures:c})=>{if(c)throw new cn("Could not delete some values",Object.keys(u).map(d=>u[d]),o-c);return o-c}))}):this.modify($i)}},$i=(t,e)=>e.value=null;function ff(t){return Vr(Ko.prototype,function(r,n){this.db=t;let i=Mo,s=null;if(n)try{i=n()}catch(a){s=a}let o=r._ctx,u=o.table,l=u.hook.reading.fire;this._ctx={table:u,index:o.index,isPrimKey:!o.index||u.schema.primKey.keyPath&&o.index===u.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:s,or:o.or,valueMapper:l!==Mr?l:null}})}function df(t,e){return t<e?-1:t===e?0:1}function hf(t,e){return t>e?-1:t===e?0:1}function Oe(t,e,r){var n=t instanceof Wi?new t.Collection(t):t;return n._ctx.error=r?new r(e):new TypeError(e),n}function tr(t){return new t.Collection(t,()=>zo("")).limit(0)}function pf(t){return t==="next"?e=>e.toUpperCase():e=>e.toLowerCase()}function mf(t){return t==="next"?e=>e.toLowerCase():e=>e.toUpperCase()}function gf(t,e,r,n,i,s){for(var o=Math.min(t.length,n.length),u=-1,l=0;l<o;++l){var a=e[l];if(a!==n[l])return i(t[l],r[l])<0?t.substr(0,l)+r[l]+r.substr(l+1):i(t[l],n[l])<0?t.substr(0,l)+n[l]+r.substr(l+1):u>=0?t.substr(0,u)+e[u]+r.substr(u+1):null;i(t[l],a)<0&&(u=l)}return o<n.length&&s==="next"?t+r.substr(t.length):o<t.length&&s==="prev"?t.substr(0,r.length):u<0?null:t.substr(0,u)+n[u]+r.substr(u+1)}function En(t,e,r,n){var i,s,o,u,l,a,c,d=r.length;if(!r.every(w=>typeof w=="string"))return Oe(t,ko);function f(w){i=pf(w),s=mf(w),o=w==="next"?df:hf;var x=r.map(function(h){return{lower:s(h),upper:i(h)}}).sort(function(h,y){return o(h.lower,y.lower)});u=x.map(function(h){return h.upper}),l=x.map(function(h){return h.lower}),a=w,c=w==="next"?"":n}f("next");var p=new t.Collection(t,()=>ut(u[0],l[d-1]+n));p._ondirectionchange=function(w){f(w)};var b=0;return p._addAlgorithm(function(w,x,h){var y=w.key;if(typeof y!="string")return!1;var m=s(y);if(e(m,l,b))return!0;for(var g=null,v=b;v<d;++v){var _=gf(y,m,u[v],l[v],o,a);_===null&&g===null?b=v+1:(g===null||o(g,_)>0)&&(g=_)}return x(g!==null?function(){w.continue(g+c)}:h),!1}),p}function ut(t,e,r,n){return{type:2,lower:t,upper:e,lowerOpen:r,upperOpen:n}}function zo(t){return{type:1,lower:t,upper:t}}var Wi=class{get Collection(){return this._ctx.table.db.Collection}between(e,r,n,i){n=n!==!1,i=i===!0;try{return this._cmp(e,r)>0||this._cmp(e,r)===0&&(n||i)&&!(n&&i)?tr(this):new this.Collection(this,()=>ut(e,r,!n,!i))}catch{return Oe(this,Ye)}}equals(e){return e==null?Oe(this,Ye):new this.Collection(this,()=>zo(e))}above(e){return e==null?Oe(this,Ye):new this.Collection(this,()=>ut(e,void 0,!0))}aboveOrEqual(e){return e==null?Oe(this,Ye):new this.Collection(this,()=>ut(e,void 0,!1))}below(e){return e==null?Oe(this,Ye):new this.Collection(this,()=>ut(void 0,e,!1,!0))}belowOrEqual(e){return e==null?Oe(this,Ye):new this.Collection(this,()=>ut(void 0,e))}startsWith(e){return typeof e!="string"?Oe(this,ko):this.between(e,e+Ot,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):En(this,(r,n)=>r.indexOf(n[0])===0,[e],Ot)}equalsIgnoreCase(e){return En(this,(r,n)=>r===n[0],[e],"")}anyOfIgnoreCase(){var e=Ge.apply(Qt,arguments);return e.length===0?tr(this):En(this,(r,n)=>n.indexOf(r)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=Ge.apply(Qt,arguments);return e.length===0?tr(this):En(this,(r,n)=>n.some(i=>r.indexOf(i)===0),e,Ot)}anyOf(){let e=Ge.apply(Qt,arguments),r=this._cmp;try{e.sort(r)}catch{return Oe(this,Ye)}if(e.length===0)return tr(this);let n=new this.Collection(this,()=>ut(e[0],e[e.length-1]));n._ondirectionchange=s=>{r=s==="next"?this._ascending:this._descending,e.sort(r)};let i=0;return n._addAlgorithm((s,o,u)=>{let l=s.key;for(;r(l,e[i])>0;)if(++i,i===e.length)return o(u),!1;return r(l,e[i])===0?!0:(o(()=>{s.continue(e[i])}),!1)}),n}notEqual(e){return this.inAnyRange([[Ni,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){let e=Ge.apply(Qt,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Oe(this,Ye)}let r=e.reduce((n,i)=>n?n.concat([[n[n.length-1][1],i]]):[[Ni,i]],null);return r.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,r){let n=this._cmp,i=this._ascending,s=this._descending,o=this._min,u=this._max;if(e.length===0)return tr(this);if(!e.every(g=>g[0]!==void 0&&g[1]!==void 0&&i(g[0],g[1])<=0))return Oe(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",R.InvalidArgument);let l=!r||r.includeLowers!==!1,a=r&&r.includeUppers===!0;function c(g,v){let _=0,j=g.length;for(;_<j;++_){let A=g[_];if(n(v[0],A[1])<0&&n(v[1],A[0])>0){A[0]=o(A[0],v[0]),A[1]=u(A[1],v[1]);break}}return _===j&&g.push(v),g}let d=i;function f(g,v){return d(g[0],v[0])}let p;try{p=e.reduce(c,[]),p.sort(f)}catch{return Oe(this,Ye)}let b=0,w=a?g=>i(g,p[b][1])>0:g=>i(g,p[b][1])>=0,x=l?g=>s(g,p[b][0])>0:g=>s(g,p[b][0])>=0;function h(g){return!w(g)&&!x(g)}let y=w,m=new this.Collection(this,()=>ut(p[0][0],p[p.length-1][1],!l,!a));return m._ondirectionchange=g=>{g==="next"?(y=w,d=i):(y=x,d=s),p.sort(f)},m._addAlgorithm((g,v,_)=>{for(var j=g.key;y(j);)if(++b,b===p.length)return v(_),!1;return h(j)?!0:(this._cmp(j,p[b][1])===0||this._cmp(j,p[b][0])===0||v(()=>{d===i?g.continue(p[b][0]):g.continue(p[b][1])}),!1)}),m}startsWithAnyOf(){let e=Ge.apply(Qt,arguments);return e.every(r=>typeof r=="string")?e.length===0?tr(this):this.inAnyRange(e.map(r=>[r,r+Ot])):Oe(this,"startsWithAnyOf() only works with strings")}};function yf(t){return Vr(Wi.prototype,function(r,n,i){this.db=t,this._ctx={table:r,index:n===":id"?null:n,or:i};let s=t._deps.indexedDB;if(!s)throw new R.MissingAPI;this._cmp=this._ascending=s.cmp.bind(s),this._descending=(o,u)=>s.cmp(u,o),this._max=(o,u)=>s.cmp(o,u)>0?o:u,this._min=(o,u)=>s.cmp(o,u)<0?o:u,this._IDBKeyRange=t._deps.IDBKeyRange})}function He(t){return te(function(e){return Hr(e),t(e.target.error),!1})}function Hr(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var $r="storagemutated",lt="x-storagemutated-1",ct=zr(null,$r),Vo=class{_lock(){return Or(!M.global),++this._reculock,this._reculock===1&&!M.global&&(M.lockOwnerFor=this),this}_unlock(){if(Or(!M.global),--this._reculock==0)for(M.global||(M.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Zt(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&M.lockOwnerFor!==this}create(e){if(!this.mode)return this;let r=this.db.idbdb,n=this.db._state.dbOpenError;if(Or(!this.idbtrans),!e&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new R.DatabaseClosed(n);case"MissingAPIError":throw new R.MissingAPI(n.message,n);default:throw new R.OpenFailed(n)}if(!this.active)throw new R.TransactionInactive;return Or(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=te(i=>{Hr(i),this._reject(e.error)}),e.onabort=te(i=>{Hr(i),this.active&&this._reject(new R.Abort(e.error)),this.active=!1,this.on("abort").fire(i)}),e.oncomplete=te(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&ct.storagemutated.fire(e.mutatedParts)}),this}_promise(e,r,n){if(e==="readwrite"&&this.mode!=="readwrite")return le(new R.ReadOnly("Transaction is readonly"));if(!this.active)return le(new R.TransactionInactive);if(this._locked())return new O((s,o)=>{this._blockedFuncs.push([()=>{this._promise(e,r,n).then(s,o)},M])});if(n)return ot(()=>{var s=new O((o,u)=>{this._lock();let l=r(o,u,this);l&&l.then&&l.then(o,u)});return s.finally(()=>this._unlock()),s._lib=!0,s});var i=new O((s,o)=>{var u=r(s,o,this);u&&u.then&&u.then(s,o)});return i._lib=!0,i}_root(){return this.parent?this.parent._root():this}waitFor(e){var r=this._root();let n=O.resolve(e);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var i=r.idbtrans.objectStore(r.storeNames[0]);(function o(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var s=r._waitingFor;return new O((o,u)=>{n.then(l=>r._waitingQueue.push(te(o.bind(null,l))),l=>r._waitingQueue.push(te(u.bind(null,l)))).finally(()=>{r._waitingFor===s&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new R.Abort))}table(e){let r=this._memoizedTables||(this._memoizedTables={});if(De(r,e))return r[e];let n=this.schema[e];if(!n)throw new R.NotFound("Table "+e+" not part of transaction");let i=new this.db.Table(e,n,this);return i.core=this.db.core.table(e),r[e]=i,i}};function vf(t){return Vr(Vo.prototype,function(r,n,i,s,o){this.db=t,this.mode=r,this.storeNames=n,this.schema=i,this.chromeTransactionDurability=s,this.idbtrans=null,this.on=zr(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new O((u,l)=>{this._resolve=u,this._reject=l}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},u=>{var l=this.active;return this.active=!1,this.on.error.fire(u),this.parent?this.parent._reject(u):l&&this.idbtrans&&this.idbtrans.abort(),le(u)})})}function Ui(t,e,r,n,i,s,o){return{name:t,keyPath:e,unique:r,multi:n,auto:i,compound:s,src:(r&&!o?"&":"")+(n?"*":"")+(i?"++":"")+Ho(e)}}function Ho(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function $o(t,e,r){return{name:t,primKey:e,indexes:r,mappedClass:null,idxByName:lo(r,n=>[n.name,n])}}function _f(t){return t.length===1?t[0]:t}var Wr=t=>{try{return t.only([[]]),Wr=()=>[[]],[[]]}catch{return Wr=()=>Ot,Ot}};function qi(t){return t==null?()=>{}:typeof t=="string"?bf(t):e=>qe(e,t)}function bf(t){return t.split(".").length===1?r=>r[t]:r=>qe(r,t)}function Wo(t){return[].slice.call(t)}var xf=0;function Ur(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function wf(t,e,r){function n(c,d){let f=Wo(c.objectStoreNames);return{schema:{name:c.name,tables:f.map(p=>d.objectStore(p)).map(p=>{let{keyPath:b,autoIncrement:w}=p,x=_e(b),h=b==null,y={},m={name:p.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:h,compound:x,keyPath:b,autoIncrement:w,unique:!0,extractKey:qi(b)},indexes:Wo(p.indexNames).map(g=>p.index(g)).map(g=>{let{name:v,unique:_,multiEntry:j,keyPath:A}=g,S=_e(A),F={name:v,compound:S,keyPath:A,unique:_,multiEntry:j,extractKey:qi(A)};return y[Ur(A)]=F,F}),getIndexByKeyPath:g=>y[Ur(g)]};return y[":id"]=m.primaryKey,b!=null&&(y[Ur(b)]=m.primaryKey),m})},hasGetAll:f.length>0&&"getAll"in d.objectStore(f[0])&&!(typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(c){if(c.type===3)return null;if(c.type===4)throw new Error("Cannot convert never type to IDBKeyRange");let{lower:d,upper:f,lowerOpen:p,upperOpen:b}=c;return d===void 0?f===void 0?null:e.upperBound(f,!!b):f===void 0?e.lowerBound(d,!!p):e.bound(d,f,!!p,!!b)}function s(c){let d=c.name;function f({trans:w,type:x,keys:h,values:y,range:m}){return new Promise((g,v)=>{g=te(g);let _=w.objectStore(d),j=_.keyPath==null,A=x==="put"||x==="add";if(!A&&x!=="delete"&&x!=="deleteRange")throw new Error("Invalid operation type: "+x);let{length:S}=h||y||{length:1};if(h&&y&&h.length!==y.length)throw new Error("Given keys array must have same length as given values array.");if(S===0)return g({numFailures:0,failures:{},results:[],lastResult:void 0});let F,E=[],k=[],T=0,L=C=>{++T,Hr(C)};if(x==="deleteRange"){if(m.type===4)return g({numFailures:T,failures:k,results:[],lastResult:void 0});m.type===3?E.push(F=_.clear()):E.push(F=_.delete(i(m)))}else{let[C,N]=A?j?[y,h]:[y,null]:[h,null];if(A)for(let q=0;q<S;++q)E.push(F=N&&N[q]!==void 0?_[x](C[q],N[q]):_[x](C[q])),F.onerror=L;else for(let q=0;q<S;++q)E.push(F=_[x](C[q])),F.onerror=L}let Y=C=>{let N=C.target.result;E.forEach((q,$)=>q.error!=null&&(k[$]=q.error)),g({numFailures:T,failures:k,results:x==="delete"?h:E.map(q=>q.result),lastResult:N})};F.onerror=C=>{L(C),Y(C)},F.onsuccess=Y})}function p({trans:w,values:x,query:h,reverse:y,unique:m}){return new Promise((g,v)=>{g=te(g);let{index:_,range:j}=h,A=w.objectStore(d),S=_.isPrimaryKey?A:A.index(_.name),F=y?m?"prevunique":"prev":m?"nextunique":"next",E=x||!("openKeyCursor"in S)?S.openCursor(i(j),F):S.openKeyCursor(i(j),F);E.onerror=He(v),E.onsuccess=te(k=>{let T=E.result;if(!T){g(null);return}T.___id=++xf,T.done=!1;let L=T.continue.bind(T),Y=T.continuePrimaryKey;Y&&(Y=Y.bind(T));let C=T.advance.bind(T),N=()=>{throw new Error("Cursor not started")},q=()=>{throw new Error("Cursor not stopped")};T.trans=w,T.stop=T.continue=T.continuePrimaryKey=T.advance=N,T.fail=te(v),T.next=function(){let $=1;return this.start(()=>$--?this.continue():this.stop()).then(()=>this)},T.start=$=>{let W=new Promise((Ne,xr)=>{Ne=te(Ne),E.onerror=He(xr),T.fail=xr,T.stop=lc=>{T.stop=T.continue=T.continuePrimaryKey=T.advance=q,Ne(lc)}}),ie=()=>{if(E.result)try{$()}catch(Ne){T.fail(Ne)}else T.done=!0,T.start=()=>{throw new Error("Cursor behind last entry")},T.stop()};return E.onsuccess=te(Ne=>{E.onsuccess=ie,ie()}),T.continue=L,T.continuePrimaryKey=Y,T.advance=C,ie(),W},g(T)},v)})}function b(w){return x=>new Promise((h,y)=>{h=te(h);let{trans:m,values:g,limit:v,query:_}=x,j=v===1/0?void 0:v,{index:A,range:S}=_,F=m.objectStore(d),E=A.isPrimaryKey?F:F.index(A.name),k=i(S);if(v===0)return h({result:[]});if(w){let T=g?E.getAll(k,j):E.getAllKeys(k,j);T.onsuccess=L=>h({result:L.target.result}),T.onerror=He(y)}else{let T=0,L=g||!("openKeyCursor"in E)?E.openCursor(k):E.openKeyCursor(k),Y=[];L.onsuccess=C=>{let N=L.result;if(!N)return h({result:Y});if(Y.push(g?N.value:N.primaryKey),++T===v)return h({result:Y});N.continue()},L.onerror=He(y)}})}return{name:d,schema:c,mutate:f,getMany({trans:w,keys:x}){return new Promise((h,y)=>{h=te(h);let m=w.objectStore(d),g=x.length,v=new Array(g),_=0,j=0,A,S=E=>{let k=E.target;(v[k._pos]=k.result)!=null,++j===_&&h(v)},F=He(y);for(let E=0;E<g;++E)x[E]!=null&&(A=m.get(x[E]),A._pos=E,A.onsuccess=S,A.onerror=F,++_);_===0&&h(v)})},get({trans:w,key:x}){return new Promise((h,y)=>{h=te(h);let g=w.objectStore(d).get(x);g.onsuccess=v=>h(v.target.result),g.onerror=He(y)})},query:b(u),openCursor:p,count({query:w,trans:x}){let{index:h,range:y}=w;return new Promise((m,g)=>{let v=x.objectStore(d),_=h.isPrimaryKey?v:v.index(h.name),j=i(y),A=j?_.count(j):_.count();A.onsuccess=te(S=>m(S.target.result)),A.onerror=He(g)})}}}let{schema:o,hasGetAll:u}=n(t,r),l=o.tables.map(c=>s(c)),a={};return l.forEach(c=>a[c.name]=c),{stack:"dbcore",transaction:t.transaction.bind(t),table(c){if(!a[c])throw new Error(`Table '${c}' not found`);return a[c]},MIN_KEY:-1/0,MAX_KEY:Wr(e),schema:o}}function jf(t,e){return e.reduce((r,{create:n})=>ne(ne({},r),n(r)),t)}function Af(t,e,{IDBKeyRange:r,indexedDB:n},i){return{dbcore:jf(wf(e,r,i),t.dbcore)}}function Gi({_novip:t},e){let r=e.db,n=Af(t._middlewares,r,t._deps,e);t.core=n.dbcore,t.tables.forEach(i=>{let s=i.name;t.core.schema.tables.some(o=>o.name===s)&&(i.core=t.core.table(s),t[s]instanceof t.Table&&(t[s].core=i.core))})}function Tn({_novip:t},e,r,n){r.forEach(i=>{let s=n[i];e.forEach(o=>{let u=yi(o,i);(!u||"value"in u&&u.value===void 0)&&(o===t.Transaction.prototype||o instanceof t.Transaction?Ue(o,i,{get(){return this.table(i)},set(l){oo(this,i,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):o[i]=new t.Table(i,s))})})}function Qi({_novip:t},e){e.forEach(r=>{for(let n in r)r[n]instanceof t.Table&&delete r[n]})}function Sf(t,e){return t._cfg.version-e._cfg.version}function Ff(t,e,r,n){let i=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,i);s.create(r),s._completion.catch(n);let o=s._reject.bind(s),u=M.transless||M;ot(()=>{M.trans=s,M.transless=u,e===0?(ae(i).forEach(l=>{Yi(r,l,i[l].primKey,i[l].indexes)}),Gi(t,r),O.follow(()=>t.on.populate.fire(s)).catch(o)):Cf(t,e,s,r).catch(o)})}function Cf({_novip:t},e,r,n){let i=[],s=t._versions,o=t._dbSchema=Xi(t,t.idbdb,n),u=!1;s.filter(c=>c._cfg.version>=e).forEach(c=>{i.push(()=>{let d=o,f=c._cfg.dbschema;Zi(t,d,n),Zi(t,f,n),o=t._dbSchema=f;let p=Uo(d,f);p.add.forEach(w=>{Yi(n,w[0],w[1].primKey,w[1].indexes)}),p.change.forEach(w=>{if(w.recreate)throw new R.Upgrade("Not yet support for changing primary key");{let x=n.objectStore(w.name);w.add.forEach(h=>Ji(x,h)),w.change.forEach(h=>{x.deleteIndex(h.name),Ji(x,h)}),w.del.forEach(h=>x.deleteIndex(h))}});let b=c._cfg.contentUpgrade;if(b&&c._cfg.version>e){Gi(t,n),r._memoizedTables={},u=!0;let w=co(f);p.del.forEach(m=>{w[m]=d[m]}),Qi(t,[t.Transaction.prototype]),Tn(t,[t.Transaction.prototype],ae(w),w),r.schema=w;let x=xi(b);x&&Xt();let h,y=O.follow(()=>{if(h=b(r),h&&x){var m=Qe.bind(null,null);h.then(m,m)}});return h&&typeof h.then=="function"?O.resolve(h):y.then(()=>h)}}),i.push(d=>{if(!u||!sf){let f=c._cfg.dbschema;Tf(f,d)}Qi(t,[t.Transaction.prototype]),Tn(t,[t.Transaction.prototype],t._storeNames,t._dbSchema),r.schema=t._dbSchema})});function a(){return i.length?O.resolve(i.shift()(r.idbtrans)).then(a):O.resolve()}return a().then(()=>{Ef(o,n)})}function Uo(t,e){let r={del:[],add:[],change:[]},n;for(n in t)e[n]||r.del.push(n);for(n in e){let i=t[n],s=e[n];if(!i)r.add.push([n,s]);else{let o={name:n,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||i.primKey.auto!==s.primKey.auto&&!jn)o.recreate=!0,r.change.push(o);else{let u=i.idxByName,l=s.idxByName,a;for(a in u)l[a]||o.del.push(a);for(a in l){let c=u[a],d=l[a];c?c.src!==d.src&&o.change.push(d):o.add.push(d)}(o.del.length>0||o.add.length>0||o.change.length>0)&&r.change.push(o)}}}return r}function Yi(t,e,r,n){let i=t.db.createObjectStore(e,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(s=>Ji(i,s)),i}function Ef(t,e){ae(t).forEach(r=>{e.db.objectStoreNames.contains(r)||Yi(e,r,t[r].primKey,t[r].indexes)})}function Tf(t,e){[].slice.call(e.db.objectStoreNames).forEach(r=>t[r]==null&&e.db.deleteObjectStore(r))}function Ji(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function Xi(t,e,r){let n={};return ln(e.objectStoreNames,0).forEach(s=>{let o=r.objectStore(s),u=o.keyPath,l=Ui(Ho(u),u||"",!1,!1,!!o.autoIncrement,u&&typeof u!="string",!0),a=[];for(let d=0;d<o.indexNames.length;++d){let f=o.index(o.indexNames[d]);u=f.keyPath;var c=Ui(f.name,u,!!f.unique,!!f.multiEntry,!1,u&&typeof u!="string",!1);a.push(c)}n[s]=$o(s,l,a)}),n}function Df({_novip:t},e,r){t.verno=e.version/10;let n=t._dbSchema=Xi(t,e,r);t._storeNames=ln(e.objectStoreNames,0),Tn(t,[t._allTables],ae(n),n)}function Of(t,e){let r=Xi(t,t.idbdb,e),n=Uo(r,t._dbSchema);return!(n.add.length||n.change.some(i=>i.add.length||i.change.length))}function Zi({_novip:t},e,r){let n=r.db.objectStoreNames;for(let i=0;i<n.length;++i){let s=n[i],o=r.objectStore(s);t._hasGetAll="getAll"in o;for(let u=0;u<o.indexNames.length;++u){let l=o.indexNames[u],a=o.index(l).keyPath,c=typeof a=="string"?a:"["+ln(a).join("+")+"]";if(e[s]){let d=e[s].idxByName[c];d&&(d.name=l,delete e[s].idxByName[c],e[s].idxByName[l]=d)}}}typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Z.WorkerGlobalScope&&Z instanceof Z.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}function kf(t){return t.split(",").map((e,r)=>{e=e.trim();let n=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Ui(n,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),_e(i),r===0)})}var qo=class{_parseStoresSpec(e,r){ae(e).forEach(n=>{if(e[n]!==null){var i=kf(e[n]),s=i.shift();if(s.multi)throw new R.Schema("Primary key cannot be multi-valued");i.forEach(o=>{if(o.auto)throw new R.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new R.Schema("Index must have a name and cannot be an empty string")}),r[n]=$o(n,s,i)}})}stores(e){let r=this.db;this._cfg.storesSource=this._cfg.storesSource?je(this._cfg.storesSource,e):e;let n=r._versions,i={},s={};return n.forEach(o=>{je(i,o._cfg.storesSource),s=o._cfg.dbschema={},o._parseStoresSpec(i,s)}),r._dbSchema=s,Qi(r,[r._allTables,r,r.Transaction.prototype]),Tn(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],ae(s),s),r._storeNames=ae(s),this}upgrade(e){return this._cfg.contentUpgrade=Si(this._cfg.contentUpgrade||X,e),this}};function If(t){return Vr(qo.prototype,function(r){this.db=t,this._cfg={version:r,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function es(t,e){let r=t._dbNamesDB;return r||(r=t._dbNamesDB=new Xe(An,{addons:[],indexedDB:t,IDBKeyRange:e}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function ts(t){return t&&typeof t.databases=="function"}function Mf({indexedDB:t,IDBKeyRange:e}){return ts(t)?Promise.resolve(t.databases()).then(r=>r.map(n=>n.name).filter(n=>n!==An)):es(t,e).toCollection().primaryKeys()}function Pf({indexedDB:t,IDBKeyRange:e},r){!ts(t)&&r!==An&&es(t,e).put({name:r}).catch(X)}function Rf({indexedDB:t,IDBKeyRange:e},r){!ts(t)&&r!==An&&es(t,e).delete(r).catch(X)}function rs(t){return ot(function(){return M.letThrough=!0,t()})}function Bf(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(r){var n=function(){return indexedDB.databases().finally(r)};e=setInterval(n,100),n()}).finally(function(){return clearInterval(e)})}function Lf(t){let e=t._state,{indexedDB:r}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?le(e.dbOpenError):t);Ve&&(e.openCanceller._stackHolder=Ct()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;let n=e.openCanceller;function i(){if(e.openCanceller!==n)throw new R.DatabaseClosed("db.open() was cancelled")}let s=e.dbReadyResolve,o=null,u=!1;return O.race([n,(typeof navigator=="undefined"?O.resolve():Bf()).then(()=>new O((l,a)=>{if(i(),!r)throw new R.MissingAPI;let c=t.name,d=e.autoSchema?r.open(c):r.open(c,Math.round(t.verno*10));if(!d)throw new R.MissingAPI;d.onerror=He(a),d.onblocked=te(t._fireOnBlocked),d.onupgradeneeded=te(f=>{if(o=d.transaction,e.autoSchema&&!t._options.allowEmptyDB){d.onerror=Hr,o.abort(),d.result.close();let b=r.deleteDatabase(c);b.onsuccess=b.onerror=te(()=>{a(new R.NoSuchDatabase(`Database ${c} doesnt exist`))})}else{o.onerror=He(a);var p=f.oldVersion>Math.pow(2,62)?0:f.oldVersion;u=p<1,t._novip.idbdb=d.result,Ff(t,p/10,o,a)}},a),d.onsuccess=te(()=>{o=null;let f=t._novip.idbdb=d.result,p=ln(f.objectStoreNames);if(p.length>0)try{let b=f.transaction(_f(p),"readonly");e.autoSchema?Df(t,f,b):(Zi(t,t._dbSchema,b),Of(t,b)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Gi(t,b)}catch{}Kr.push(t),f.onversionchange=te(b=>{e.vcFired=!0,t.on("versionchange").fire(b)}),f.onclose=te(b=>{t.on("close").fire(b)}),u&&Pf(t._deps,c),l()},a)}))]).then(()=>(i(),e.onReadyBeingFired=[],O.resolve(rs(()=>t.on.ready.fire(t.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let a=e.onReadyBeingFired.reduce(Si,X);return e.onReadyBeingFired=[],O.resolve(rs(()=>a(t.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(l=>{e.dbOpenError=l;try{o&&o.abort()}catch{}return n===e.openCanceller&&t._close(),le(l)}).finally(()=>{e.openComplete=!0,s()})}function ns(t){var e=o=>t.next(o),r=o=>t.throw(o),n=s(e),i=s(r);function s(o){return u=>{var l=o(u),a=l.value;return l.done?a:!a||typeof a.then!="function"?_e(a)?Promise.all(a).then(n,i):n(a):a.then(n,i)}}return s(e)()}function Nf(t,e,r){var n=arguments.length;if(n<2)throw new R.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];r=i.pop();var s=fo(i);return[t,s,r]}function Go(t,e,r,n,i){return O.resolve().then(()=>{let s=M.transless||M,o=t._createTransaction(e,r,t._dbSchema,n),u={trans:o,transless:s};if(n)o.idbtrans=n.idbtrans;else try{o.create(),t._state.PR1398_maxLoop=3}catch(d){return d.name===Ai.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Go(t,e,r,null,i))):le(d)}let l=xi(i);l&&Xt();let a,c=O.follow(()=>{if(a=i.call(o,o),a)if(l){var d=Qe.bind(null,null);a.then(d,d)}else typeof a.next=="function"&&typeof a.throw=="function"&&(a=ns(a))},u);return(a&&typeof a.then=="function"?O.resolve(a).then(d=>o.active?d:le(new R.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>a)).then(d=>(n&&o._resolve(),o._completion.then(()=>d))).catch(d=>(o._reject(d),le(d)))})}function Dn(t,e,r){let n=_e(t)?t.slice():[t];for(let i=0;i<r;++i)n.push(e);return n}function Kf(t){return xe(ne({},t),{table(e){let r=t.table(e),{schema:n}=r,i={},s=[];function o(f,p,b){let w=Ur(f),x=i[w]=i[w]||[],h=f==null?0:typeof f=="string"?1:f.length,y=p>0,m=xe(ne({},b),{isVirtual:y,keyTail:p,keyLength:h,extractKey:qi(f),unique:!y&&b.unique});if(x.push(m),m.isPrimaryKey||s.push(m),h>1){let g=h===2?f[0]:f.slice(0,h-1);o(g,p+1,b)}return x.sort((g,v)=>g.keyTail-v.keyTail),m}let u=o(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[u];for(let f of n.indexes)o(f.keyPath,0,f);function l(f){let p=i[Ur(f)];return p&&p[0]}function a(f,p){return{type:f.type===1?2:f.type,lower:Dn(f.lower,f.lowerOpen?t.MAX_KEY:t.MIN_KEY,p),lowerOpen:!0,upper:Dn(f.upper,f.upperOpen?t.MIN_KEY:t.MAX_KEY,p),upperOpen:!0}}function c(f){let p=f.query.index;return p.isVirtual?xe(ne({},f),{query:{index:p,range:a(f.query.range,p.keyTail)}}):f}return xe(ne({},r),{schema:xe(ne({},n),{primaryKey:u,indexes:s,getIndexByKeyPath:l}),count(f){return r.count(c(f))},query(f){return r.query(c(f))},openCursor(f){let{keyTail:p,isVirtual:b,keyLength:w}=f.query.index;if(!b)return r.openCursor(f);function x(h){function y(g){g!=null?h.continue(Dn(g,f.reverse?t.MAX_KEY:t.MIN_KEY,p)):f.unique?h.continue(h.key.slice(0,w).concat(f.reverse?t.MIN_KEY:t.MAX_KEY,p)):h.continue()}return Object.create(h,{continue:{value:y},continuePrimaryKey:{value(g,v){h.continuePrimaryKey(Dn(g,t.MAX_KEY,p),v)}},primaryKey:{get(){return h.primaryKey}},key:{get(){let g=h.key;return w===1?g[0]:g.slice(0,w)}},value:{get(){return h.value}}})}return r.openCursor(c(f)).then(h=>h&&x(h))}})}})}var zf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Kf};function is(t,e,r,n){return r=r||{},n=n||"",ae(t).forEach(i=>{if(!De(e,i))r[n+i]=void 0;else{var s=t[i],o=e[i];if(typeof s=="object"&&typeof o=="object"&&s&&o){let u=_i(s),l=_i(o);u!==l?r[n+i]=e[i]:u==="Object"?is(s,o,r,n+i+"."):s!==o&&(r[n+i]=e[i])}else s!==o&&(r[n+i]=e[i])}}),ae(e).forEach(i=>{De(t,i)||(r[n+i]=e[i])}),r}function Vf(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var Hf={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>xe(ne({},t),{table(e){let r=t.table(e),{primaryKey:n}=r.schema;return xe(ne({},r),{mutate(s){let o=M.trans,{deleting:u,creating:l,updating:a}=o.table(e).hook;switch(s.type){case"add":if(l.fire===X)break;return o._promise("readwrite",()=>c(s),!0);case"put":if(l.fire===X&&a.fire===X)break;return o._promise("readwrite",()=>c(s),!0);case"delete":if(u.fire===X)break;return o._promise("readwrite",()=>c(s),!0);case"deleteRange":if(u.fire===X)break;return o._promise("readwrite",()=>d(s),!0)}return r.mutate(s);function c(p){let b=M.trans,w=p.keys||Vf(n,p);if(!w)throw new Error("Keys missing");return p=p.type==="add"||p.type==="put"?xe(ne({},p),{keys:w}):ne({},p),p.type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),$f(r,p,w).then(x=>{let h=w.map((y,m)=>{let g=x[m],v={onerror:null,onsuccess:null};if(p.type==="delete")u.fire.call(v,y,g,b);else if(p.type==="add"||g===void 0){let _=l.fire.call(v,y,p.values[m],b);y==null&&_!=null&&(y=_,p.keys[m]=y,n.outbound||Re(p.values[m],n.keyPath,y))}else{let _=is(g,p.values[m]),j=a.fire.call(v,_,y,g,b);if(j){let A=p.values[m];Object.keys(j).forEach(S=>{De(A,S)?A[S]=j[S]:Re(A,S,j[S])})}}return v});return r.mutate(p).then(({failures:y,results:m,numFailures:g,lastResult:v})=>{for(let _=0;_<w.length;++_){let j=m?m[_]:w[_],A=h[_];j==null?A.onerror&&A.onerror(y[_]):A.onsuccess&&A.onsuccess(p.type==="put"&&x[_]?p.values[_]:j)}return{failures:y,results:m,numFailures:g,lastResult:v}}).catch(y=>(h.forEach(m=>m.onerror&&m.onerror(y)),Promise.reject(y)))})}function d(p){return f(p.trans,p.range,1e4)}function f(p,b,w){return r.query({trans:p,values:!1,query:{index:n,range:b},limit:w}).then(({result:x})=>c({type:"delete",keys:x,trans:p}).then(h=>h.numFailures>0?Promise.reject(h.failures[0]):x.length<w?{failures:[],numFailures:0,lastResult:void 0}:f(p,xe(ne({},b),{lower:x[x.length-1],lowerOpen:!0}),w)))}}})}})};function $f(t,e,r){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:r,cache:"immutable"})}function Qo(t,e,r){try{if(!e||e.keys.length<t.length)return null;let n=[];for(let i=0,s=0;i<e.keys.length&&s<t.length;++i)Ae(e.keys[i],t[s])===0&&(n.push(r?kr(e.values[i]):e.values[i]),++s);return n.length===t.length?n:null}catch{return null}}var Wf={stack:"dbcore",level:-1,create:t=>({table:e=>{let r=t.table(e);return xe(ne({},r),{getMany:n=>{if(!n.cache)return r.getMany(n);let i=Qo(n.keys,n.trans._cache,n.cache==="clone");return i?O.resolve(i):r.getMany(n).then(s=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?kr(s):s},s))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))})}})};function ss(t){return!("from"in t)}var Je=function(t,e){if(this)je(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{let r=new Je;return t&&"d"in t&&je(r,t),r}};qt(Je.prototype,{add(t){return On(this,t),this},addKey(t){return qr(this,t,t),this},addKeys(t){return t.forEach(e=>qr(this,e,e)),this},[bi](){return os(this)}});function qr(t,e,r){let n=Ae(e,r);if(isNaN(n))return;if(n>0)throw RangeError();if(ss(t))return je(t,{from:e,to:r,d:1});let i=t.l,s=t.r;if(Ae(r,t.from)<0)return i?qr(i,e,r):t.l={from:e,to:r,d:1,l:null,r:null},Yo(t);if(Ae(e,t.to)>0)return s?qr(s,e,r):t.r={from:e,to:r,d:1,l:null,r:null},Yo(t);Ae(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),Ae(r,t.to)>0&&(t.to=r,t.r=null,t.d=t.l?t.l.d+1:1);let o=!t.r;i&&!t.l&&On(t,i),s&&o&&On(t,s)}function On(t,e){function r(n,{from:i,to:s,l:o,r:u}){qr(n,i,s),o&&r(n,o),u&&r(n,u)}ss(e)||r(t,e)}function Uf(t,e){let r=os(e),n=r.next();if(n.done)return!1;let i=n.value,s=os(t),o=s.next(i.from),u=o.value;for(;!n.done&&!o.done;){if(Ae(u.from,i.to)<=0&&Ae(u.to,i.from)>=0)return!0;Ae(i.from,u.from)<0?i=(n=r.next(u.from)).value:u=(o=s.next(i.from)).value}return!1}function os(t){let e=ss(t)?null:{s:0,n:t};return{next(r){let n=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,n)for(;e.n.l&&Ae(r,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!n||Ae(r,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Yo(t){var e,r;let n=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((r=t.l)===null||r===void 0?void 0:r.d)||0),i=n>1?"r":n<-1?"l":"";if(i){let s=i==="r"?"l":"r",o=ne({},t),u=t[i];t.from=u.from,t.to=u.to,t[i]=u[i],o[i]=u[s],t[s]=o,o.d=Jo(o)}t.d=Jo(t)}function Jo({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}var qf={stack:"dbcore",level:0,create:t=>{let e=t.schema.name,r=new Je(t.MIN_KEY,t.MAX_KEY);return xe(ne({},t),{table:n=>{let i=t.table(n),{schema:s}=i,{primaryKey:o}=s,{extractKey:u,outbound:l}=o,a=xe(ne({},i),{mutate:f=>{let p=f.trans,b=p.mutatedParts||(p.mutatedParts={}),w=_=>{let j=`idb://${e}/${n}/${_}`;return b[j]||(b[j]=new Je)},x=w(""),h=w(":dels"),{type:y}=f,[m,g]=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[[],f.values]:[],v=f.trans._cache;return i.mutate(f).then(_=>{if(_e(m)){y!=="delete"&&(m=_.results),x.addKeys(m);let j=Qo(m,v);!j&&y!=="add"&&h.addKeys(m),(j||g)&&Gf(w,s,j,g)}else if(m){let j={from:m.lower,to:m.upper};h.add(j),x.add(j)}else x.add(r),h.add(r),s.indexes.forEach(j=>w(j.name).add(r));return _})}}),c=({query:{index:f,range:p}})=>{var b,w;return[f,new Je((b=p.lower)!==null&&b!==void 0?b:t.MIN_KEY,(w=p.upper)!==null&&w!==void 0?w:t.MAX_KEY)]},d={get:f=>[o,new Je(f.key)],getMany:f=>[o,new Je().addKeys(f.keys)],count:c,query:c,openCursor:c};return ae(d).forEach(f=>{a[f]=function(p){let{subscr:b}=M;if(b){let w=g=>{let v=`idb://${e}/${n}/${g}`;return b[v]||(b[v]=new Je)},x=w(""),h=w(":dels"),[y,m]=d[f](p);if(w(y.name||"").add(m),!y.isPrimaryKey)if(f==="count")h.add(r);else{let g=f==="query"&&l&&p.values&&i.query(xe(ne({},p),{values:!1}));return i[f].apply(this,arguments).then(v=>{if(f==="query"){if(l&&p.values)return g.then(({result:j})=>(x.addKeys(j),v));let _=p.values?v.result.map(u):v.result;p.values?x.addKeys(_):h.addKeys(_)}else if(f==="openCursor"){let _=v,j=p.values;return _&&Object.create(_,{key:{get(){return h.addKey(_.primaryKey),_.key}},primaryKey:{get(){let A=_.primaryKey;return h.addKey(A),A}},value:{get(){return j&&x.addKey(_.primaryKey),_.value}}})}return v})}}return i[f].apply(this,arguments)}}),a}})}};function Gf(t,e,r,n){function i(s){let o=t(s.name||"");function u(a){return a!=null?s.extractKey(a):null}let l=a=>s.multiEntry&&_e(a)?a.forEach(c=>o.addKey(c)):o.addKey(a);(r||n).forEach((a,c)=>{let d=r&&u(r[c]),f=n&&u(n[c]);Ae(d,f)!==0&&(d!=null&&l(d),f!=null&&l(f))})}e.indexes.forEach(i)}var Xe=class{constructor(e,r){this._middlewares={},this.verno=0;let n=Xe.dependencies;this._options=r=ne({addons:Xe.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};let{addons:i}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;let s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:X,dbReadyPromise:null,cancelOpen:X,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};s.dbReadyPromise=new O(o=>{s.dbReadyResolve=o}),s.openCanceller=new O((o,u)=>{s.cancelOpen=u}),this._state=s,this.name=e,this.on=zr(this,"populate","blocked","versionchange","close",{ready:[Si,X]}),this.on.ready.subscribe=ao(this.on.ready.subscribe,o=>(u,l)=>{Xe.vip(()=>{let a=this._state;if(a.openComplete)a.dbOpenError||O.resolve().then(u),l&&o(u);else if(a.onReadyBeingFired)a.onReadyBeingFired.push(u),l&&o(u);else{o(u);let c=this;l||o(function d(){c.on.ready.unsubscribe(u),c.on.ready.unsubscribe(d)})}})}),this.Collection=ff(this),this.Table=af(this),this.Transaction=vf(this),this.Version=If(this),this.WhereClause=yf(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=Wr(r.IDBKeyRange),this._createTransaction=(o,u,l,a)=>new this.Transaction(o,u,l,this._options.chromeTransactionDurability,a),this._fireOnBlocked=o=>{this.on("blocked").fire(o),Kr.filter(u=>u.name===this.name&&u!==this&&!u._state.vcFired).map(u=>u.on("versionchange").fire(o))},this.use(zf),this.use(Hf),this.use(qf),this.use(Wf),this.vip=Object.create(this,{_vip:{value:!0}}),i.forEach(o=>o(this))}version(e){if(isNaN(e)||e<.1)throw new R.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new R.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);let r=this._versions;var n=r.filter(i=>i._cfg.version===e)[0];return n||(n=new this.Version(e),r.push(n),r.sort(Sf),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(e){return this.idbdb&&(this._state.openComplete||M.letThrough||this._vip)?e():new O((r,n)=>{if(this._state.openComplete)return n(new R.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen){n(new R.DatabaseClosed);return}this.open().catch(X)}this._state.dbReadyPromise.then(r,n)}).then(e)}use({stack:e,create:r,level:n,name:i}){i&&this.unuse({stack:e,name:i});let s=this._middlewares[e]||(this._middlewares[e]=[]);return s.push({stack:e,create:r,level:n??10,name:i}),s.sort((o,u)=>o.level-u.level),this}unuse({stack:e,name:r,create:n}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(i=>n?i.create!==n:r?i.name!==r:!1)),this}open(){return Lf(this)}_close(){let e=this._state,r=Kr.indexOf(this);if(r>=0&&Kr.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new O(n=>{e.dbReadyResolve=n}),e.openCanceller=new O((n,i)=>{e.cancelOpen=i})}close(){this._close();let e=this._state;this._options.autoOpen=!1,e.dbOpenError=new R.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){let e=arguments.length>0,r=this._state;return new O((n,i)=>{let s=()=>{this.close();var o=this._deps.indexedDB.deleteDatabase(this.name);o.onsuccess=te(()=>{Rf(this._deps,this.name),n()}),o.onerror=He(i),o.onblocked=this._fireOnBlocked};if(e)throw new R.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){let e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return ae(this._allTables).map(e=>this._allTables[e])}transaction(){let e=Nf.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,r,n){let i=M.trans;(!i||i.db!==this||e.indexOf("!")!==-1)&&(i=null);let s=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");let o,u;try{if(u=r.map(a=>{var c=a instanceof this.Table?a.name:a;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),e=="r"||e===Ki)o=Ki;else if(e=="rw"||e==zi)o=zi;else throw new R.InvalidArgument("Invalid transaction mode: "+e);if(i){if(i.mode===Ki&&o===zi)if(s)i=null;else throw new R.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i&&u.forEach(a=>{if(i&&i.storeNames.indexOf(a)===-1)if(s)i=null;else throw new R.SubTransaction("Table "+a+" not included in parent transaction.")}),s&&i&&!i.active&&(i=null)}}catch(a){return i?i._promise(null,(c,d)=>{d(a)}):le(a)}let l=Go.bind(null,this,o,u,i,n);return i?i._promise(o,l,"lock"):M.trans?Zt(M.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!De(this._allTables,e))throw new R.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}},Qf=typeof Symbol!="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable",Xo=class{constructor(e){this._subscribe=e}subscribe(e,r,n){return this._subscribe(!e||typeof e=="function"?{next:e,error:r,complete:n}:e)}[Qf](){return this}};function Zo(t,e){return ae(e).forEach(r=>{let n=t[r]||(t[r]=new Je);On(n,e[r])}),t}function Yf(t){return new Xo(e=>{let r=xi(t);function n(p){r&&Xt();let b=()=>ot(t,{subscr:p,trans:null}),w=M.trans?Zt(M.transless,b):b();return r&&w.then(Qe,Qe),w}let i=!1,s={},o={},u={get closed(){return i},unsubscribe:()=>{i=!0,ct.storagemutated.unsubscribe(d)}};e.start&&e.start(u);let l=!1,a=!1;function c(){return ae(o).some(p=>s[p]&&Uf(s[p],o[p]))}let d=p=>{Zo(s,p),c()&&f()},f=()=>{if(l||i)return;s={};let p={},b=n(p);a||(ct($r,d),a=!0),l=!0,Promise.resolve(b).then(w=>{l=!1,!i&&(c()?f():(s={},o=p,e.next&&e.next(w)))},w=>{l=!1,e.error&&e.error(w),u.unsubscribe()})};return f(),u})}var as;try{as={indexedDB:Z.indexedDB||Z.mozIndexedDB||Z.webkitIndexedDB||Z.msIndexedDB,IDBKeyRange:Z.IDBKeyRange||Z.webkitIDBKeyRange}}catch{as={indexedDB:null,IDBKeyRange:null}}var It=Xe;qt(It,xe(ne({},fn),{delete(t){return new It(t,{addons:[]}).delete()},exists(t){return new It(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1)},getDatabaseNames(t){try{return Mf(It.dependencies).then(t)}catch{return le(new R.MissingAPI)}},defineClass(){function t(e){je(this,e)}return t},ignoreTransaction(t){return M.trans?Zt(M.transless,t):t()},vip:rs,async:function(t){return function(){try{var e=ns(t.apply(this,arguments));return!e||typeof e.then!="function"?O.resolve(e):e}catch(r){return le(r)}}},spawn:function(t,e,r){try{var n=ns(t.apply(r,e||[]));return!n||typeof n.then!="function"?O.resolve(n):n}catch(i){return le(i)}},currentTransaction:{get:()=>M.trans||null},waitFor:function(t,e){let r=O.resolve(typeof t=="function"?It.ignoreTransaction(t):t).timeout(e||6e4);return M.trans?M.trans.waitFor(r):r},Promise:O,debug:{get:()=>Ve,set:t=>{po(t,t==="dexie"?()=>!0:Io)}},derive:Gt,extend:je,props:qt,override:ao,Events:zr,on:ct,liveQuery:Yf,extendObservabilitySet:Zo,getByKeyPath:qe,setByKeyPath:Re,delByKeyPath:kc,shallowClone:co,deepClone:kr,getObjectDiff:is,cmp:Ae,asap:uo,minKey:Ni,addons:[],connections:Kr,errnames:Ai,dependencies:as,semVer:Oo,version:Oo.split(".").map(t=>parseInt(t)).reduce((t,e,r)=>t+e/Math.pow(10,r*2))}));It.maxKey=Wr(It.dependencies.IDBKeyRange);typeof dispatchEvent!="undefined"&&typeof addEventListener!="undefined"&&(ct($r,t=>{if(!Ze){let e;jn?(e=document.createEvent("CustomEvent"),e.initCustomEvent(lt,!0,!0,t)):e=new CustomEvent(lt,{detail:t}),Ze=!0,dispatchEvent(e),Ze=!1}}),addEventListener(lt,({detail:t})=>{Ze||kn(t)}));function kn(t){let e=Ze;try{Ze=!0,ct.storagemutated.fire(t)}finally{Ze=e}}var Ze=!1;if(typeof BroadcastChannel!="undefined"){let t=new BroadcastChannel(lt);ct($r,e=>{Ze||t.postMessage(e)}),t.onmessage=e=>{e.data&&kn(e.data)}}else if(typeof self!="undefined"&&typeof navigator!="undefined"){ct($r,e=>{try{Ze||(typeof localStorage!="undefined"&&localStorage.setItem(lt,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:lt,changedParts:e})))}catch{}}),typeof addEventListener!="undefined"&&addEventListener("storage",e=>{if(e.key===lt){let r=JSON.parse(e.newValue);r&&kn(r.changedParts)}});let t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",Jf)}function Jf({data:t}){t&&t.type===lt&&kn(t.changedParts)}O.rejectionMapper=zc;po(Ve,Io);var $e=class extends Xe{constructor(){super($e.dbName);this.version($e.dbVersion).stores({searchHistory:"++id",minisearch:"date"})}static async clearOldDatabases(){let e=(await indexedDB.databases()).filter(r=>r.name===$e.dbName&&r.version!==$e.dbVersion*10);if(e.length){console.log("Omnisearch - Those IndexedDb databases will be deleted:");for(let r of e)r.name&&indexedDB.deleteDatabase(r.name)}}static getInstance(){return $e.instance||($e.instance=new $e),$e.instance}async clearCache(){await this.minisearch.clear()}},rr=$e;rr.dbVersion=8,rr.dbName="omnisearch/cache/"+app.appId;var ke=rr.getInstance();var Mt=un(!1),us=class extends Q.PluginSettingTab{constructor(e){super(app,e);this.plugin=e,Mt.subscribe(async r=>{D.showExcerpt=r,await de(this.plugin)})}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Omnisearch"});let r=e.createDiv();r.innerHTML=`
        <iframe src="https://github.com/sponsors/scambier/button" title="Sponsor scambier" height="35" width="116" style="border: 0;"></iframe>
        <a href='https://ko-fi.com/B0B6LQ2C' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://cdn.ko-fi.com/cdn/kofi2.png?v=3' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a> 
    `,new Q.Setting(e).setName("Indexing").setHeading();let n=new DocumentFragment;We()?n.createSpan({},a=>{a.innerHTML=`\u{1F44D} You have installed <a href="https://github.com/scambier/obsidian-text-extractor">Text Extractor</a>, Omnisearch will use it to index PDFs and images.
            <br />Text extraction only works on desktop, but the cache can be synchronized with your mobile device.`}):n.createSpan({},a=>{a.innerHTML='\u26A0\uFE0F Omnisearch requires <a href="https://github.com/scambier/obsidian-text-extractor">Text Extractor</a> to index PDFs and images.'}),new Q.Setting(e).setDesc(n);let i=new DocumentFragment;i.createSpan({},a=>{a.innerHTML="Include PDFs in search results"}),new Q.Setting(e).setName(`PDFs Indexing ${We()?"":"\u26A0\uFE0F Disabled"}`).setDesc(i).addToggle(a=>a.setValue(D.PDFIndexing).onChange(async c=>{D.PDFIndexing=c,await de(this.plugin)})).setDisabled(!We());let s=new DocumentFragment;s.createSpan({},a=>{a.innerHTML="Include images in search results"}),new Q.Setting(e).setName(`Images Indexing ${We()?"":"\u26A0\uFE0F Disabled"}`).setDesc(s).addToggle(a=>a.setValue(D.imagesIndexing).onChange(async c=>{D.imagesIndexing=c,await de(this.plugin)})).setDisabled(!We());let o=new DocumentFragment;o.createSpan({},a=>{a.innerHTML=`In addition to standard <code>md</code> files, Omnisearch can also index other <strong style="color: var(--text-accent)">plaintext</strong> files.<br/>
      Add extensions separated by a space, without the dot. Example: "<code>txt org</code>".<br />
      \u26A0\uFE0F <span style="color: var(--text-accent)">Using extensions of non-plaintext files (like .docx or .pptx) WILL cause crashes,
      because Omnisearch will try to index their content.</span><br />
      <strong style="color: var(--text-accent)">Needs a restart to fully take effect.</strong>`}),new Q.Setting(e).setName("Additional files to index").setDesc(o).addText(a=>{a.setValue(D.indexedFileTypes.join(" ")).setPlaceholder("Example: txt org").onChange(async c=>{D.indexedFileTypes=c.split(" "),await de(this.plugin)})}),new Q.Setting(e).setName("Behavior").setHeading(),new Q.Setting(e).setName("Save index to cache").setDesc("Enable caching to speed up indexing time. In rare cases, the cache write may cause a freeze in Obsidian. This option will disable itself if it happens.").addToggle(a=>a.setValue(D.useCache).onChange(async c=>{D.useCache=c,await de(this.plugin)})),new Q.Setting(e).setName(`Respect Obsidian's "Excluded Files"`).setDesc(`By default, files that are in Obsidian's "Options > Files & Links > Excluded Files" list are downranked in results.
        Enable this option to completely hide them`).addToggle(a=>a.setValue(D.hideExcluded).onChange(async c=>{D.hideExcluded=c,await de(this.plugin)}));let u=new DocumentFragment;u.createSpan({},a=>{a.innerHTML=`Normalize diacritics in search terms. Words like "br\xFBl\xE9e" or "\u017Elu\u0165ou\u010Dk\xFD" will be indexed as "brulee" and "zlutoucky".<br/>
        \u26A0\uFE0F <span style="color: var(--text-accent)">You probably should <strong>NOT</strong> disable this.</span><br>
        \u26A0\uFE0F <span style="color: var(--text-accent)">Changing this setting will clear the cache.</span><br>
        <strong style="color: var(--text-accent)">Needs a restart to fully take effect.</strong>
        `}),new Q.Setting(e).setName("Ignore diacritics").setDesc(u).addToggle(a=>a.setValue(D.ignoreDiacritics).onChange(async c=>{await ke.clearCache(),D.ignoreDiacritics=c,await de(this.plugin)})),new Q.Setting(e).setName("Simpler search").setDesc("Enable this if Obsidian often freezes while making searches. This may return fewer results.").addToggle(a=>a.setValue(D.simpleSearch).onChange(async c=>{D.simpleSearch=c,await de(this.plugin)})),new Q.Setting(e).setName("User Interface").setHeading(),new Q.Setting(e).setName("Show ribbon button").setDesc("Add a button on the sidebar to open the Vault search modal.").addToggle(a=>a.setValue(D.ribbonIcon).onChange(async c=>{D.ribbonIcon=c,await de(this.plugin),c?this.plugin.addRibbonButton():this.plugin.removeRibbonButton()})),new Q.Setting(e).setName("Show excerpts").setDesc("Shows the contextual part of the note that matches the search. Disable this to only show filenames in results.").addToggle(a=>a.setValue(D.showExcerpt).onChange(async c=>{Mt.set(c)})),new Q.Setting(e).setName("Render line return in excerpts").setDesc("Activate this option to render line returns in result excerpts.").addToggle(a=>a.setValue(D.renderLineReturnInExcerpts).onChange(async c=>{D.renderLineReturnInExcerpts=c,await de(this.plugin)})),new Q.Setting(e).setName("Show previous query results").setDesc("Re-executes the previous query when opening Omnisearch.").addToggle(a=>a.setValue(D.showPreviousQueryResults).onChange(async c=>{D.showPreviousQueryResults=c,await de(this.plugin)}));let l=new DocumentFragment;if(l.createSpan({},a=>{a.innerHTML=`Shows a button next to the search input, to create a note.
        Acts the same as the <code>shift \u21B5</code> shortcut, can be useful for mobile device users.`}),new Q.Setting(e).setName('Show "Create note" button').setDesc(l).addToggle(a=>a.setValue(D.showCreateButton).onChange(async c=>{D.showCreateButton=c,await de(this.plugin)})),new Q.Setting(e).setName("Hide full path in results list").setDesc("In the search results, only show the note name, without the full path.").addToggle(a=>a.setValue(D.showShortName).onChange(async c=>{D.showShortName=c,await de(this.plugin)})),new Q.Setting(e).setName("Highlight matching words in results").setDesc("Will highlight matching results when enabled. See README for more customization options.").addToggle(a=>a.setValue(D.hightlight).onChange(async c=>{D.hightlight=c,await de(this.plugin)})),new Q.Setting(e).setName("Results weighting").setHeading(),new Q.Setting(e).setName(`File name & declared aliases (default: ${nr.weightBasename})`).addSlider(a=>this.weightSlider(a,"weightBasename")),new Q.Setting(e).setName(`Headings level 1 (default: ${nr.weightH1})`).addSlider(a=>this.weightSlider(a,"weightH1")),new Q.Setting(e).setName(`Headings level 2 (default: ${nr.weightH2})`).addSlider(a=>this.weightSlider(a,"weightH2")),new Q.Setting(e).setName(`Headings level 3 (default: ${nr.weightH3})`).addSlider(a=>this.weightSlider(a,"weightH3")),ft()){new Q.Setting(e).setName("Danger Zone").setHeading();let a=new DocumentFragment;a.createSpan({},c=>{c.innerHTML=`Erase all Omnisearch cache data.
      Use this if Omnisearch results are inconsistent, missing, or appear outdated.<br>
      <strong style="color: var(--text-accent)">Needs a restart to fully take effect.</strong>`}),new Q.Setting(e).setName("Clear cache data").setDesc(a).addButton(c=>{c.setButtonText("Clear cache"),c.onClick(async()=>{await ke.clearCache(),new Q.Notice("Omnisearch - Cache cleared. Please restart Obsidian.")})})}}weightSlider(e,r){e.setLimits(1,5,.1).setValue(D[r]).setDynamicTooltip().onChange(n=>{D[r]=n,de(this.plugin)})}},nr={useCache:!0,hideExcluded:!1,ignoreDiacritics:!0,indexedFileTypes:[],PDFIndexing:!1,imagesIndexing:!1,showShortName:!1,ribbonIcon:!0,showExcerpt:!0,renderLineReturnInExcerpts:!0,showCreateButton:!1,hightlight:!0,showPreviousQueryResults:!0,simpleSearch:!1,weightBasename:2,weightH1:1.5,weightH2:1.3,weightH3:1.1,welcomeMessage:""},D=Object.assign({},nr);async function ea(t){D=Object.assign({},nr,await t.loadData()),Mt.set(D.showExcerpt)}async function de(t){await t.saveData(D)}var ta=Ee(require("obsidian"));var ra=/^"|"$|^'|'$/g,na=/[\u4e00-\u9fa5]/,ia=100,Gr=300,sa=`suggestion-highlight omnisearch-highlight ${D.hightlight?"omnisearch-default-highlight":""}`,V=new gi,In={ToggleExcerpts:"toggle-excerpts"},Ie=(s=>(s[s.Done=0]="Done",s[s.LoadingCache=1]="LoadingCache",s[s.ReadingFiles=2]="ReadingFiles",s[s.IndexingFiles=3]="IndexingFiles",s[s.WritingCache=4]="WritingCache",s))(Ie||{});var dt=un(0),oa=!1;function ls(t){oa=t}function aa(){return oa}function Mn(){return app.plugins.plugins["cm-chs-patch"]}function We(){return app.plugins?.plugins?.["text-extractor"]?.api}function ft(){return!ta.Platform.isIosApp&&D.useCache}var ua=/[|\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;var _a=Ee(require("obsidian"));var et=Ee(require("obsidian"));var ca=Ee(require("crypto")),fa=Ee(la());function ht(t){return`<span class="${sa}">${t}</span>`}function Xf(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function Zf(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function pt(t){if(!t.length)return/^$/g;let e=t.map(n=>(Mn()?"":"\\b")+Zf(n)).join("|");return new RegExp(`(${e})`,"gi")}function Pn(t,e){return t.headings?.filter(r=>r.level===e).map(r=>r.heading)??[]}function Rn(t,e){return(t+e)%e}function ir(t,e){try{let r=e??-1,n=Math.max(0,r-ia),i=Math.min(t.length,r+Gr);if(r>-1?t=(n>0?"\u2026":"")+t.slice(n,i).trim()+(i<t.length-1?"\u2026":""):t=t.slice(0,Gr),D.renderLineReturnInExcerpts){let s=new RegExp(/(?:\r\n|\r|\n)/g);t=t.split(s).filter(u=>u).join(`
`);let o=t.lastIndexOf(`
`,r-n);o>0&&(t=t.slice(o))}return t=Xf(t),D.renderLineReturnInExcerpts&&(t=t.trim().replaceAll(`
`,"<br>")),t}catch(r){return new et.Notice("Omnisearch - Error while creating excerpt, see developer console"),console.error("Omnisearch - Error while creating excerpt"),console.error(r),""}}function da(t){return t.replace(ra,"")}function fs(t){return t.replace(/(\*|_)+(.+?)(\*|_)+/g,(e,r,n)=>n)}function ha(t){return t?.frontmatter?(0,et.parseFrontMatterAliases)(t.frontmatter)??[]:[]}function pa(t){let e=t?(0,et.getAllTags)(t)??[]:[];return e=[...new Set(e.reduce((r,n)=>[...r,...n.split("/").filter(i=>i).map(i=>i.startsWith("#")?i:`#${i}`),n],[]))],e}function Pt(t){return t==null?"":(t=t.replaceAll("`","[__omnisearch__backtick__]"),t=t.normalize("NFD").replace(/\p{Diacritic}/gu,""),t=t.replaceAll("[__omnisearch__backtick__]","`"),t)}function ma(){return et.Platform.isMacOS?"\u2318":"ctrl"}function Yr(t){let e=!!We(),r=e&&D.PDFIndexing,n=e&&D.imagesIndexing;return ps(t)||ms(t)||r&&hs(t)||n&&ds(t)}function ds(t){return t.endsWith(".png")||t.endsWith(".jpg")||t.endsWith(".jpeg")}function hs(t){return t.endsWith(".pdf")}function ps(t){return[...D.indexedFileTypes,"md"].some(e=>t.endsWith(`.${e}`))}function ms(t){return t.endsWith(".canvas")}function ga(t){let e=t.split(".");return e[e.length-1]??""}function ya(t){return et.Platform.isMobileApp?(0,fa.md5)(t.toString()):(0,ca.createHash)("md5").update(t).digest("hex")}function va(t,e){let r=[],n=0,i=t.length;for(;n<i;)r.push(t.slice(n,n+=e));return r}async function ed(t){let e=app.vault.getFiles().find(s=>s.path===t);if(!e)throw new Error(`Invalid file path: "${t}"`);let r=null,n=We();if(ps(t))r=await app.vault.cachedRead(e);else if(ms(t)){let s=JSON.parse(await app.vault.cachedRead(e)),o=[];for(let u of s.nodes)u.type==="text"?o.push(u.text):u.type==="file"&&o.push(u.file);for(let u of s.edges.filter(l=>!!l.label))o.push(u.label);r=o.join(`\r
`)}else if(n?.canFileBeExtracted(t))r=await n.extractText(e);else throw new Error(`Unsupported file type: "${t}"`);r==null&&(console.warn(`Omnisearch: ${r} content for file`,e.path),r=""),r=Pt(r);let i=app.metadataCache.getFileCache(e);if(i&&i.frontmatter?.["excalidraw-plugin"]){let s=i.sections?.filter(o=>o.type==="comment")??[];for(let{start:o,end:u}of s.map(l=>l.position))r=r.substring(0,o.offset-1)+r.substring(u.offset)}return{basename:Pt(e.basename),content:r,path:e.path,mtime:e.stat.mtime,tags:pa(i),aliases:ha(i).join(""),headings1:i?Pn(i,1).join(" "):"",headings2:i?Pn(i,2).join(" "):"",headings3:i?Pn(i,3).join(" "):""}}var ba=class{constructor(){this.nextQueryIsEmpty=!1;this.documents=new Map}async addToLiveCache(e){try{let r=await ed(e);if(!r.path){console.error(`Missing .path field in IndexedDocument "${r.basename}", skipping`);return}this.documents.set(e,r)}catch(r){console.warn(`Omnisearch: Error while adding "${e}" to live cache`,r),this.removeFromLiveCache(e)}}removeFromLiveCache(e){this.documents.delete(e)}async getDocument(e){return this.documents.has(e)?this.documents.get(e):(await this.addToLiveCache(e),this.documents.get(e))}async addToSearchHistory(e){if(!e){this.nextQueryIsEmpty=!0;return}this.nextQueryIsEmpty=!1;let r=await ke.searchHistory.toArray();r=r.filter(n=>n.query!==e).reverse(),r.unshift({query:e}),r=r.slice(0,10),await ke.searchHistory.clear(),await ke.searchHistory.bulkAdd(r)}async getSearchHistory(){let e=(await ke.searchHistory.toArray()).reverse().map(r=>r.query);return this.nextQueryIsEmpty&&e.unshift(""),e}getDocumentsChecksum(e){return ya(JSON.stringify(e.sort((r,n)=>r.path<n.path?-1:r.path>n.path?1:0)))}async getMinisearchCache(){try{return(await ke.minisearch.toArray())[0]}catch(e){return new _a.Notice("Omnisearch - Cache missing or invalid. Some freezes may occur while Omnisearch indexes your vault."),console.error("Omnisearch - Error while loading Minisearch cache"),console.error(e),null}}async writeMinisearchCache(e,r){let n=Array.from(r).map(([i,s])=>({path:i,mtime:s}));await ke.minisearch.clear(),await ke.minisearch.add({date:new Date().toISOString(),paths:n,data:e.toJSON()}),console.log("Omnisearch - Search cache written")}},he=new ba;function td(t){let e,r,n,i,s,o,u,l,a=t[9].default,c=zt(a,t,t[8],null);return{c(){e=P("div"),r=P("div"),n=P("input"),s=U(),c&&c.c(),B(n,"class","prompt-input"),B(n,"placeholder",t[0]),B(n,"spellcheck","false"),B(n,"type","text"),B(r,"class","omnisearch-input-field"),B(e,"class","omnisearch-input-container")},m(d,f){H(d,e,f),I(e,r),I(r,n),t[10](n),li(n,t[1]),I(e,s),c&&c.m(e,null),o=!0,u||(l=[Te(n,"input",t[11]),eo(i=t[3].call(null,n)),Te(n,"compositionend",t[12]),Te(n,"compositionstart",t[13]),Te(n,"input",t[4])],u=!0)},p(d,[f]){(!o||f&1)&&B(n,"placeholder",d[0]),f&2&&n.value!==d[1]&&li(n,d[1]),c&&c.p&&(!o||f&256)&&Ht(c,a,d,d[8],o?Vt(a,d[8],f,null):$t(d[8]),null)},i(d){o||(G(c,d),o=!0)},o(d){J(c,d),o=!1},d(d){d&&z(e),t[10](null),c&&c.d(d),u=!1,Me(l)}}}function rd(t,e,r){let{$$slots:n={},$$scope:i}=e,{initialValue:s=""}=e,o=!1,{placeholder:u=""}=e,l="",a,c=di();function d(y){r(1,l=y)}function f(y){it().then(()=>(a.focus(),it())).then(()=>{a.select()})}let p=(0,xa.debounce)(()=>{he.addToSearchHistory(""),c("input",l)},500);function b(y){Wt[y?"unshift":"push"](()=>{a=y,r(2,a)})}function w(){l=this.value,r(1,l),r(5,s),r(7,o)}let x=y=>ls(!1),h=y=>ls(!0);return t.$$set=y=>{"initialValue"in y&&r(5,s=y.initialValue),"placeholder"in y&&r(0,u=y.placeholder),"$$scope"in y&&r(8,i=y.$$scope)},t.$$.update=()=>{if(t.$$.dirty&162){e:s&&!o&&!l&&(r(7,o=!0),r(1,l=s),f())}},[u,l,a,f,p,s,d,o,i,n,b,w,x,h]}var wa=class extends me{constructor(e){super();ve(this,e,rd,td,fe,{initialValue:5,placeholder:0,setInputValue:6})}get setInputValue(){return this.$$.ctx[6]}},Bn=wa;function nd(t){let e,r,n,i,s=t[1].default,o=zt(s,t,t[0],null);return{c(){e=P("div"),o&&o.c(),B(e,"class","prompt-results")},m(u,l){H(u,e,l),o&&o.m(e,null),r=!0,n||(i=Te(e,"mousedown",id),n=!0)},p(u,[l]){o&&o.p&&(!r||l&1)&&Ht(o,s,u,u[0],r?Vt(s,u[0],l,null):$t(u[0]),null)},i(u){r||(G(o,u),r=!0)},o(u){J(o,u),r=!1},d(u){u&&z(e),o&&o.d(u),n=!1,i()}}}var id=t=>t.preventDefault();function sd(t,e,r){let{$$slots:n={},$$scope:i}=e;return t.$$set=s=>{"$$scope"in s&&r(0,i=s.$$scope)},[i,n]}var ja=class extends me{constructor(e){super();ve(this,e,sd,nd,fe,{})}},Ln=ja;var gs=Ee(require("obsidian"));async function Nn(t,e=!1){let r=pt(t.foundWords);r.exec(t.content);let n=r.lastIndex,i=!1;app.workspace.iterateAllLeaves(u=>{u.view instanceof gs.MarkdownView&&!e&&u.getViewState().state?.file===t.path&&u.getViewState()?.pinned&&(app.workspace.setActiveLeaf(u,{focus:!0}),i=!0)}),i||await app.workspace.openLinkText(t.path,"",e);let s=app.workspace.getActiveViewOfType(gs.MarkdownView);if(!s)return;let o=s.editor.offsetToPos(n);o.ch=0,s.editor.setCursor(o),s.editor.scrollIntoView({from:{line:o.line-10,ch:0},to:{line:o.line+10,ch:0}})}async function Aa(t,e=!1){try{let r;switch(app.vault.getConfig("newFileLocation")){case"current":r=(app.workspace.getActiveFile()?.parent.path??"")+"/";break;case"folder":r=app.vault.getConfig("newFileFolderPath")+"/";break;default:r="";break}await app.workspace.openLinkText(`${r}${t}.md`,"",e)}catch(r){throw r.message="OmniSearch - Could not create note: "+r.message,console.error(r),r}}function od(t){let e;return{c(){e=P("span"),e.innerHTML='<svg viewBox="0 0 100 100" class="add-note-glyph" width="16" height="16"><path fill="currentColor" stroke="currentColor" d="M23.3,6.7c-3.7,0-6.7,3-6.7,6.7v73.3c0,3.7,3,6.7,6.7,6.7h28.4c-3.2-4.8-5.1-10.5-5.1-16.7c0-16.6,13.4-30,30-30 c2.3,0,4.5,0.3,6.7,0.8V31.7c0-0.9-0.3-1.7-1-2.4L60.7,7.6c-0.6-0.6-1.5-1-2.4-1L23.3,6.7z M56.7,13L77,33.3H60 c-1.8,0-3.3-1.5-3.3-3.3L56.7,13z M76.7,53.3c-12.9,0-23.3,10.4-23.3,23.3S63.8,100,76.7,100S100,89.6,100,76.7 S89.6,53.3,76.7,53.3z M76.7,63.3c1.8,0,3.3,1.5,3.3,3.3v6.7h6.7c1.8,0,3.3,1.5,3.3,3.3c0,1.8-1.5,3.3-3.3,3.3H80v6.7 c0,1.8-1.5,3.3-3.3,3.3c-1.8,0-3.3-1.5-3.3-3.3V80h-6.7c-1.8,0-3.3-1.5-3.3-3.3s1.5-3.3,3.3-3.3h6.7v-6.7 C73.3,64.8,74.8,63.3,76.7,63.3L76.7,63.3z"></path></svg>',B(e,"class","suggestion-flair"),B(e,"aria-label","Not created yet, select to create")},m(r,n){H(r,e,n)},p:se,i:se,o:se,d(r){r&&z(e)}}}function ad(t){"use strict";return[]}var Sa=class extends me{constructor(e){super();ve(this,e,ad,od,fe,{})}},Fa=Sa;function Ca(t){let e,r;return e=new Fa({}),{c(){Fe(e.$$.fragment)},m(n,i){we(e,n,i),r=!0},i(n){r||(G(e.$$.fragment,n),r=!0)},o(n){J(e.$$.fragment,n),r=!1},d(n){ye(e,n)}}}function ud(t){let e,r,n,i,s,o=t[2]&&Ca(t),u=t[4].default,l=zt(u,t,t[3],null);return{c(){e=P("div"),o&&o.c(),r=U(),l&&l.c(),B(e,"data-result-id",t[0]),B(e,"class","suggestion-item omnisearch-result"),ci(e,"is-selected",t[1])},m(a,c){H(a,e,c),o&&o.m(e,null),I(e,r),l&&l.m(e,null),n=!0,i||(s=[Te(e,"mousemove",t[5]),Te(e,"click",t[6]),Te(e,"auxclick",t[7])],i=!0)},p(a,[c]){a[2]?o?c&4&&G(o,1):(o=Ca(a),o.c(),G(o,1),o.m(e,r)):o&&(St(),J(o,1,1,()=>{o=null}),Ft()),l&&l.p&&(!n||c&8)&&Ht(l,u,a,a[3],n?Vt(u,a[3],c,null):$t(a[3]),null),(!n||c&1)&&B(e,"data-result-id",a[0]),(!n||c&2)&&ci(e,"is-selected",a[1])},i(a){n||(G(o),G(l,a),n=!0)},o(a){J(o),J(l,a),n=!1},d(a){a&&z(e),o&&o.d(),l&&l.d(a),i=!1,Me(s)}}}function ld(t,e,r){let{$$slots:n={},$$scope:i}=e,{id:s}=e,{selected:o=!1}=e,{glyph:u=!1}=e;function l(d){ze.call(this,t,d)}function a(d){ze.call(this,t,d)}function c(d){ze.call(this,t,d)}return t.$$set=d=>{"id"in d&&r(0,s=d.id),"selected"in d&&r(1,o=d.selected),"glyph"in d&&r(2,u=d.glyph),"$$scope"in d&&r(3,i=d.$$scope)},[s,o,u,i,n,l,a,c]}var Ea=class extends me{constructor(e){super();ve(this,e,ld,ud,fe,{id:0,selected:1,glyph:2})}},Kn=Ea;function Ta(t){let e,r=t[1].matches.length+"",n,i,s=(t[1].matches.length>1?"matches":"match")+"",o;return{c(){e=P("span"),n=Pe(r),i=Pe("\xA0"),o=Pe(s),B(e,"class","omnisearch-result__counter")},m(u,l){H(u,e,l),I(e,n),I(e,i),I(e,o)},p(u,l){l&2&&r!==(r=u[1].matches.length+"")&&Ar(n,r),l&2&&s!==(s=(u[1].matches.length>1?"matches":"match")+"")&&Ar(o,s)},d(u){u&&z(e)}}}function Da(t){let e,r=t[5].replace(t[6],ht)+"";return{c(){e=P("div"),B(e,"class","omnisearch-result__body")},m(n,i){H(n,e,i),e.innerHTML=r},p(n,i){i&96&&r!==(r=n[5].replace(n[6],ht)+"")&&(e.innerHTML=r)},d(n){n&&z(e)}}}function Oa(t){let e,r;return{c(){e=P("img"),Ke(e,"width","100px"),ui(e.src,r=t[2])||B(e,"src",r),B(e,"alt","")},m(n,i){H(n,e,i)},p(n,i){i&4&&!ui(e.src,r=n[2])&&B(e,"src",r)},d(n){n&&z(e)}}}function cd(t){let e,r,n,i,s=t[3].replace(t[6],ht)+"",o,u,l,a=t[1].matches.length>0&&Ta(t),c=t[7]&&Da(t),d=t[2]&&Oa(t);return{c(){e=P("div"),r=P("div"),n=P("div"),i=P("span"),o=U(),a&&a.c(),u=U(),c&&c.c(),l=U(),d&&d.c(),B(i,"class","omnisearch-result__title"),Ke(e,"display","flex")},m(f,p){H(f,e,p),I(e,r),I(r,n),I(n,i),i.innerHTML=s,I(n,o),a&&a.m(n,null),I(r,u),c&&c.m(r,null),I(e,l),d&&d.m(e,null)},p(f,p){p&72&&s!==(s=f[3].replace(f[6],ht)+"")&&(i.innerHTML=s),f[1].matches.length>0?a?a.p(f,p):(a=Ta(f),a.c(),a.m(n,null)):a&&(a.d(1),a=null),f[7]?c?c.p(f,p):(c=Da(f),c.c(),c.m(r,null)):c&&(c.d(1),c=null),f[2]?d?d.p(f,p):(d=Oa(f),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},d(f){f&&z(e),a&&a.d(),c&&c.d(),d&&d.d()}}}function fd(t){let e,r;return e=new Kn({props:{id:t[1].path,selected:t[0],glyph:t[4],$$slots:{default:[cd]},$$scope:{ctx:t}}}),e.$on("mousemove",t[8]),e.$on("click",t[9]),{c(){Fe(e.$$.fragment)},m(n,i){we(e,n,i),r=!0},p(n,[i]){let s={};i&2&&(s.id=n[1].path),i&1&&(s.selected=n[0]),i&16&&(s.glyph=n[4]),i&1262&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){r||(G(e.$$.fragment,n),r=!0)},o(n){J(e.$$.fragment,n),r=!1},d(n){ye(e,n)}}}function dd(t,e,r){let n,i,s,o,u;rn(t,Mt,p=>r(7,u=p));let{selected:l=!1}=e,{note:a}=e,c=null;function d(p){ze.call(this,t,p)}function f(p){ze.call(this,t,p)}t.$$set=p=>{"selected"in p&&r(0,l=p.selected),"note"in p&&r(1,a=p.note)},t.$$.update=()=>{if(t.$$.dirty&2){e:if(r(2,c=null),ds(a.path)){let p=app.vault.getFiles().find(b=>b.path===a.path);p&&r(2,c=app.vault.getResourcePath(p))}}if(t.$$.dirty&2){e:r(6,n=pt(a.foundWords))}if(t.$$.dirty&2){e:r(5,i=ir(a.content,a.matches[0]?.offset??-1))}if(t.$$.dirty&2){e:r(3,o=D.showShortName?a.basename:a.path)}};e:r(4,s=!1);return[l,a,c,o,s,i,n,u,d,f]}var ka=class extends me{constructor(e){super();ve(this,e,dd,fd,fe,{selected:0,note:1})}},Ia=ka;function Ma(t,e){e?e.offsets=typeof e.offsets=="undefined"?!0:e.offsets:e={offsets:!0,tokenize:!0},t||(t="");let r={text:[],offsets:[],exclude:{text:[]}};e.offsets&&(r.offsets=[]);let n={text:[]},i=[],s=/(\S+:'(?:[^'\\]|\\.)*')|(\S+:"(?:[^"\\]|\\.)*")|(-?"(?:[^"\\]|\\.)*")|(-?'(?:[^'\\]|\\.)*')|\S+|\S+:\S+/g,o,u=0;for(;(o=s.exec(t))!==null&&!(++u>=100);){let a=o[0],c=a.indexOf(":");if(c!==-1){let d=a.slice(0,c),f=a.slice(c+1);f=(f+"").replace(/\\(.?)/g,function(p,b){switch(b){case"\\":return"\\";case"0":return"\0";case"":return"";default:return b}}),i.push({keyword:d,value:f,offsetStart:o.index,offsetEnd:o.index+a.length})}else{let d=!1;a[0]==="-"&&(d=!0,a=a.slice(1)),a=(a+"").replace(/\\(.?)/g,function(f,p){switch(p){case"\\":return"\\";case"0":return"\0";case"":return"";default:return p}}),d?n.text.push(a):i.push({text:a,offsetStart:o.index,offsetEnd:o.index+a.length})}}i.reverse();let l;for(;l=i.pop();)if(l.text)r.text.push(l.text),e.offsets&&r.offsets.push(l);else if(l.keyword){let a=l.keyword;e.keywords=e.keywords||[];let c=!1,d=!1;if(!/^-/.test(a))c=e.keywords.indexOf(a)!==-1;else if(a[0]==="-"){let p=a.slice(1);c=e.keywords.indexOf(p)!==-1,c&&(a=p,d=!0)}e.ranges=e.ranges||[];let f=e.ranges.indexOf(a)!==-1;if(c){e.offsets&&r.offsets.push({keyword:a,value:l.value,offsetStart:d?l.offsetStart+1:l.offsetStart,offsetEnd:l.offsetEnd});let p=l.value;if(p.length){let b=p.split(",");d?n[a]?n[a]instanceof Array?b.length>1?n[a]=n[a].concat(b):n[a].push(p):(n[a]=[n[a]],n[a].push(p)):b.length>1?n[a]=b:e.alwaysArray?n[a]=[p]:n[a]=p:r[a]?r[a]instanceof Array?b.length>1?r[a]=r[a].concat(b):r[a].push(p):(r[a]=[r[a]],r[a].push(p)):b.length>1?r[a]=b:e.alwaysArray?r[a]=[p]:r[a]=p}}else if(f){e.offsets&&r.offsets.push(l);let p=l.value,b=p.split("-");r[a]={},b.length===2?(r[a].from=b[0],r[a].to=b[1]):r[a].from=p}else{let p=l.keyword+":"+l.value;r.text.push(p),e.offsets&&r.offsets.push({text:p,offsetStart:l.offsetStart,offsetEnd:l.offsetEnd})}}return r.exclude=n,r}var Rt=class{constructor(e=""){this.segments=[];this.exclusions=[];D.ignoreDiacritics&&(e=Pt(e));let r=Ma(e.toLowerCase(),{tokenize:!0});this.exclusions=r.exclude.text.map(this.formatToken).filter(n=>!!n.value),this.segments=r.text.reduce((n,i)=>{let s=this.formatToken(i);return s.value&&n.push(s),n},[])}isEmpty(){return this.segments.length===0}segmentsToStr(){return this.segments.map(({value:e})=>e).join(" ")}getExactTerms(){return this.segments.filter(({exact:e})=>e).map(({value:e})=>e)}formatToken(e){let r=da(e);return{value:r,exact:r!==e}}};var re=function(){return re=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},re.apply(this,arguments)};function hd(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function l(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?s(c.value):i(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})}function pd(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(r=0)),r;)try{if(n=1,i&&(s=a[0]&2?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[a[0]&2,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!s||a[1]>s[0]&&a[1]<s[3])){r.label=a[1];break}if(a[0]===6&&r.label<s[1]){r.label=s[1],s=a;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(a);break}s[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],i=0}finally{n=s=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}function K(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ue(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}var md="ENTRIES",Pa="KEYS",Ra="VALUES",ge="",ys=function(){function t(e,r){var n=e._tree,i=Array.from(n.keys());this.set=e,this._type=r,this._path=i.length>0?[{node:n,keys:i}]:[]}return t.prototype.next=function(){var e=this.dive();return this.backtrack(),e},t.prototype.dive=function(){if(this._path.length===0)return{done:!0,value:void 0};var e=sr(this._path),r=e.node,n=e.keys;if(sr(n)===ge)return{done:!1,value:this.result()};var i=r.get(sr(n));return this._path.push({node:i,keys:Array.from(i.keys())}),this.dive()},t.prototype.backtrack=function(){if(this._path.length!==0){var e=sr(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}},t.prototype.key=function(){return this.set._prefix+this._path.map(function(e){var r=e.keys;return sr(r)}).filter(function(e){return e!==ge}).join("")},t.prototype.value=function(){return sr(this._path).node.get(ge)},t.prototype.result=function(){switch(this._type){case Ra:return this.value();case Pa:return this.key();default:return[this.key(),this.value()]}},t.prototype[Symbol.iterator]=function(){return this},t}(),sr=function(t){return t[t.length-1]},gd=function(t,e,r){var n=new Map;if(e===void 0)return n;for(var i=e.length+1,s=i+r,o=new Uint8Array(s*i).fill(r+1),u=0;u<i;++u)o[u]=u;for(var l=1;l<s;++l)o[l*i]=l;return Ba(t,e,r,n,o,1,i,""),n},Ba=function(t,e,r,n,i,s,o,u){var l,a,c=s*o;try{e:for(var d=K(t.keys()),f=d.next();!f.done;f=d.next()){var p=f.value;if(p===ge){var b=i[c-1];b<=r&&n.set(u,[t.get(p),b])}else{for(var w=s,x=0;x<p.length;++x,++w){for(var h=p[x],y=o*w,m=y-o,g=i[y],v=Math.max(0,w-r-1),_=Math.min(o-1,w+r),j=v;j<_;++j){var A=h!==e[j],S=i[m+j]+ +A,F=i[m+j+1]+1,E=i[y+j]+1,k=i[y+j+1]=Math.min(S,F,E);k<g&&(g=k)}if(g>r)continue e}Ba(t.get(p),e,r,n,i,w,o,u+p)}}}catch(T){l={error:T}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(l)throw l.error}}},vs=function(){function t(e,r){e===void 0&&(e=new Map),r===void 0&&(r=""),this._size=void 0,this._tree=e,this._prefix=r}return t.prototype.atPrefix=function(e){var r,n;if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");var i=ue(zn(this._tree,e.slice(this._prefix.length)),2),s=i[0],o=i[1];if(s===void 0){var u=ue(xs(o),2),l=u[0],a=u[1];try{for(var c=K(l.keys()),d=c.next();!d.done;d=c.next()){var f=d.value;if(f!==ge&&f.startsWith(a)){var p=new Map;return p.set(f.slice(a.length),l.get(f)),new t(p,e)}}}catch(b){r={error:b}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}return new t(s,e)},t.prototype.clear=function(){this._size=void 0,this._tree.clear()},t.prototype.delete=function(e){return this._size=void 0,yd(this._tree,e)},t.prototype.entries=function(){return new ys(this,md)},t.prototype.forEach=function(e){var r,n;try{for(var i=K(this),s=i.next();!s.done;s=i.next()){var o=ue(s.value,2),u=o[0],l=o[1];e(u,l,this)}}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.fuzzyGet=function(e,r){return gd(this._tree,e,r)},t.prototype.get=function(e){var r=_s(this._tree,e);return r!==void 0?r.get(ge):void 0},t.prototype.has=function(e){var r=_s(this._tree,e);return r!==void 0&&r.has(ge)},t.prototype.keys=function(){return new ys(this,Pa)},t.prototype.set=function(e,r){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var n=bs(this._tree,e);return n.set(ge,r),this},Object.defineProperty(t.prototype,"size",{get:function(){if(this._size)return this._size;this._size=0;for(var e=this.entries();!e.next().done;)this._size+=1;return this._size},enumerable:!1,configurable:!0}),t.prototype.update=function(e,r){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var n=bs(this._tree,e);return n.set(ge,r(n.get(ge))),this},t.prototype.fetch=function(e,r){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var n=bs(this._tree,e),i=n.get(ge);return i===void 0&&n.set(ge,i=r()),i},t.prototype.values=function(){return new ys(this,Ra)},t.prototype[Symbol.iterator]=function(){return this.entries()},t.from=function(e){var r,n,i=new t;try{for(var s=K(e),o=s.next();!o.done;o=s.next()){var u=ue(o.value,2),l=u[0],a=u[1];i.set(l,a)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i},t.fromObject=function(e){return t.from(Object.entries(e))},t}(),zn=function(t,e,r){var n,i;if(r===void 0&&(r=[]),e.length===0||t==null)return[t,r];try{for(var s=K(t.keys()),o=s.next();!o.done;o=s.next()){var u=o.value;if(u!==ge&&e.startsWith(u))return r.push([t,u]),zn(t.get(u),e.slice(u.length),r)}}catch(l){n={error:l}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return r.push([t,e]),zn(void 0,"",r)},_s=function(t,e){var r,n;if(e.length===0||t==null)return t;try{for(var i=K(t.keys()),s=i.next();!s.done;s=i.next()){var o=s.value;if(o!==ge&&e.startsWith(o))return _s(t.get(o),e.slice(o.length))}}catch(u){r={error:u}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},bs=function(t,e){var r,n,i=e.length;e:for(var s=0;t&&s<i;){try{for(var o=(r=void 0,K(t.keys())),u=o.next();!u.done;u=o.next()){var l=u.value;if(l!==ge&&e[s]===l[0]){for(var a=Math.min(i-s,l.length),c=1;c<a&&e[s+c]===l[c];)++c;var d=t.get(l);if(c===l.length)t=d;else{var f=new Map;f.set(l.slice(c),d),t.set(e.slice(s,s+c),f),t.delete(l),t=f}s+=c;continue e}}}catch(b){r={error:b}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}var p=new Map;return t.set(e.slice(s),p),p}return t},yd=function(t,e){var r=ue(zn(t,e),2),n=r[0],i=r[1];if(n!==void 0){if(n.delete(ge),n.size===0)La(i);else if(n.size===1){var s=ue(n.entries().next().value,2),o=s[0],u=s[1];Na(i,o,u)}}},La=function(t){if(t.length!==0){var e=ue(xs(t),2),r=e[0],n=e[1];if(r.delete(n),r.size===0)La(t.slice(0,-1));else if(r.size===1){var i=ue(r.entries().next().value,2),s=i[0],o=i[1];s!==ge&&Na(t.slice(0,-1),s,o)}}},Na=function(t,e,r){if(t.length!==0){var n=ue(xs(t),2),i=n[0],s=n[1];i.set(s+e,r),i.delete(s)}},xs=function(t){return t[t.length-1]},Jr,ws="or",Ka="and",vd="and_not",js=function(){function t(e){if((e==null?void 0:e.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');var r=e.autoVacuum==null||e.autoVacuum===!0?Es:e.autoVacuum;this._options=re(re(re({},Ss),e),{autoVacuum:r,searchOptions:re(re({},za),e.searchOptions||{}),autoSuggestOptions:re(re({},jd),e.autoSuggestOptions||{})}),this._index=new vs,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=Cs,this.addFields(this._options.fields)}return t.prototype.add=function(e){var r,n,i,s,o,u,l=this._options,a=l.extractField,c=l.tokenize,d=l.processTerm,f=l.fields,p=l.idField,b=a(e,p);if(b==null)throw new Error('MiniSearch: document does not have ID field "'.concat(p,'"'));if(this._idToShortId.has(b))throw new Error("MiniSearch: duplicate ID ".concat(b));var w=this.addDocumentId(b);this.saveStoredFields(w,e);try{for(var x=K(f),h=x.next();!h.done;h=x.next()){var y=h.value,m=a(e,y);if(m!=null){var g=c(m.toString(),y),v=this._fieldIds[y],_=new Set(g).size;this.addFieldLength(w,v,this._documentCount-1,_);try{for(var j=(i=void 0,K(g)),A=j.next();!A.done;A=j.next()){var S=A.value,F=d(S,y);if(Array.isArray(F))try{for(var E=(o=void 0,K(F)),k=E.next();!k.done;k=E.next()){var T=k.value;this.addTerm(v,w,T)}}catch(L){o={error:L}}finally{try{k&&!k.done&&(u=E.return)&&u.call(E)}finally{if(o)throw o.error}}else F&&this.addTerm(v,w,F)}}catch(L){i={error:L}}finally{try{A&&!A.done&&(s=j.return)&&s.call(j)}finally{if(i)throw i.error}}}}}catch(L){r={error:L}}finally{try{h&&!h.done&&(n=x.return)&&n.call(x)}finally{if(r)throw r.error}}},t.prototype.addAll=function(e){var r,n;try{for(var i=K(e),s=i.next();!s.done;s=i.next()){var o=s.value;this.add(o)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.addAllAsync=function(e,r){var n=this;r===void 0&&(r={});var i=r.chunkSize,s=i===void 0?10:i,o={chunk:[],promise:Promise.resolve()},u=e.reduce(function(c,d,f){var p=c.chunk,b=c.promise;return p.push(d),(f+1)%s==0?{chunk:[],promise:b.then(function(){return new Promise(function(w){return setTimeout(w,0)})}).then(function(){return n.addAll(p)})}:{chunk:p,promise:b}},o),l=u.chunk,a=u.promise;return a.then(function(){return n.addAll(l)})},t.prototype.remove=function(e){var r,n,i,s,o,u,l=this._options,a=l.tokenize,c=l.processTerm,d=l.extractField,f=l.fields,p=l.idField,b=d(e,p);if(b==null)throw new Error('MiniSearch: document does not have ID field "'.concat(p,'"'));var w=this._idToShortId.get(b);if(w==null)throw new Error("MiniSearch: cannot remove document with ID ".concat(b,": it is not in the index"));try{for(var x=K(f),h=x.next();!h.done;h=x.next()){var y=h.value,m=d(e,y);if(m!=null){var g=a(m.toString(),y),v=this._fieldIds[y],_=new Set(g).size;this.removeFieldLength(w,v,this._documentCount,_);try{for(var j=(i=void 0,K(g)),A=j.next();!A.done;A=j.next()){var S=A.value,F=c(S,y);if(Array.isArray(F))try{for(var E=(o=void 0,K(F)),k=E.next();!k.done;k=E.next()){var T=k.value;this.removeTerm(v,w,T)}}catch(L){o={error:L}}finally{try{k&&!k.done&&(u=E.return)&&u.call(E)}finally{if(o)throw o.error}}else F&&this.removeTerm(v,w,F)}}catch(L){i={error:L}}finally{try{A&&!A.done&&(s=j.return)&&s.call(j)}finally{if(i)throw i.error}}}}}catch(L){r={error:L}}finally{try{h&&!h.done&&(n=x.return)&&n.call(x)}finally{if(r)throw r.error}}this._storedFields.delete(w),this._documentIds.delete(w),this._idToShortId.delete(b),this._fieldLength.delete(w),this._documentCount-=1},t.prototype.removeAll=function(e){var r,n;if(e)try{for(var i=K(e),s=i.next();!s.done;s=i.next()){var o=s.value;this.remove(o)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new vs,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}},t.prototype.discard=function(e){var r=this,n=this._idToShortId.get(e);if(n==null)throw new Error("MiniSearch: cannot discard document with ID ".concat(e,": it is not in the index"));this._idToShortId.delete(e),this._documentIds.delete(n),this._storedFields.delete(n),(this._fieldLength.get(n)||[]).forEach(function(i,s){r.removeFieldLength(n,s,r._documentCount,i)}),this._fieldLength.delete(n),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()},t.prototype.maybeAutoVacuum=function(){if(this._options.autoVacuum!==!1){var e=this._options.autoVacuum,r=e.minDirtFactor,n=e.minDirtCount,i=e.batchSize,s=e.batchWait;this.conditionalVacuum({batchSize:i,batchWait:s},{minDirtCount:n,minDirtFactor:r})}},t.prototype.discardAll=function(e){var r,n,i=this._options.autoVacuum;try{this._options.autoVacuum=!1;try{for(var s=K(e),o=s.next();!o.done;o=s.next()){var u=o.value;this.discard(u)}}catch(l){r={error:l}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}finally{this._options.autoVacuum=i}this.maybeAutoVacuum()},t.prototype.replace=function(e){var r=this._options,n=r.idField,i=r.extractField,s=i(e,n);this.discard(s),this.add(e)},t.prototype.vacuum=function(e){return e===void 0&&(e={}),this.conditionalVacuum(e)},t.prototype.conditionalVacuum=function(e,r){var n=this;return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&r,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(function(){var i=n._enqueuedVacuumConditions;return n._enqueuedVacuumConditions=Cs,n.performVacuuming(e,i)}),this._enqueuedVacuum)):this.vacuumConditionsMet(r)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(e),this._currentVacuum)},t.prototype.performVacuuming=function(e,r){return hd(this,void 0,void 0,function(){var n,i,s,o,u,l,a,c,d,f,p,b,w,x,h,y,m,g,v,_,j,A,S,F,E;return pd(this,function(k){switch(k.label){case 0:if(n=this._dirtCount,!this.vacuumConditionsMet(r))return[3,10];i=e.batchSize||Fs.batchSize,s=e.batchWait||Fs.batchWait,o=1,k.label=1;case 1:k.trys.push([1,7,8,9]),u=K(this._index),l=u.next(),k.label=2;case 2:if(l.done)return[3,6];a=ue(l.value,2),c=a[0],d=a[1];try{for(f=(A=void 0,K(d)),p=f.next();!p.done;p=f.next()){b=ue(p.value,2),w=b[0],x=b[1];try{for(h=(F=void 0,K(x)),y=h.next();!y.done;y=h.next())m=ue(y.value,1),g=m[0],!this._documentIds.has(g)&&(x.size<=1?d.delete(w):x.delete(g))}catch(T){F={error:T}}finally{try{y&&!y.done&&(E=h.return)&&E.call(h)}finally{if(F)throw F.error}}}}catch(T){A={error:T}}finally{try{p&&!p.done&&(S=f.return)&&S.call(f)}finally{if(A)throw A.error}}return this._index.get(c).size===0&&this._index.delete(c),o%i!=0?[3,4]:[4,new Promise(function(T){return setTimeout(T,s)})];case 3:k.sent(),k.label=4;case 4:o+=1,k.label=5;case 5:return l=u.next(),[3,2];case 6:return[3,9];case 7:return v=k.sent(),_={error:v},[3,9];case 8:try{l&&!l.done&&(j=u.return)&&j.call(u)}finally{if(_)throw _.error}return[7];case 9:this._dirtCount-=n,k.label=10;case 10:return[4,null];case 11:return k.sent(),this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null,[2]}})})},t.prototype.vacuumConditionsMet=function(e){if(e==null)return!0;var r=e.minDirtCount,n=e.minDirtFactor;return r=r||Es.minDirtCount,n=n||Es.minDirtFactor,this.dirtCount>=r&&this.dirtFactor>=n},Object.defineProperty(t.prototype,"isVacuuming",{get:function(){return this._currentVacuum!=null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dirtCount",{get:function(){return this._dirtCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dirtFactor",{get:function(){return this._dirtCount/(1+this._documentCount+this._dirtCount)},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return this._idToShortId.has(e)},t.prototype.search=function(e,r){var n,i;r===void 0&&(r={});var s=this.executeQuery(e,r),o=[];try{for(var u=K(s),l=u.next();!l.done;l=u.next()){var a=ue(l.value,2),c=a[0],d=a[1],f=d.score,p=d.terms,b=d.match,w=p.length,x={id:this._documentIds.get(c),score:f*w,terms:Object.keys(b),match:b};Object.assign(x,this._storedFields.get(c)),(r.filter==null||r.filter(x))&&o.push(x)}}catch(h){n={error:h}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}return o.sort(Ha),o},t.prototype.autoSuggest=function(e,r){var n,i,s,o;r===void 0&&(r={}),r=re(re({},this._options.autoSuggestOptions),r);var u=new Map;try{for(var l=K(this.search(e,r)),a=l.next();!a.done;a=l.next()){var c=a.value,d=c.score,f=c.terms,p=f.join(" "),b=u.get(p);b!=null?(b.score+=d,b.count+=1):u.set(p,{score:d,terms:f,count:1})}}catch(v){n={error:v}}finally{try{a&&!a.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}var w=[];try{for(var x=K(u),h=x.next();!h.done;h=x.next()){var y=ue(h.value,2),b=y[0],m=y[1],d=m.score,f=m.terms,g=m.count;w.push({suggestion:b,terms:f,score:d/g})}}catch(v){s={error:v}}finally{try{h&&!h.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}return w.sort(Ha),w},Object.defineProperty(t.prototype,"documentCount",{get:function(){return this._documentCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"termCount",{get:function(){return this._index.size},enumerable:!1,configurable:!0}),t.loadJSON=function(e,r){if(r==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(e),r)},t.getDefault=function(e){if(Ss.hasOwnProperty(e))return As(Ss,e);throw new Error('MiniSearch: unknown option "'.concat(e,'"'))},t.loadJS=function(e,r){var n,i,s,o,u,l,a=e.index,c=e.documentCount,d=e.nextId,f=e.documentIds,p=e.fieldIds,b=e.fieldLength,w=e.averageFieldLength,x=e.storedFields,h=e.dirtCount,y=e.serializationVersion;if(y!==1&&y!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");var m=new t(r);m._documentCount=c,m._nextId=d,m._documentIds=Vn(f),m._idToShortId=new Map,m._fieldIds=p,m._fieldLength=Vn(b),m._avgFieldLength=w,m._storedFields=Vn(x),m._dirtCount=h||0,m._index=new vs;try{for(var g=K(m._documentIds),v=g.next();!v.done;v=g.next()){var _=ue(v.value,2),j=_[0],A=_[1];m._idToShortId.set(A,j)}}catch($){n={error:$}}finally{try{v&&!v.done&&(i=g.return)&&i.call(g)}finally{if(n)throw n.error}}try{for(var S=K(a),F=S.next();!F.done;F=S.next()){var E=ue(F.value,2),k=E[0],T=E[1],L=new Map;try{for(var Y=(u=void 0,K(Object.keys(T))),C=Y.next();!C.done;C=Y.next()){var N=C.value,q=T[N];y===1&&(q=q.ds),L.set(parseInt(N,10),Vn(q))}}catch($){u={error:$}}finally{try{C&&!C.done&&(l=Y.return)&&l.call(Y)}finally{if(u)throw u.error}}m._index.set(k,L)}}catch($){s={error:$}}finally{try{F&&!F.done&&(o=S.return)&&o.call(S)}finally{if(s)throw s.error}}return m},t.prototype.executeQuery=function(e,r){var n=this;if(r===void 0&&(r={}),typeof e!="string"){var i=re(re(re({},r),e),{queries:void 0}),s=e.queries.map(function(x){return n.executeQuery(x,i)});return this.combineResults(s,e.combineWith)}var o=this._options,u=o.tokenize,l=o.processTerm,a=o.searchOptions,c=re(re({tokenize:u,processTerm:l},a),r),d=c.tokenize,f=c.processTerm,p=d(e).flatMap(function(x){return f(x)}).filter(function(x){return!!x}),b=p.map(wd(c)),w=b.map(function(x){return n.executeQuerySpec(x,c)});return this.combineResults(w,c.combineWith)},t.prototype.executeQuerySpec=function(e,r){var n,i,s,o,u=re(re({},this._options.searchOptions),r),l=(u.fields||this._options.fields).reduce(function(N,q){var $;return re(re({},N),($={},$[q]=As(N,q)||1,$))},u.boost||{}),a=u.boostDocument,c=u.weights,d=u.maxFuzzy,f=u.bm25,p=re(re({},za.weights),c),b=p.fuzzy,w=p.prefix,x=this._index.get(e.term),h=this.termResults(e.term,e.term,1,x,l,a,f),y,m;if(e.prefix&&(y=this._index.atPrefix(e.term)),e.fuzzy){var g=e.fuzzy===!0?.2:e.fuzzy,v=g<1?Math.min(d,Math.round(e.term.length*g)):g;v&&(m=this._index.fuzzyGet(e.term,v))}if(y)try{for(var _=K(y),j=_.next();!j.done;j=_.next()){var A=ue(j.value,2),S=A[0],F=A[1],E=S.length-e.term.length;if(!!E){m==null||m.delete(S);var k=w*S.length/(S.length+.3*E);this.termResults(e.term,S,k,F,l,a,f,h)}}}catch(N){n={error:N}}finally{try{j&&!j.done&&(i=_.return)&&i.call(_)}finally{if(n)throw n.error}}if(m)try{for(var T=K(m.keys()),L=T.next();!L.done;L=T.next()){var S=L.value,Y=ue(m.get(S),2),C=Y[0],E=Y[1];if(!!E){var k=b*S.length/(S.length+E);this.termResults(e.term,S,k,C,l,a,f,h)}}}catch(N){s={error:N}}finally{try{L&&!L.done&&(o=T.return)&&o.call(T)}finally{if(s)throw s.error}}return h},t.prototype.combineResults=function(e,r){if(r===void 0&&(r=ws),e.length===0)return new Map;var n=r.toLowerCase();return e.reduce(_d[n])||new Map},t.prototype.toJSON=function(){var e,r,n,i,s=[];try{for(var o=K(this._index),u=o.next();!u.done;u=o.next()){var l=ue(u.value,2),a=l[0],c=l[1],d={};try{for(var f=(n=void 0,K(c)),p=f.next();!p.done;p=f.next()){var b=ue(p.value,2),w=b[0],x=b[1];d[w]=Object.fromEntries(x)}}catch(h){n={error:h}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}s.push([a,d])}}catch(h){e={error:h}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:s,serializationVersion:2}},t.prototype.termResults=function(e,r,n,i,s,o,u,l){var a,c,d,f,p;if(l===void 0&&(l=new Map),i==null)return l;try{for(var b=K(Object.keys(s)),w=b.next();!w.done;w=b.next()){var x=w.value,h=s[x],y=this._fieldIds[x],m=i.get(y);if(m!=null){var g=m.size,v=this._avgFieldLength[y];try{for(var _=(d=void 0,K(m.keys())),j=_.next();!j.done;j=_.next()){var A=j.value;if(!this._documentIds.has(A)){this.removeTerm(y,A,r),g-=1;continue}var S=o?o(this._documentIds.get(A),r):1;if(!!S){var F=m.get(A),E=this._fieldLength.get(A)[y],k=xd(F,g,this._documentCount,E,v,u),T=n*h*S*k,L=l.get(A);if(L){L.score+=T,Ad(L.terms,e);var Y=As(L.match,r);Y?Y.push(x):L.match[r]=[x]}else l.set(A,{score:T,terms:[e],match:(p={},p[r]=[x],p)})}}}catch(C){d={error:C}}finally{try{j&&!j.done&&(f=_.return)&&f.call(_)}finally{if(d)throw d.error}}}}}catch(C){a={error:C}}finally{try{w&&!w.done&&(c=b.return)&&c.call(b)}finally{if(a)throw a.error}}return l},t.prototype.addTerm=function(e,r,n){var i=this._index.fetch(n,$a),s=i.get(e);if(s==null)s=new Map,s.set(r,1),i.set(e,s);else{var o=s.get(r);s.set(r,(o||0)+1)}},t.prototype.removeTerm=function(e,r,n){if(!this._index.has(n)){this.warnDocumentChanged(r,e,n);return}var i=this._index.fetch(n,$a),s=i.get(e);s==null||s.get(r)==null?this.warnDocumentChanged(r,e,n):s.get(r)<=1?s.size<=1?i.delete(e):s.delete(r):s.set(r,s.get(r)-1),this._index.get(n).size===0&&this._index.delete(n)},t.prototype.warnDocumentChanged=function(e,r,n){var i,s;try{for(var o=K(Object.keys(this._fieldIds)),u=o.next();!u.done;u=o.next()){var l=u.value;if(this._fieldIds[l]===r){this._options.logger("warn","MiniSearch: document with ID ".concat(this._documentIds.get(e),' has changed before removal: term "').concat(n,'" was not present in field "').concat(l,'". Removing a document after it has changed can corrupt the index!'),"version_conflict");return}}}catch(a){i={error:a}}finally{try{u&&!u.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}},t.prototype.addDocumentId=function(e){var r=this._nextId;return this._idToShortId.set(e,r),this._documentIds.set(r,e),this._documentCount+=1,this._nextId+=1,r},t.prototype.addFields=function(e){for(var r=0;r<e.length;r++)this._fieldIds[e[r]]=r},t.prototype.addFieldLength=function(e,r,n,i){var s=this._fieldLength.get(e);s==null&&this._fieldLength.set(e,s=[]),s[r]=i;var o=this._avgFieldLength[r]||0,u=o*n+i;this._avgFieldLength[r]=u/(n+1)},t.prototype.removeFieldLength=function(e,r,n,i){if(n===1){this._avgFieldLength[r]=0;return}var s=this._avgFieldLength[r]*n-i;this._avgFieldLength[r]=s/(n-1)},t.prototype.saveStoredFields=function(e,r){var n,i,s=this._options,o=s.storeFields,u=s.extractField;if(!(o==null||o.length===0)){var l=this._storedFields.get(e);l==null&&this._storedFields.set(e,l={});try{for(var a=K(o),c=a.next();!c.done;c=a.next()){var d=c.value,f=u(r,d);f!==void 0&&(l[d]=f)}}catch(p){n={error:p}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}},t}(),As=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},_d=(Jr={},Jr[ws]=function(t,e){var r,n;try{for(var i=K(e.keys()),s=i.next();!s.done;s=i.next()){var o=s.value,u=t.get(o);if(u==null)t.set(o,e.get(o));else{var l=e.get(o),a=l.score,c=l.terms,d=l.match;u.score=u.score+a,u.match=Object.assign(u.match,d),Va(u.terms,c)}}}catch(f){r={error:f}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return t},Jr[Ka]=function(t,e){var r,n,i=new Map;try{for(var s=K(e.keys()),o=s.next();!o.done;o=s.next()){var u=o.value,l=t.get(u);if(l!=null){var a=e.get(u),c=a.score,d=a.terms,f=a.match;Va(l.terms,d),i.set(u,{score:l.score+c,terms:l.terms,match:Object.assign(l.match,f)})}}}catch(p){r={error:p}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i},Jr[vd]=function(t,e){var r,n;try{for(var i=K(e.keys()),s=i.next();!s.done;s=i.next()){var o=s.value;t.delete(o)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return t},Jr),bd={k:1.2,b:.7,d:.5},xd=function(t,e,r,n,i,s){var o=s.k,u=s.b,l=s.d,a=Math.log(1+(r-e+.5)/(e+.5));return a*(l+t*(o+1)/(t+o*(1-u+u*n/i)))},wd=function(t){return function(e,r,n){var i=typeof t.fuzzy=="function"?t.fuzzy(e,r,n):t.fuzzy||!1,s=typeof t.prefix=="function"?t.prefix(e,r,n):t.prefix===!0;return{term:e,fuzzy:i,prefix:s}}},Ss={idField:"id",extractField:function(t,e){return t[e]},tokenize:function(t,e){return t.split(Sd)},processTerm:function(t,e){return t.toLowerCase()},fields:void 0,searchOptions:void 0,storeFields:[],logger:function(t,e,r){return console!=null&&console.warn!=null&&console[t](e)},autoVacuum:!0},za={combineWith:ws,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:bd},jd={combineWith:Ka,prefix:function(t,e,r){return e===r.length-1}},Fs={batchSize:1e3,batchWait:10},Cs={minDirtFactor:.1,minDirtCount:20},Es=re(re({},Fs),Cs),Ad=function(t,e){t.includes(e)||t.push(e)},Va=function(t,e){var r,n;try{for(var i=K(e),s=i.next();!s.done;s=i.next()){var o=s.value;t.includes(o)||t.push(o)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},Ha=function(t,e){var r=t.score,n=e.score;return n-r},$a=function(){return new Map},Vn=function(t){var e,r,n=new Map;try{for(var i=K(Object.keys(t)),s=i.next();!s.done;s=i.next()){var o=s.value;n.set(parseInt(o,10),t[o])}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},Sd=/[\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;var ql=Ee(require("obsidian"));var Fd=typeof global=="object"&&global&&global.Object===Object&&global,Hn=Fd;var Cd=typeof self=="object"&&self&&self.Object===Object&&self,Ed=Hn||Cd||Function("return this")(),pe=Ed;var Td=pe.Symbol,Se=Td;var Wa=Object.prototype,Dd=Wa.hasOwnProperty,Od=Wa.toString,Xr=Se?Se.toStringTag:void 0;function kd(t){var e=Dd.call(t,Xr),r=t[Xr];try{t[Xr]=void 0;var n=!0}catch{}var i=Od.call(t);return n&&(e?t[Xr]=r:delete t[Xr]),i}var Ua=kd;var Id=Object.prototype,Md=Id.toString;function Pd(t){return Md.call(t)}var qa=Pd;var Rd="[object Null]",Bd="[object Undefined]",Ga=Se?Se.toStringTag:void 0;function Ld(t){return t==null?t===void 0?Bd:Rd:Ga&&Ga in Object(t)?Ua(t):qa(t)}var Be=Ld;function Nd(t){return t!=null&&typeof t=="object"}var Le=Nd;var Kd="[object Symbol]";function zd(t){return typeof t=="symbol"||Le(t)&&Be(t)==Kd}var tt=zd;function Vd(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var or=Vd;var Hd=Array.isArray,oe=Hd;var $d=1/0,Qa=Se?Se.prototype:void 0,Ya=Qa?Qa.toString:void 0;function Ja(t){if(typeof t=="string")return t;if(oe(t))return or(t,Ja)+"";if(tt(t))return Ya?Ya.call(t):"";var e=t+"";return e=="0"&&1/t==-$d?"-0":e}var Xa=Ja;function Wd(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var mt=Wd;function Ud(t){return t}var gt=Ud;var qd="[object AsyncFunction]",Gd="[object Function]",Qd="[object GeneratorFunction]",Yd="[object Proxy]";function Jd(t){if(!mt(t))return!1;var e=Be(t);return e==Gd||e==Qd||e==qd||e==Yd}var $n=Jd;var Xd=pe["__core-js_shared__"],Wn=Xd;var Za=function(){var t=/[^.]+$/.exec(Wn&&Wn.keys&&Wn.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Zd(t){return!!Za&&Za in t}var eu=Zd;var eh=Function.prototype,th=eh.toString;function rh(t){if(t!=null){try{return th.call(t)}catch{}try{return t+""}catch{}}return""}var rt=rh;var nh=/[\\^$.*+?()[\]{}|]/g,ih=/^\[object .+?Constructor\]$/,sh=Function.prototype,oh=Object.prototype,ah=sh.toString,uh=oh.hasOwnProperty,lh=RegExp("^"+ah.call(uh).replace(nh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ch(t){if(!mt(t)||eu(t))return!1;var e=$n(t)?lh:ih;return e.test(rt(t))}var tu=ch;function fh(t,e){return t==null?void 0:t[e]}var ru=fh;function dh(t,e){var r=ru(t,e);return tu(r)?r:void 0}var Ce=dh;var hh=Ce(pe,"WeakMap"),Un=hh;function ph(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var nu=ph;var mh=800,gh=16,yh=Date.now;function vh(t){var e=0,r=0;return function(){var n=yh(),i=gh-(n-r);if(r=n,i>0){if(++e>=mh)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var iu=vh;function _h(t){return function(){return t}}var su=_h;var bh=function(){try{var t=Ce(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Ts=bh;var xh=Ts?function(t,e){return Ts(t,"toString",{configurable:!0,enumerable:!1,value:su(e),writable:!0})}:gt,ou=xh;var wh=iu(ou),au=wh;var jh=9007199254740991,Ah=/^(?:0|[1-9]\d*)$/;function Sh(t,e){var r=typeof t;return e=e??jh,!!e&&(r=="number"||r!="symbol"&&Ah.test(t))&&t>-1&&t%1==0&&t<e}var ar=Sh;function Fh(t,e){return t===e||t!==t&&e!==e}var ur=Fh;var uu=Math.max;function Ch(t,e,r){return e=uu(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,s=uu(n.length-e,0),o=Array(s);++i<s;)o[i]=n[e+i];i=-1;for(var u=Array(e+1);++i<e;)u[i]=n[i];return u[e]=r(o),nu(t,this,u)}}var lu=Ch;function Eh(t,e){return au(lu(t,e,gt),t+"")}var cu=Eh;var Th=9007199254740991;function Dh(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Th}var lr=Dh;function Oh(t){return t!=null&&lr(t.length)&&!$n(t)}var yt=Oh;function kh(t,e,r){if(!mt(r))return!1;var n=typeof e;return(n=="number"?yt(r)&&ar(e,r.length):n=="string"&&e in r)?ur(r[e],t):!1}var Ds=kh;var Ih=Object.prototype;function Mh(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Ih;return t===r}var fu=Mh;function Ph(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var du=Ph;var Rh="[object Arguments]";function Bh(t){return Le(t)&&Be(t)==Rh}var Os=Bh;var hu=Object.prototype,Lh=hu.hasOwnProperty,Nh=hu.propertyIsEnumerable,Kh=Os(function(){return arguments}())?Os:function(t){return Le(t)&&Lh.call(t,"callee")&&!Nh.call(t,"callee")},cr=Kh;function zh(){return!1}var pu=zh;var mu=typeof exports=="object"&&exports&&!exports.nodeType&&exports,gu=mu&&typeof module=="object"&&module&&!module.nodeType&&module,Vh=gu&&gu.exports===mu,yu=Vh?pe.Buffer:void 0,Hh=yu?yu.isBuffer:void 0,$h=Hh||pu,Zr=$h;var Wh="[object Arguments]",Uh="[object Array]",qh="[object Boolean]",Gh="[object Date]",Qh="[object Error]",Yh="[object Function]",Jh="[object Map]",Xh="[object Number]",Zh="[object Object]",ep="[object RegExp]",tp="[object Set]",rp="[object String]",np="[object WeakMap]",ip="[object ArrayBuffer]",sp="[object DataView]",op="[object Float32Array]",ap="[object Float64Array]",up="[object Int8Array]",lp="[object Int16Array]",cp="[object Int32Array]",fp="[object Uint8Array]",dp="[object Uint8ClampedArray]",hp="[object Uint16Array]",pp="[object Uint32Array]",ee={};ee[op]=ee[ap]=ee[up]=ee[lp]=ee[cp]=ee[fp]=ee[dp]=ee[hp]=ee[pp]=!0;ee[Wh]=ee[Uh]=ee[ip]=ee[qh]=ee[sp]=ee[Gh]=ee[Qh]=ee[Yh]=ee[Jh]=ee[Xh]=ee[Zh]=ee[ep]=ee[tp]=ee[rp]=ee[np]=!1;function mp(t){return Le(t)&&lr(t.length)&&!!ee[Be(t)]}var vu=mp;function gp(t){return function(e){return t(e)}}var qn=gp;var _u=typeof exports=="object"&&exports&&!exports.nodeType&&exports,en=_u&&typeof module=="object"&&module&&!module.nodeType&&module,yp=en&&en.exports===_u,ks=yp&&Hn.process,vp=function(){try{var t=en&&en.require&&en.require("util").types;return t||ks&&ks.binding&&ks.binding("util")}catch{}}(),Is=vp;var bu=Is&&Is.isTypedArray,_p=bu?qn(bu):vu,Gn=_p;var bp=Object.prototype,xp=bp.hasOwnProperty;function wp(t,e){var r=oe(t),n=!r&&cr(t),i=!r&&!n&&Zr(t),s=!r&&!n&&!i&&Gn(t),o=r||n||i||s,u=o?du(t.length,String):[],l=u.length;for(var a in t)(e||xp.call(t,a))&&!(o&&(a=="length"||i&&(a=="offset"||a=="parent")||s&&(a=="buffer"||a=="byteLength"||a=="byteOffset")||ar(a,l)))&&u.push(a);return u}var xu=wp;function jp(t,e){return function(r){return t(e(r))}}var wu=jp;var Ap=wu(Object.keys,Object),ju=Ap;var Sp=Object.prototype,Fp=Sp.hasOwnProperty;function Cp(t){if(!fu(t))return ju(t);var e=[];for(var r in Object(t))Fp.call(t,r)&&r!="constructor"&&e.push(r);return e}var Au=Cp;function Ep(t){return yt(t)?xu(t):Au(t)}var fr=Ep;var Tp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dp=/^\w*$/;function Op(t,e){if(oe(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||tt(t)?!0:Dp.test(t)||!Tp.test(t)||e!=null&&t in Object(e)}var dr=Op;var kp=Ce(Object,"create"),nt=kp;function Ip(){this.__data__=nt?nt(null):{},this.size=0}var Su=Ip;function Mp(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Fu=Mp;var Pp="__lodash_hash_undefined__",Rp=Object.prototype,Bp=Rp.hasOwnProperty;function Lp(t){var e=this.__data__;if(nt){var r=e[t];return r===Pp?void 0:r}return Bp.call(e,t)?e[t]:void 0}var Cu=Lp;var Np=Object.prototype,Kp=Np.hasOwnProperty;function zp(t){var e=this.__data__;return nt?e[t]!==void 0:Kp.call(e,t)}var Eu=zp;var Vp="__lodash_hash_undefined__";function Hp(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=nt&&e===void 0?Vp:e,this}var Tu=Hp;function hr(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}hr.prototype.clear=Su;hr.prototype.delete=Fu;hr.prototype.get=Cu;hr.prototype.has=Eu;hr.prototype.set=Tu;var Ms=hr;function $p(){this.__data__=[],this.size=0}var Du=$p;function Wp(t,e){for(var r=t.length;r--;)if(ur(t[r][0],e))return r;return-1}var vt=Wp;var Up=Array.prototype,qp=Up.splice;function Gp(t){var e=this.__data__,r=vt(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():qp.call(e,r,1),--this.size,!0}var Ou=Gp;function Qp(t){var e=this.__data__,r=vt(e,t);return r<0?void 0:e[r][1]}var ku=Qp;function Yp(t){return vt(this.__data__,t)>-1}var Iu=Yp;function Jp(t,e){var r=this.__data__,n=vt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var Mu=Jp;function pr(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}pr.prototype.clear=Du;pr.prototype.delete=Ou;pr.prototype.get=ku;pr.prototype.has=Iu;pr.prototype.set=Mu;var _t=pr;var Xp=Ce(pe,"Map"),bt=Xp;function Zp(){this.size=0,this.__data__={hash:new Ms,map:new(bt||_t),string:new Ms}}var Pu=Zp;function em(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Ru=em;function tm(t,e){var r=t.__data__;return Ru(e)?r[typeof e=="string"?"string":"hash"]:r.map}var xt=tm;function rm(t){var e=xt(this,t).delete(t);return this.size-=e?1:0,e}var Bu=rm;function nm(t){return xt(this,t).get(t)}var Lu=nm;function im(t){return xt(this,t).has(t)}var Nu=im;function sm(t,e){var r=xt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var Ku=sm;function mr(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}mr.prototype.clear=Pu;mr.prototype.delete=Bu;mr.prototype.get=Lu;mr.prototype.has=Nu;mr.prototype.set=Ku;var Bt=mr;var om="Expected a function";function Ps(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(om);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=t.apply(this,n);return r.cache=s.set(i,o)||s,o};return r.cache=new(Ps.Cache||Bt),r}Ps.Cache=Bt;var zu=Ps;var am=500;function um(t){var e=zu(t,function(n){return r.size===am&&r.clear(),n}),r=e.cache;return e}var Vu=um;var lm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,cm=/\\(\\)?/g,fm=Vu(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(lm,function(r,n,i,s){e.push(i?s.replace(cm,"$1"):n||r)}),e}),Hu=fm;function dm(t){return t==null?"":Xa(t)}var $u=dm;function hm(t,e){return oe(t)?t:dr(t,e)?[t]:Hu($u(t))}var Qn=hm;var pm=1/0;function mm(t){if(typeof t=="string"||tt(t))return t;var e=t+"";return e=="0"&&1/t==-pm?"-0":e}var wt=mm;function gm(t,e){e=Qn(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[wt(e[r++])];return r&&r==n?t:void 0}var gr=gm;function ym(t,e,r){var n=t==null?void 0:gr(t,e);return n===void 0?r:n}var Wu=ym;function vm(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var Yn=vm;var Uu=Se?Se.isConcatSpreadable:void 0;function _m(t){return oe(t)||cr(t)||!!(Uu&&t&&t[Uu])}var qu=_m;function Gu(t,e,r,n,i){var s=-1,o=t.length;for(r||(r=qu),i||(i=[]);++s<o;){var u=t[s];e>0&&r(u)?e>1?Gu(u,e-1,r,n,i):Yn(i,u):n||(i[i.length]=u)}return i}var Qu=Gu;function bm(){this.__data__=new _t,this.size=0}var Yu=bm;function xm(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var Ju=xm;function wm(t){return this.__data__.get(t)}var Xu=wm;function jm(t){return this.__data__.has(t)}var Zu=jm;var Am=200;function Sm(t,e){var r=this.__data__;if(r instanceof _t){var n=r.__data__;if(!bt||n.length<Am-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Bt(n)}return r.set(t,e),this.size=r.size,this}var el=Sm;function yr(t){var e=this.__data__=new _t(t);this.size=e.size}yr.prototype.clear=Yu;yr.prototype.delete=Ju;yr.prototype.get=Xu;yr.prototype.has=Zu;yr.prototype.set=el;var vr=yr;function Fm(t,e){for(var r=-1,n=t==null?0:t.length,i=0,s=[];++r<n;){var o=t[r];e(o,r,t)&&(s[i++]=o)}return s}var tl=Fm;function Cm(){return[]}var rl=Cm;var Em=Object.prototype,Tm=Em.propertyIsEnumerable,nl=Object.getOwnPropertySymbols,Dm=nl?function(t){return t==null?[]:(t=Object(t),tl(nl(t),function(e){return Tm.call(t,e)}))}:rl,il=Dm;function Om(t,e,r){var n=e(t);return oe(t)?n:Yn(n,r(t))}var sl=Om;function km(t){return sl(t,fr,il)}var Rs=km;var Im=Ce(pe,"DataView"),Jn=Im;var Mm=Ce(pe,"Promise"),Xn=Mm;var Pm=Ce(pe,"Set"),Zn=Pm;var ol="[object Map]",Rm="[object Object]",al="[object Promise]",ul="[object Set]",ll="[object WeakMap]",cl="[object DataView]",Bm=rt(Jn),Lm=rt(bt),Nm=rt(Xn),Km=rt(Zn),zm=rt(Un),Lt=Be;(Jn&&Lt(new Jn(new ArrayBuffer(1)))!=cl||bt&&Lt(new bt)!=ol||Xn&&Lt(Xn.resolve())!=al||Zn&&Lt(new Zn)!=ul||Un&&Lt(new Un)!=ll)&&(Lt=function(t){var e=Be(t),r=e==Rm?t.constructor:void 0,n=r?rt(r):"";if(n)switch(n){case Bm:return cl;case Lm:return ol;case Nm:return al;case Km:return ul;case zm:return ll}return e});var Bs=Lt;var Vm=pe.Uint8Array,Ls=Vm;var Hm="__lodash_hash_undefined__";function $m(t){return this.__data__.set(t,Hm),this}var fl=$m;function Wm(t){return this.__data__.has(t)}var dl=Wm;function ei(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Bt;++e<r;)this.add(t[e])}ei.prototype.add=ei.prototype.push=fl;ei.prototype.has=dl;var hl=ei;function Um(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var pl=Um;function qm(t,e){return t.has(e)}var ml=qm;var Gm=1,Qm=2;function Ym(t,e,r,n,i,s){var o=r&Gm,u=t.length,l=e.length;if(u!=l&&!(o&&l>u))return!1;var a=s.get(t),c=s.get(e);if(a&&c)return a==e&&c==t;var d=-1,f=!0,p=r&Qm?new hl:void 0;for(s.set(t,e),s.set(e,t);++d<u;){var b=t[d],w=e[d];if(n)var x=o?n(w,b,d,e,t,s):n(b,w,d,t,e,s);if(x!==void 0){if(x)continue;f=!1;break}if(p){if(!pl(e,function(h,y){if(!ml(p,y)&&(b===h||i(b,h,r,n,s)))return p.push(y)})){f=!1;break}}else if(!(b===w||i(b,w,r,n,s))){f=!1;break}}return s.delete(t),s.delete(e),f}var ti=Ym;function Jm(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}var gl=Jm;function Xm(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var yl=Xm;var Zm=1,eg=2,tg="[object Boolean]",rg="[object Date]",ng="[object Error]",ig="[object Map]",sg="[object Number]",og="[object RegExp]",ag="[object Set]",ug="[object String]",lg="[object Symbol]",cg="[object ArrayBuffer]",fg="[object DataView]",vl=Se?Se.prototype:void 0,Ns=vl?vl.valueOf:void 0;function dg(t,e,r,n,i,s,o){switch(r){case fg:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case cg:return!(t.byteLength!=e.byteLength||!s(new Ls(t),new Ls(e)));case tg:case rg:case sg:return ur(+t,+e);case ng:return t.name==e.name&&t.message==e.message;case og:case ug:return t==e+"";case ig:var u=gl;case ag:var l=n&Zm;if(u||(u=yl),t.size!=e.size&&!l)return!1;var a=o.get(t);if(a)return a==e;n|=eg,o.set(t,e);var c=ti(u(t),u(e),n,i,s,o);return o.delete(t),c;case lg:if(Ns)return Ns.call(t)==Ns.call(e)}return!1}var _l=dg;var hg=1,pg=Object.prototype,mg=pg.hasOwnProperty;function gg(t,e,r,n,i,s){var o=r&hg,u=Rs(t),l=u.length,a=Rs(e),c=a.length;if(l!=c&&!o)return!1;for(var d=l;d--;){var f=u[d];if(!(o?f in e:mg.call(e,f)))return!1}var p=s.get(t),b=s.get(e);if(p&&b)return p==e&&b==t;var w=!0;s.set(t,e),s.set(e,t);for(var x=o;++d<l;){f=u[d];var h=t[f],y=e[f];if(n)var m=o?n(y,h,f,e,t,s):n(h,y,f,t,e,s);if(!(m===void 0?h===y||i(h,y,r,n,s):m)){w=!1;break}x||(x=f=="constructor")}if(w&&!x){var g=t.constructor,v=e.constructor;g!=v&&"constructor"in t&&"constructor"in e&&!(typeof g=="function"&&g instanceof g&&typeof v=="function"&&v instanceof v)&&(w=!1)}return s.delete(t),s.delete(e),w}var bl=gg;var yg=1,xl="[object Arguments]",wl="[object Array]",ri="[object Object]",vg=Object.prototype,jl=vg.hasOwnProperty;function _g(t,e,r,n,i,s){var o=oe(t),u=oe(e),l=o?wl:Bs(t),a=u?wl:Bs(e);l=l==xl?ri:l,a=a==xl?ri:a;var c=l==ri,d=a==ri,f=l==a;if(f&&Zr(t)){if(!Zr(e))return!1;o=!0,c=!1}if(f&&!c)return s||(s=new vr),o||Gn(t)?ti(t,e,r,n,i,s):_l(t,e,l,r,n,i,s);if(!(r&yg)){var p=c&&jl.call(t,"__wrapped__"),b=d&&jl.call(e,"__wrapped__");if(p||b){var w=p?t.value():t,x=b?e.value():e;return s||(s=new vr),i(w,x,r,n,s)}}return f?(s||(s=new vr),bl(t,e,r,n,i,s)):!1}var Al=_g;function Sl(t,e,r,n,i){return t===e?!0:t==null||e==null||!Le(t)&&!Le(e)?t!==t&&e!==e:Al(t,e,r,n,Sl,i)}var ni=Sl;var bg=1,xg=2;function wg(t,e,r,n){var i=r.length,s=i,o=!n;if(t==null)return!s;for(t=Object(t);i--;){var u=r[i];if(o&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<s;){u=r[i];var l=u[0],a=t[l],c=u[1];if(o&&u[2]){if(a===void 0&&!(l in t))return!1}else{var d=new vr;if(n)var f=n(a,c,l,t,e,d);if(!(f===void 0?ni(c,a,bg|xg,n,d):f))return!1}}return!0}var Fl=wg;function jg(t){return t===t&&!mt(t)}var ii=jg;function Ag(t){for(var e=fr(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,ii(i)]}return e}var Cl=Ag;function Sg(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var si=Sg;function Fg(t){var e=Cl(t);return e.length==1&&e[0][2]?si(e[0][0],e[0][1]):function(r){return r===t||Fl(r,t,e)}}var El=Fg;function Cg(t,e){return t!=null&&e in Object(t)}var Tl=Cg;function Eg(t,e,r){e=Qn(e,t);for(var n=-1,i=e.length,s=!1;++n<i;){var o=wt(e[n]);if(!(s=t!=null&&r(t,o)))break;t=t[o]}return s||++n!=i?s:(i=t==null?0:t.length,!!i&&lr(i)&&ar(o,i)&&(oe(t)||cr(t)))}var Dl=Eg;function Tg(t,e){return t!=null&&Dl(t,e,Tl)}var Ol=Tg;var Dg=1,Og=2;function kg(t,e){return dr(t)&&ii(e)?si(wt(t),e):function(r){var n=Wu(r,t);return n===void 0&&n===e?Ol(r,t):ni(e,n,Dg|Og)}}var kl=kg;function Ig(t){return function(e){return e==null?void 0:e[t]}}var Il=Ig;function Mg(t){return function(e){return gr(e,t)}}var Ml=Mg;function Pg(t){return dr(t)?Il(wt(t)):Ml(t)}var Pl=Pg;function Rg(t){return typeof t=="function"?t:t==null?gt:typeof t=="object"?oe(t)?kl(t[0],t[1]):El(t):Pl(t)}var Rl=Rg;function Bg(t){return function(e,r,n){for(var i=-1,s=Object(e),o=n(e),u=o.length;u--;){var l=o[t?u:++i];if(r(s[l],l,s)===!1)break}return e}}var Bl=Bg;var Lg=Bl(),Ll=Lg;function Ng(t,e){return t&&Ll(t,e,fr)}var Nl=Ng;function Kg(t,e){return function(r,n){if(r==null)return r;if(!yt(r))return t(r,n);for(var i=r.length,s=e?i:-1,o=Object(r);(e?s--:++s<i)&&n(o[s],s,o)!==!1;);return r}}var Kl=Kg;var zg=Kl(Nl),zl=zg;function Vg(t,e){var r=-1,n=yt(t)?Array(t.length):[];return zl(t,function(i,s,o){n[++r]=e(i,s,o)}),n}var Vl=Vg;function Hg(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}var Hl=Hg;function $g(t,e){if(t!==e){var r=t!==void 0,n=t===null,i=t===t,s=tt(t),o=e!==void 0,u=e===null,l=e===e,a=tt(e);if(!u&&!a&&!s&&t>e||s&&o&&l&&!u&&!a||n&&o&&l||!r&&l||!i)return 1;if(!n&&!s&&!a&&t<e||a&&r&&i&&!n&&!s||u&&r&&i||!o&&i||!l)return-1}return 0}var $l=$g;function Wg(t,e,r){for(var n=-1,i=t.criteria,s=e.criteria,o=i.length,u=r.length;++n<o;){var l=$l(i[n],s[n]);if(l){if(n>=u)return l;var a=r[n];return l*(a=="desc"?-1:1)}}return t.index-e.index}var Wl=Wg;function Ug(t,e,r){e.length?e=or(e,function(s){return oe(s)?function(o){return gr(o,s.length===1?s[0]:s)}:s}):e=[gt];var n=-1;e=or(e,qn(Rl));var i=Vl(t,function(s,o,u){var l=or(e,function(a){return a(s)});return{criteria:l,index:++n,value:s}});return Hl(i,function(s,o){return Wl(s,o,r)})}var Ul=Ug;var qg=cu(function(t,e){if(t==null)return[];var r=e.length;return r>1&&Ds(t,e[0],e[1])?e=[]:r>2&&Ds(e[0],e[1],e[2])&&(e=[e[0]]),Ul(t,Qu(e,1),[])}),Ks=qg;var Gg=t=>{let e=t.split(ua),r=Mn();return r?e.flatMap(n=>na.test(n)?r.cut(n):[n]):e},oi=class{constructor(){this.indexedDocuments=new Map;this.previousResults=[];this.minisearch=new js(oi.options)}async loadCache(){let e=await he.getMinisearchCache();return e?(this.minisearch=js.loadJS(e.data,oi.options),this.indexedDocuments=new Map(e.paths.map(r=>[r.path,r.mtime])),!0):(console.log("Omnisearch - No cache found"),!1)}getDiff(e){let r=new Map(e.map(s=>[s.path,s.mtime])),n=e.filter(s=>!this.indexedDocuments.has(s.path)||this.indexedDocuments.get(s.path)!==s.mtime),i=[...this.indexedDocuments].filter(([s,o])=>!r.has(s)||r.get(s)!==o).map(s=>({path:s[0],mtime:s[1]}));return{toAdd:n,toRemove:i}}async addFromPaths(e){let r=(await Promise.all(e.map(async i=>await he.getDocument(i)))).filter(i=>!!i?.path);r=Ks(r,i=>i.path.endsWith(".md")?0:1),this.removeFromPaths(r.filter(i=>this.indexedDocuments.has(i.path)).map(i=>i.path));let n=va(r,500);for(let i of n){i.forEach(o=>this.indexedDocuments.set(o.path,o.mtime));let s=i.filter(o=>this.minisearch.has(o.path));this.removeFromPaths(s.map(o=>o.path)),await this.minisearch.addAllAsync(i)}}removeFromPaths(e){e.forEach(n=>this.indexedDocuments.delete(n));let r=e.filter(n=>this.minisearch.has(n));this.minisearch.discardAll(r)}async search(e,r){if(e.isEmpty())return this.previousResults=[],[];let n=this.minisearch.search(e.segmentsToStr(),{prefix:l=>l.length>=r.prefixLength,fuzzy:l=>l.length<=3?0:l.length<=5?.1:.2,combineWith:"AND",boost:{basename:D.weightBasename,aliases:D.weightBasename,headings1:D.weightH1,headings2:D.weightH2,headings3:D.weightH3}});if(!n.length)return this.previousResults;if(r.singleFilePath)return n.filter(l=>l.id===r.singleFilePath);D.hideExcluded?n=n.filter(l=>!(app.metadataCache.isUserIgnored&&app.metadataCache.isUserIgnored(l.id))):n.forEach(l=>{app.metadataCache.isUserIgnored&&app.metadataCache.isUserIgnored(l.id)&&(l.score/=10)});let i=e.segments.filter(l=>l.value.startsWith("#")).map(l=>l.value);for(let l of i)for(let a of n)(a.tags??[]).includes(l)&&(a.score*=100);n=n.slice(0,50);let s=await Promise.all(n.map(async l=>await he.getDocument(l.id))),o=e.getExactTerms();o.length&&(n=n.filter(l=>{let a=s.find(f=>f.path===l.id),c=a?.path.toLowerCase()??"",d=fs(a?.content??"").toLowerCase();return o.every(f=>d.includes(f)||c.includes(f))}));let u=e.exclusions;return u.length&&(n=n.filter(l=>{let a=fs(s.find(c=>c.path===l.id)?.content??"").toLowerCase();return u.every(c=>!a.includes(c.value))})),n=n.filter((l,a,c)=>c.findIndex(d=>d.id===l.id)===a),this.previousResults=n,n}getMatches(e,r,n){let i=null,s=[],o=0;for(;(i=r.exec(e))!==null&&!(++o>=100);){let l=i[0];l&&s.push({match:l,offset:i.index})}let u=e.toLowerCase().indexOf(n.segmentsToStr());return u>-1&&s.unshift({offset:u,match:n.segmentsToStr()}),s}async getSuggestions(e,r){let n;D.simpleSearch?n=await this.search(e,{prefixLength:3,singleFilePath:r?.singleFilePath}):n=await this.search(e,{prefixLength:1,singleFilePath:r?.singleFilePath});let i=e.segments.filter(u=>u.value.startsWith("#")).map(u=>u.value),s=await Promise.all(n.map(async u=>await he.getDocument(u.id)));return n.map(u=>{let l=s.find(f=>f.path===u.id);l||(console.warn(`Omnisearch - Note "${u.id}" not in the live cache`),l={content:"",basename:u.id,path:u.id}),e.segments.forEach(f=>{f.value=f.value.replace(/^#/,"")});let a=[...Object.keys(u.match),...e.segments.filter(f=>f.exact).map(f=>f.value),...i].filter(f=>f.length>1),c=this.getMatches(l.content,pt(a),e);return ne({score:u.score,foundWords:a,matches:c},l)})}async writeToCache(){await he.writeMinisearchCache(this.minisearch,this.indexedDocuments)}},zs=oi;zs.options={tokenize:Gg,processTerm:e=>(D.ignoreDiacritics?Pt(e):e).toLowerCase(),idField:"path",fields:["basename","aliases","content","headings1","headings2","headings3"],storeFields:["tags"],logger(e,r,n){n==="version_conflict"&&new ql.Notice("Omnisearch - Your index cache may be incorrect or corrupted. If this message keeps appearing, go to Settings to clear the cache.",5e3)}};var ce=new zs;var Vs=new Set;function Gl(t){Vs.add(t)}async function Ql(){let t=[...Vs].map(e=>e.path);t.length&&(ce.removeFromPaths(t),ce.addFromPaths(t),Vs.clear())}function Yl(t,e,r){let n=t.slice();return n[29]=e[r],n[31]=r,n}function Qg(t){let e,r,n;return{c(){e=P("button"),e.textContent="Create note"},m(i,s){H(i,e,s),r||(n=Te(e,"click",t[7]),r=!0)},p:se,d(i){i&&z(e),r=!1,n()}}}function Yg(t){let e,r=D.showCreateButton&&Qg(t);return{c(){r&&r.c(),e=jr()},m(n,i){r&&r.m(n,i),H(n,e,i)},p(n,i){D.showCreateButton&&r.p(n,i)},d(n){r&&r.d(n),n&&z(e)}}}function Jl(t){let e,r,n;return{c(){e=P("div"),r=Pe("\u23F3 Work in progress: "),n=Pe(t[3]),Ke(e,"text-align","center"),Ke(e,"color","var(--text-accent)"),Ke(e,"margin-top","10px")},m(i,s){H(i,e,s),I(e,r),I(e,n)},p(i,s){s[0]&8&&Ar(n,i[3])},d(i){i&&z(e)}}}function Xl(t){let e,r;function n(...i){return t[13](t[31],...i)}return e=new Ia({props:{selected:t[31]===t[0],note:t[29]}}),e.$on("mousemove",n),e.$on("click",t[6]),{c(){Fe(e.$$.fragment)},m(i,s){we(e,i,s),r=!0},p(i,s){t=i;let o={};s[0]&1&&(o.selected=t[31]===t[0]),s[0]&4&&(o.note=t[29]),e.$set(o)},i(i){r||(G(e.$$.fragment,i),r=!0)},o(i){J(e.$$.fragment,i),r=!1},d(i){ye(e,i)}}}function Jg(t){let e;return{c(){e=Pe("Searching...")},m(r,n){H(r,e,n)},d(r){r&&z(e)}}}function Xg(t){let e;return{c(){e=Pe("We found 0 result for your search here.")},m(r,n){H(r,e,n)},d(r){r&&z(e)}}}function Zg(t){let e,r,n,i=t[2],s=[];for(let c=0;c<i.length;c+=1)s[c]=Xl(Yl(t,i,c));let o=c=>J(s[c],1,1,()=>{s[c]=null});function u(c,d){if(!c[2].length&&c[1]&&!c[4])return Xg;if(c[4])return Jg}let l=u(t,[-1,-1]),a=l&&l(t);return{c(){for(let c=0;c<s.length;c+=1)s[c].c();e=U(),r=P("div"),a&&a.c(),Ke(r,"text-align","center")},m(c,d){for(let f=0;f<s.length;f+=1)s[f].m(c,d);H(c,e,d),H(c,r,d),a&&a.m(r,null),n=!0},p(c,d){if(d[0]&69){i=c[2];let f;for(f=0;f<i.length;f+=1){let p=Yl(c,i,f);s[f]?(s[f].p(p,d),G(s[f],1)):(s[f]=Xl(p),s[f].c(),G(s[f],1),s[f].m(e.parentNode,e))}for(St(),f=i.length;f<s.length;f+=1)o(f);Ft()}l!==(l=u(c,d))&&(a&&a.d(1),a=l&&l(c),a&&(a.c(),a.m(r,null)))},i(c){if(!n){for(let d=0;d<i.length;d+=1)G(s[d]);n=!0}},o(c){s=s.filter(Boolean);for(let d=0;d<s.length;d+=1)J(s[d]);n=!1},d(c){nn(s,c),c&&z(e),c&&z(r),a&&a.d()}}}function ey(t){let e,r,n,i,s,o,u,l,a,c,d,f,p,b,w,x,h,y,m,g,v,_,j,A,S,F,E,k,T,L,Y,C,N,q={initialValue:t[1],placeholder:"Omnisearch - Vault",$$slots:{default:[Yg]},$$scope:{ctx:t}};e=new Bn({props:q}),t[11](e),e.$on("input",t[12]);let $=t[3]&&Jl(t);return i=new Ln({props:{$$slots:{default:[Zg]},$$scope:{ctx:t}}}),{c(){Fe(e.$$.fragment),r=U(),$&&$.c(),n=U(),Fe(i.$$.fragment),s=U(),o=P("div"),u=P("div"),u.innerHTML='<span class="prompt-instruction-command">\u2191\u2193</span><span>to navigate</span>',l=U(),a=P("div"),a.innerHTML=`<span class="prompt-instruction-command">alt \u2191\u2193</span> 
    <span>to cycle history</span>`,c=U(),d=P("div"),d.innerHTML='<span class="prompt-instruction-command">\u21B5</span><span>to open</span>',f=U(),p=P("div"),p.innerHTML=`<span class="prompt-instruction-command">\u21B9</span> 
    <span>to switch to In-File Search</span>`,b=U(),w=P("br"),x=U(),h=P("div"),y=P("span"),y.textContent=`${ma()} \u21B5`,m=U(),g=P("span"),g.textContent="to open in a new pane",v=U(),_=P("div"),_.innerHTML=`<span class="prompt-instruction-command">shift \u21B5</span> 
    <span>to create</span>`,j=U(),A=P("div"),A.innerHTML=`<span class="prompt-instruction-command">ctrl shift \u21B5</span> 
    <span>to create in a new pane</span>`,S=U(),F=P("br"),E=U(),k=P("div"),k.innerHTML=`<span class="prompt-instruction-command">alt \u21B5</span> 
    <span>to insert a link</span>`,T=U(),L=P("div"),L.innerHTML=`<span class="prompt-instruction-command">ctrl+h</span> 
    <span>to toggle excerpts</span>`,Y=U(),C=P("div"),C.innerHTML='<span class="prompt-instruction-command">esc</span><span>to close</span>',B(u,"class","prompt-instruction"),B(a,"class","prompt-instruction"),B(d,"class","prompt-instruction"),B(p,"class","prompt-instruction"),B(y,"class","prompt-instruction-command"),B(h,"class","prompt-instruction"),B(_,"class","prompt-instruction"),B(A,"class","prompt-instruction"),B(k,"class","prompt-instruction"),B(L,"class","prompt-instruction"),B(C,"class","prompt-instruction"),B(o,"class","prompt-instructions")},m(W,ie){we(e,W,ie),H(W,r,ie),$&&$.m(W,ie),H(W,n,ie),we(i,W,ie),H(W,s,ie),H(W,o,ie),I(o,u),I(o,l),I(o,a),I(o,c),I(o,d),I(o,f),I(o,p),I(o,b),I(o,w),I(o,x),I(o,h),I(h,y),I(h,m),I(h,g),I(o,v),I(o,_),I(o,j),I(o,A),I(o,S),I(o,F),I(o,E),I(o,k),I(o,T),I(o,L),I(o,Y),I(o,C),N=!0},p(W,ie){let Ne={};ie[0]&2&&(Ne.initialValue=W[1]),ie[1]&2&&(Ne.$$scope={dirty:ie,ctx:W}),e.$set(Ne),W[3]?$?$.p(W,ie):($=Jl(W),$.c(),$.m(n.parentNode,n)):$&&($.d(1),$=null);let xr={};ie[0]&23|ie[1]&2&&(xr.$$scope={dirty:ie,ctx:W}),i.$set(xr)},i(W){N||(G(e.$$.fragment,W),G(i.$$.fragment,W),N=!0)},o(W){J(e.$$.fragment,W),J(i.$$.fragment,W),N=!1},d(W){t[11](null),ye(e,W),W&&z(r),$&&$.d(W),W&&z(n),ye(i,W),W&&z(s),W&&z(o)}}}function ty(t,e,r){let n,i;rn(t,dt,C=>r(10,i=C));let{modal:s}=e,{previousQuery:o}=e,u=0,l=0,a,c=[],d,f="",p=!0,b;Cr(async()=>{V.enable("vault"),V.on("vault","enter",m),V.on("vault","create-note",A),V.on("vault","open-in-new-pane",g),V.on("vault","insert-link",S),V.on("vault","tab",F),V.on("vault","arrow-up",()=>E(-1)),V.on("vault","arrow-down",()=>E(1)),V.on("vault","prev-search-history",w),V.on("vault","next-search-history",x),await Ql(),D.showPreviousQueryResults&&r(8,o=(await he.getSearchHistory())[0])}),Er(()=>{V.disable("vault")});async function w(){let C=(await he.getSearchHistory()).filter(N=>N);++l>=C.length&&(l=0),r(1,a=C[l]),b?.setInputValue(a)}async function x(){let C=(await he.getSearchHistory()).filter(N=>N);--l<0&&(l=C.length?C.length-1:0),r(1,a=C[l]),b?.setInputValue(a)}async function h(){d=new Rt(a),r(2,c=(await ce.getSuggestions(d)).sort((C,N)=>N.score-C.score)),r(0,u=0),await k()}function y(C){!n||(C?.ctrlKey?g():m(),s.close())}function m(){!n||(_(n),s.close())}function g(){!n||(_(n,!0),s.close())}function v(){a&&he.addToSearchHistory(a)}function _(C,N=!1){v(),Nn(C,N)}async function j(C){await A()}async function A(C){if(a){try{await Aa(a,C?.newLeaf)}catch(N){new jt.Notice(N.message);return}s.close()}}function S(){if(!n)return;let C=app.vault.getMarkdownFiles().find(ie=>ie.path===n.path),N=app.workspace.getActiveFile(),q=app.workspace.getActiveViewOfType(jt.MarkdownView);if(!q?.editor){new jt.Notice("Omnisearch - Error - No active editor",3e3);return}let $;C&&N?$=app.fileManager.generateMarkdownLink(C,N.path):$=`[[${n.basename}.${ga(n.path)}]]`;let W=q.editor.getCursor();q.editor.replaceRange($,W,W),W.ch+=$.length,q.editor.setCursor(W),s.close()}function F(){if(!(n&&(hs(n?.path)||!n?.matches.length)))if(v(),s.close(),n){let C=app.vault.getAbstractFileByPath(n.path);C&&C instanceof jt.TFile&&new _r(app,C,a).open()}else{let C=app.workspace.getActiveViewOfType(jt.MarkdownView);C&&new _r(app,C.file,a).open()}}function E(C){r(0,u=Rn(u+C,c.length)),k()}async function k(){await it(),n&&document.querySelector(`[data-result-id="${n.path}"]`)?.scrollIntoView({behavior:"auto",block:"nearest"})}function T(C){Wt[C?"unshift":"push"](()=>{b=C,r(5,b)})}let L=C=>r(1,a=C.detail),Y=(C,N)=>r(0,u=C);return t.$$set=C=>{"modal"in C&&r(9,s=C.modal),"previousQuery"in C&&r(8,o=C.previousQuery)},t.$$.update=()=>{if(t.$$.dirty[0]&258){e:r(1,a=a??o)}if(t.$$.dirty[0]&2){e:a?(r(2,c=[]),r(4,p=!0),h().then(()=>{r(4,p=!1)}).catch(C=>{console.error(C)})):(r(4,p=!1),r(2,c=[]))}if(t.$$.dirty[0]&5){e:n=c[u]}if(t.$$.dirty[0]&1024){e:switch(i){case Ie.LoadingCache:r(3,f="Loading cache...");break;case Ie.ReadingFiles:r(3,f="Reading files...");break;case Ie.IndexingFiles:r(3,f="Indexing files...");break;case Ie.WritingCache:h(),r(3,f="Updating cache...");break;default:h(),r(3,f="");break}}},[u,a,c,f,p,b,y,j,o,s,i,T,L,Y]}var Zl=class extends me{constructor(e){super();ve(this,e,ty,ey,fe,{modal:9,previousQuery:8},null,[-1,-1])}},ec=Zl;var nc=Ee(require("obsidian"));function ry(t){let e,r=t[2].replace(t[3],ht)+"";return{c(){e=P("div"),B(e,"class","omnisearch-result__body")},m(n,i){H(n,e,i),e.innerHTML=r},p(n,i){i&12&&r!==(r=n[2].replace(n[3],ht)+"")&&(e.innerHTML=r)},d(n){n&&z(e)}}}function ny(t){let e,r;return e=new Kn({props:{id:t[0].toString(),selected:t[1],$$slots:{default:[ry]},$$scope:{ctx:t}}}),e.$on("mousemove",t[6]),e.$on("click",t[7]),{c(){Fe(e.$$.fragment)},m(n,i){we(e,n,i),r=!0},p(n,[i]){let s={};i&1&&(s.id=n[0].toString()),i&2&&(s.selected=n[1]),i&268&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){r||(G(e.$$.fragment,n),r=!0)},o(n){J(e.$$.fragment,n),r=!1},d(n){ye(e,n)}}}function iy(t,e,r){let n,i,{offset:s}=e,{note:o}=e,{index:u=0}=e,{selected:l=!1}=e;function a(d){ze.call(this,t,d)}function c(d){ze.call(this,t,d)}return t.$$set=d=>{"offset"in d&&r(4,s=d.offset),"note"in d&&r(5,o=d.note),"index"in d&&r(0,u=d.index),"selected"in d&&r(1,l=d.selected)},t.$$.update=()=>{if(t.$$.dirty&32){e:r(3,n=pt(o.foundWords))}if(t.$$.dirty&48){e:r(2,i=ir(o?.content??"",s))}},[u,l,i,n,s,o,a,c]}var tc=class extends me{constructor(e){super();ve(this,e,iy,ny,fe,{offset:4,note:5,index:0,selected:1})}},rc=tc;function ic(t,e,r){let n=t.slice();return n[16]=e[r],n[18]=r,n}function sy(t){let e;return{c(){e=P("div"),e.textContent="We found 0 result for your search here.",Ke(e,"text-align","center")},m(r,n){H(r,e,n)},p:se,i:se,o:se,d(r){r&&z(e)}}}function oy(t){let e,r,n=t[4],i=[];for(let o=0;o<n.length;o+=1)i[o]=sc(ic(t,n,o));let s=o=>J(i[o],1,1,()=>{i[o]=null});return{c(){for(let o=0;o<i.length;o+=1)i[o].c();e=jr()},m(o,u){for(let l=0;l<i.length;l+=1)i[l].m(o,u);H(o,e,u),r=!0},p(o,u){if(u&120){n=o[4];let l;for(l=0;l<n.length;l+=1){let a=ic(o,n,l);i[l]?(i[l].p(a,u),G(i[l],1)):(i[l]=sc(a),i[l].c(),G(i[l],1),i[l].m(e.parentNode,e))}for(St(),l=n.length;l<i.length;l+=1)s(l);Ft()}},i(o){if(!r){for(let u=0;u<n.length;u+=1)G(i[u]);r=!0}},o(o){i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)J(i[u]);r=!1},d(o){nn(i,o),o&&z(e)}}}function sc(t){let e,r;function n(...i){return t[11](t[18],...i)}return e=new rc({props:{offset:t[16],note:t[3],index:t[18],selected:t[18]===t[5]}}),e.$on("mousemove",n),e.$on("click",t[6]),{c(){Fe(e.$$.fragment)},m(i,s){we(e,i,s),r=!0},p(i,s){t=i;let o={};s&16&&(o.offset=t[16]),s&8&&(o.note=t[3]),s&32&&(o.selected=t[18]===t[5]),e.$set(o)},i(i){r||(G(e.$$.fragment,i),r=!0)},o(i){J(e.$$.fragment,i),r=!1},d(i){ye(e,i)}}}function ay(t){let e,r,n,i,s=[oy,sy],o=[];function u(l,a){return l[4].length&&l[3]?0:1}return e=u(t,-1),r=o[e]=s[e](t),{c(){r.c(),n=jr()},m(l,a){o[e].m(l,a),H(l,n,a),i=!0},p(l,a){let c=e;e=u(l,a),e===c?o[e].p(l,a):(St(),J(o[c],1,1,()=>{o[c]=null}),Ft(),r=o[e],r?r.p(l,a):(r=o[e]=s[e](l),r.c()),G(r,1),r.m(n.parentNode,n))},i(l){i||(G(r),i=!0)},o(l){J(r),i=!1},d(l){o[e].d(l),l&&z(n)}}}function uy(t){let e;return{c(){e=P("span"),e.textContent="to close"},m(r,n){H(r,e,n)},d(r){r&&z(e)}}}function ly(t){let e;return{c(){e=P("span"),e.textContent="to go back to Vault Search"},m(r,n){H(r,e,n)},d(r){r&&z(e)}}}function cy(t){let e,r,n,i,s,o,u,l,a,c,d,f,p,b,w;e=new Bn({props:{placeholder:"Omnisearch - File",initialValue:t[1]}}),e.$on("input",t[10]),n=new Ln({props:{$$slots:{default:[ay]},$$scope:{ctx:t}}});function x(m,g){return m[0]?ly:uy}let h=x(t,-1),y=h(t);return{c(){Fe(e.$$.fragment),r=U(),Fe(n.$$.fragment),i=U(),s=P("div"),o=P("div"),o.innerHTML='<span class="prompt-instruction-command">\u2191\u2193</span><span>to navigate</span>',u=U(),l=P("div"),l.innerHTML='<span class="prompt-instruction-command">\u21B5</span><span>to open</span>',a=U(),c=P("div"),c.innerHTML=`<span class="prompt-instruction-command">\u21B9</span> 
    <span>to switch to Vault Search</span>`,d=U(),f=P("div"),p=P("span"),p.textContent="esc",b=U(),y.c(),B(o,"class","prompt-instruction"),B(l,"class","prompt-instruction"),B(c,"class","prompt-instruction"),B(p,"class","prompt-instruction-command"),B(f,"class","prompt-instruction"),B(s,"class","prompt-instructions")},m(m,g){we(e,m,g),H(m,r,g),we(n,m,g),H(m,i,g),H(m,s,g),I(s,o),I(s,u),I(s,l),I(s,a),I(s,c),I(s,d),I(s,f),I(f,p),I(f,b),y.m(f,null),w=!0},p(m,[g]){let v={};g&2&&(v.initialValue=m[1]),e.$set(v);let _={};g&524344&&(_.$$scope={dirty:g,ctx:m}),n.$set(_),h!==(h=x(m,g))&&(y.d(1),y=h(m),y&&(y.c(),y.m(f,null)))},i(m){w||(G(e.$$.fragment,m),G(n.$$.fragment,m),w=!0)},o(m){J(e.$$.fragment,m),J(n.$$.fragment,m),w=!1},d(m){ye(e,m),m&&z(r),ye(n,m),m&&z(i),m&&z(s),y.d()}}}function fy(t,e,r){let n=t.find(i=>i.offset>e);return n?t.filter(i=>i.offset>e&&i.offset<=n.offset+r):[]}function dy(t,e,r){let{modal:n}=e,{parent:i=null}=e,{singleFilePath:s=""}=e,{previousQuery:o}=e,u,l=[],a=0,c,d;Cr(()=>{V.enable("infile"),V.on("infile","enter",w),V.on("infile","arrow-up",()=>p(-1)),V.on("infile","arrow-down",()=>p(1)),V.on("infile","tab",x)}),Er(()=>{V.disable("infile")});function f(m){let g=[],v=-1,_=0;for(;;){let j=fy(m,v,Gr);if(!j.length||(v=j.last().offset,g.push(j),++_>100))break}return g}function p(m){r(5,a=Rn(a+m,l.length)),b()}async function b(){await it(),document.querySelector(`[data-result-id="${a}"]`)?.scrollIntoView({behavior:"auto",block:"nearest"})}async function w(m){if(c){n.close(),i&&i.close(),await Nn(c,m?.ctrlKey);let g=app.workspace.getActiveViewOfType(nc.MarkdownView);if(!g)return;let v=l[a]??0,_=g.editor.offsetToPos(v);_.ch=0,g.editor.setCursor(_),g.editor.scrollIntoView({from:{line:_.line-10,ch:0},to:{line:_.line+10,ch:0}})}}function x(){new Nt(app,o).open(),n.close()}let h=m=>r(2,u=m.detail),y=(m,g)=>r(5,a=m);return t.$$set=m=>{"modal"in m&&r(7,n=m.modal),"parent"in m&&r(0,i=m.parent),"singleFilePath"in m&&r(8,s=m.singleFilePath),"previousQuery"in m&&r(1,o=m.previousQuery)},t.$$.update=()=>{if(t.$$.dirty&2){e:r(2,u=o??"")}if(t.$$.dirty&772){e:(async()=>{u&&(r(9,d=new Rt(u)),r(3,c=(await ce.getSuggestions(d,{singleFilePath:s}))[0]??null)),r(5,a=0),await b()})()}if(t.$$.dirty&8){e:if(c){let m=f(c.matches);r(4,l=m.map(g=>Math.round((g.first().offset+g.last().offset)/2)))}}},[i,o,u,c,l,a,w,n,s,d,h,y]}var oc=class extends me{constructor(e){super();ve(this,e,dy,cy,fe,{modal:7,parent:0,singleFilePath:8,previousQuery:1})}},ac=oc;var Hs=class extends uc.Modal{constructor(e){super(e);this.modalEl.replaceChildren(),this.modalEl.addClass("omnisearch-modal","prompt"),this.modalEl.removeClass("modal"),this.modalEl.tabIndex=-1,this.scope.register([],"ArrowDown",r=>{r.preventDefault(),V.emit("arrow-down")}),this.scope.register([],"ArrowUp",r=>{r.preventDefault(),V.emit("arrow-up")});for(let r of[{k:"J",dir:"down"},{k:"K",dir:"up"}])for(let n of["Ctrl","Mod"])this.scope.register([n],r.k,i=>{this.app.vault.getConfig("vimMode")&&V.emit("arrow-"+r.dir)});for(let r of[{k:"N",dir:"down"},{k:"P",dir:"up"}])for(let n of["Ctrl","Mod"])this.scope.register([n],r.k,i=>{this.app.vault.getConfig("vimMode")&&V.emit("arrow-"+r.dir)});this.scope.register(["Mod"],"Enter",r=>{r.preventDefault(),V.emit("open-in-new-pane")}),this.scope.register(["Alt"],"Enter",r=>{r.preventDefault(),V.emit("insert-link")}),this.scope.register(["Shift"],"Enter",r=>{r.preventDefault(),V.emit("create-note")}),this.scope.register(["Ctrl","Shift"],"Enter",r=>{r.preventDefault(),V.emit("create-note",{newLeaf:!0})}),this.scope.register([],"Enter",r=>{aa()||(r.preventDefault(),V.emit("enter"))}),this.scope.register([],"Tab",r=>{r.preventDefault(),V.emit("tab")}),this.scope.register(["Alt"],"ArrowDown",r=>{r.preventDefault(),V.emit("next-search-history")}),this.scope.register(["Alt"],"ArrowUp",r=>{r.preventDefault(),V.emit("prev-search-history")}),this.scope.register(["Ctrl"],"H",r=>{V.emit(In.ToggleExcerpts)})}},Nt=class extends Hs{constructor(e,r){super(e);let n=new ec({target:this.modalEl,props:{modal:this,previousQuery:r}});this.onClose=()=>{n.$destroy()}}},_r=class extends Hs{constructor(e,r,n="",i){super(e);let s=new ac({target:this.modalEl,props:{modal:this,singleFilePath:r.path,parent:i,previousQuery:n}});i&&i.containerEl.toggleVisibility(!1),this.onClose=()=>{i&&i.containerEl.toggleVisibility(!0),s.$destroy()}}};function hy(t){return t.map(e=>{let{score:r,path:n,basename:i,foundWords:s,matches:o,content:u}=e,l=ir(u,o[0]?.offset??-1);return{score:r,path:n,basename:i,foundWords:s,matches:o.map(a=>({match:a.match,offset:a.offset})),excerpt:l}})}async function py(t,e={}){let r=new Rt(t),n=await ce.getSuggestions(r);return hy(n)}var $s={search:py};var Ws=class extends br.Plugin{async onload(){await ea(this),await my(),await rr.clearOldDatabases(),gy(this),D.ribbonIcon&&this.addRibbonButton(),this.addSettingTab(new us(this)),V.disable("vault"),V.disable("infile"),V.on("global",In.ToggleExcerpts,()=>{Mt.set(!D.showExcerpt)}),this.addCommand({id:"show-modal",name:"Vault search",callback:()=>{new Nt(app).open()}}),this.addCommand({id:"show-modal-infile",name:"In-file search",editorCallback:(e,r)=>{r.file&&new _r(app,r.file).open()}}),app.workspace.onLayoutReady(async()=>{this.registerEvent(this.app.vault.on("create",e=>{Yr(e.path)&&ce.addFromPaths([e.path])})),this.registerEvent(this.app.vault.on("delete",e=>{he.removeFromLiveCache(e.path),ce.removeFromPaths([e.path])})),this.registerEvent(this.app.vault.on("modify",async e=>{Yr(e.path)&&(await he.addToLiveCache(e.path),Gl(e))})),this.registerEvent(this.app.vault.on("rename",async(e,r)=>{Yr(e.path)&&(he.removeFromLiveCache(r),he.addToLiveCache(e.path),ce.removeFromPaths([r]),await ce.addFromPaths([e.path]))})),this.executeFirstLaunchTasks(),await this.populateIndex()})}executeFirstLaunchTasks(){let e="1.10.1";if(D.welcomeMessage!==e){let r=new DocumentFragment;r.createSpan({},n=>{n.innerHTML="\u{1F50E} Omnisearch now requires the <strong>Text Extractor</strong> plugin to index PDF and images. See Omnisearch settings for more information."}),new br.Notice(r,2e4)}D.welcomeMessage=e,this.saveData(D)}async onunload(){delete globalThis.omnisearch,await ke.clearCache()}addRibbonButton(){this.ribbonButton=this.addRibbonIcon("search","Omnisearch",e=>{new Nt(app).open()})}removeRibbonButton(){this.ribbonButton&&this.ribbonButton.parentNode?.removeChild(this.ribbonButton)}async populateIndex(){console.time("Omnisearch - Indexing total time"),dt.set(Ie.ReadingFiles);let e=app.vault.getFiles().filter(n=>Yr(n.path));console.log(`Omnisearch - ${e.length} files total`),console.log(`Omnisearch - Cache is ${ft()?"enabled":"disabled"}`),ft()&&(console.time("Omnisearch - Loading index from cache"),dt.set(Ie.LoadingCache),await ce.loadCache()&&console.timeEnd("Omnisearch - Loading index from cache"));let r=ce.getDiff(e.map(n=>({path:n.path,mtime:n.stat.mtime})));ft()&&(r.toAdd.length&&console.log("Omnisearch - Total number of files to add/update: "+r.toAdd.length),r.toRemove.length&&console.log("Omnisearch - Total number of files to remove: "+r.toRemove.length)),r.toAdd.length>=1e3&&ft()&&new br.Notice(`Omnisearch - ${r.toAdd.length} files need to be indexed. Obsidian may experience stutters and freezes during the process`,1e4),dt.set(Ie.IndexingFiles),ce.removeFromPaths(r.toRemove.map(n=>n.path)),await ce.addFromPaths(r.toAdd.map(n=>n.path)),(r.toRemove.length||r.toAdd.length)&&ft()&&(dt.set(Ie.WritingCache),D.useCache=!1,de(this),await ce.writeToCache(),D.useCache=!0,de(this)),console.timeEnd("Omnisearch - Indexing total time"),r.toAdd.length>=1e3&&new br.Notice("Omnisearch - Your files have been indexed."),dt.set(Ie.Done)}};async function my(){let t=[`${app.vault.configDir}/plugins/omnisearch/searchIndex.json`,`${app.vault.configDir}/plugins/omnisearch/notesCache.json`,`${app.vault.configDir}/plugins/omnisearch/notesCache.data`,`${app.vault.configDir}/plugins/omnisearch/searchIndex.data`,`${app.vault.configDir}/plugins/omnisearch/historyCache.json`,`${app.vault.configDir}/plugins/omnisearch/pdfCache.data`];for(let e of t)if(await app.vault.adapter.exists(e))try{await app.vault.adapter.remove(e)}catch{}}function gy(t){t.registerObsidianProtocolHandler("omnisearch",e=>{new Nt(app,e.query).open()}),globalThis.omnisearch=$s,app.plugins.plugins.omnisearch.api=$s}
